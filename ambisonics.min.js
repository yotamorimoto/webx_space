!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.ambisonics=t()}}(function(){var define,module,exports;return function t(e,r,n){function a(o,s){if(!r[o]){if(!e[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[o]={exports:{}};e[o][0].call(l.exports,function(t){var r=e[o][1][t];return a(r||t)},l,l.exports,t,e,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=function(){function t(e,r){(0,i.default)(this,t),this.initialized=!1,this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.decFilters=new Array(this.nCh),this.decFilterNodes=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(2),this.out.channelCountMode="explicit",this.out.channelCount=1,this.gainMid=this.ctx.createGain(),this.gainSide=this.ctx.createGain(),this.invertSide=this.ctx.createGain(),this.gainMid.gain.value=1,this.gainSide.gain.value=1,this.invertSide.gain.value=-1;for(var n=0;n<this.nCh;n++)this.decFilterNodes[n]=this.ctx.createConvolver(),this.decFilterNodes[n].normalize=!1;this.resetFilters();for(var n=0;n<this.nCh;n++){this.in.connect(this.decFilterNodes[n],n,0);var a=Math.floor(Math.sqrt(n));n-a*a-a>=0?this.decFilterNodes[n].connect(this.gainMid):this.decFilterNodes[n].connect(this.gainSide)}this.gainMid.connect(this.out,0,0),this.gainSide.connect(this.out,0,0),this.gainMid.connect(this.out,0,1),this.gainSide.connect(this.invertSide,0,0),this.invertSide.connect(this.out,0,1),this.initialized=!0}return(0,s.default)(t,[{key:"updateFilters",value:function(t){for(var e=0;e<this.nCh;e++)this.decFilters[e]=this.ctx.createBuffer(1,t.length,t.sampleRate),this.decFilters[e].getChannelData(0).set(t.getChannelData(e)),this.decFilterNodes[e].buffer=this.decFilters[e]}},{key:"resetFilters",value:function(){var t=new Array(this.nCh);t.fill(0),t[0]=.5,t[1]=.5/Math.sqrt(3);for(var e=0;e<this.nCh;e++){this.decFilters[e]=this.ctx.createBuffer(1,64,this.ctx.sampleRate);for(var r=0;r<64;r++)this.decFilters[e].getChannelData(0)[r]=0;this.decFilters[e].getChannelData(0)[0]=t[e],this.decFilterNodes[e].buffer=this.decFilters[e]}}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],2:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=function(){function t(e,r){(0,i.default)(this,t),this.initialized=!1,this.ctx=e,this.order=r,this.nCh=2*r+1,this.decFilters=new Array(this.nCh),this.decFilterNodes=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(2),this.out.channelCountMode="explicit",this.out.channelCount=1,this.gainMid=this.ctx.createGain(),this.gainSide=this.ctx.createGain(),this.invertSide=this.ctx.createGain(),this.gainMid.gain.value=1,this.gainSide.gain.value=1,this.invertSide.gain.value=-1;for(var n=0;n<this.nCh;n++)this.decFilterNodes[n]=this.ctx.createConvolver(),this.decFilterNodes[n].normalize=!1;this.resetFilters();for(var n=0;n<this.nCh;n++)this.in.connect(this.decFilterNodes[n],n,0),n%2==0?this.decFilterNodes[n].connect(this.gainMid):this.decFilterNodes[n].connect(this.gainSide);this.gainMid.connect(this.out,0,0),this.gainSide.connect(this.out,0,0),this.gainMid.connect(this.out,0,1),this.gainSide.connect(this.invertSide,0,0),this.invertSide.connect(this.out,0,1),this.initialized=!0}return(0,s.default)(t,[{key:"updateFilters",value:function(t){for(var e=0;e<this.nCh;e++)this.decFilters[e]=this.ctx.createBuffer(1,t.length,t.sampleRate),this.decFilters[e].getChannelData(0).set(t.getChannelData(e)),this.decFilterNodes[e].buffer=this.decFilters[e]}},{key:"resetFilters",value:function(){var t=new Array(this.nCh);t.fill(0),t[0]=.5,t[1]=.5/Math.sqrt(3);for(var e=0;e<this.nCh;e++){this.decFilters[e]=this.ctx.createBuffer(1,64,this.ctx.sampleRate);for(var r=0;r<64;r++)this.decFilters[e].getChannelData(0)[r]=0;this.decFilters[e].getChannelData(0)[0]=t[e],this.decFilterNodes[e].buffer=this.decFilters[e]}}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],3:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fuma2acn=r.n3d2sn3d=r.sn3d2n3d=r.acn2wxyz=r.wxyz2acn=void 0;var n=t("babel-runtime/helpers/classCallCheck"),a=function(t){return t&&t.__esModule?t:{default:t}}(n);r.wxyz2acn=function t(e){(0,a.default)(this,t),this.ctx=e,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=new Array(4);for(var r=0;r<4;r++)this.gains[r]=this.ctx.createGain(),this.gains[r].gain.value=0==r?Math.SQRT2:Math.sqrt(3),this.gains[r].connect(this.out,0,r);this.in.connect(this.gains[0],0,0),this.in.connect(this.gains[3],1,0),this.in.connect(this.gains[1],2,0),this.in.connect(this.gains[2],3,0)},r.acn2wxyz=function t(e){(0,a.default)(this,t),this.ctx=e,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=new Array(4);for(var r=0;r<4;r++)this.gains[r]=this.ctx.createGain(),this.gains[r].gain.value=0==r?Math.SQRT1_2:1/Math.sqrt(3),this.gains[r].connect(this.out,0,r);this.in.connect(this.gains[0],0,0),this.in.connect(this.gains[2],1,0),this.in.connect(this.gains[3],2,0),this.in.connect(this.gains[1],3,0)},r.sn3d2n3d=function t(e,r){(0,a.default)(this,t),this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(var n=0;n<this.nCh;n++){var i=Math.floor(Math.sqrt(n));this.gains[n]=this.ctx.createGain(),this.gains[n].gain.value=Math.sqrt(2*i+1),this.in.connect(this.gains[n],n,0),this.gains[n].connect(this.out,0,n)}},r.n3d2sn3d=function t(e,r){(0,a.default)(this,t),this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(var n=0;n<this.nCh;n++){var i=Math.floor(Math.sqrt(n));this.gains[n]=this.ctx.createGain(),this.gains[n].gain.value=1/Math.sqrt(2*i+1),this.in.connect(this.gains[n],n,0),this.gains[n].connect(this.out,0,n)}},r.fuma2acn=function t(e,r){(0,a.default)(this,t),r>3&&(console.log("FuMa specifiction is supported up to 3rd order"),r=3);var n=[Math.sqrt(2),Math.sqrt(3),Math.sqrt(3),Math.sqrt(3),Math.sqrt(15)/2,Math.sqrt(15)/2,Math.sqrt(5),Math.sqrt(15)/2,Math.sqrt(15)/2,Math.sqrt(35/8),Math.sqrt(35)/3,Math.sqrt(224/45),Math.sqrt(7),Math.sqrt(224/45),Math.sqrt(35)/3,Math.sqrt(35/8)];if(this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=[],this.remapArray=[],this.remapArray.push(0,2,3,1),r>1)for(var i,o=0,s=0;s<this.nCh;s++)if(i=[],s>=(o+1)*(o+1)){o+=1;for(var u=(o+1)*(o+1);u<(o+2)*(o+2);u++)(u+o%2)%2==0?i.push(u):i.unshift(u);this.remapArray=this.remapArray.concat(i)}for(var s=0;s<this.nCh;s++)this.gains[s]=this.ctx.createGain(),this.gains[s].gain.value=n[s],this.in.connect(this.gains[s],this.remapArray[s],0),this.gains[s].connect(this.out,0,s)}},{"babel-runtime/helpers/classCallCheck":27}],4:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=t("./utils.js"),c=function(){function t(e,r){(0,i.default)(this,t),this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.nSpk=0,this._decodingMatrix=[],this._spkSphPosArray=[],this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(1),this._spkSphPosArray=this._getDefaultSpkConfig(this.order),this._updateDecodeMtx(this._spkSphPosArray)}return(0,s.default)(t,[{key:"_updateDecodeMtx",value:function(t){this.nSpk=t.length,this.out=this.ctx.createChannelMerger(this.nSpk),this._decodingMatrix=u.getAmbisonicDecMtx(t,this.order),this.mtxGain=new Array(this.nCh);for(var e=0;e<this.nCh;e++){this.mtxGain[e]=new Array(this.nSpk);for(var r=0;r<this.nSpk;r++){var n=this.ctx.createGain();n.gain.value=this._decodingMatrix[r][e],this.in.connect(n,e,0),n.connect(this.out,0,r),this.mtxGain[e][r]=n}}}},{key:"_getDefaultSpkConfig",value:function(t){var e=[];switch(t){case 1:e=[[0,0,1],[90,0,1],[180,0,1],[270,0,1],[0,90,1],[0,-90,1]];break;case 2:e=[[180,-31.7161,.5878],[180,31.7161,.5878],[-121.7161,0,.5878],[121.7161,0,.5878],[-90,-58.2839,.5878],[-90,58.2839,.5878],[90,-58.2839,.5878],[90,58.2839,.5878],[-58.2839,0,.5878],[58.2839,0,.5878],[0,-31.7161,.5878],[0,31.7161,.5878]];break;case 3:e=[[-159.0931,0,.5352],[159.0931,0,.5352],[-135,-35.2644,.5352],[-135,35.2644,.5352],[135,-35.2644,.5352],[135,35.2644,.5352],[180,-69.0931,.5352],[180,69.0931,.5352],[-90,-20.9069,.5352],[-90,20.9069,.5352],[90,-20.9069,.5352],[90,20.9069,.5352],[0,-69.0931,.5352],[0,69.0931,.5352],[-45,-35.2644,.5352],[-45,35.2644,.5352],[45,-35.2644,.5352],[45,35.2644,.5352],[-20.9069,0,.5352],[20.9069,0,.5352]];break;default:console.error("unsupported default order:",t)}return e}},{key:"speakerPos",set:function(t){void 0===t&&(t=this._getDefaultSpkConfig(this.order)),this._spkSphPosArray=t,this.out.disconnect(),this._updateDecodeMtx(t)},get:function(){return this._spkSphPosArray}}]),t}();r.default=c},{"./utils.js":24,"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],5:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o);t("get-float-time-domain-data");var u=function(){function t(e){(0,i.default)(this,t),this.ctx=e,this.fftSize=2048,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=new Array(3);for(var r=0;r<3;r++)this.gains[r]=this.ctx.createGain(),this.gains[r].gain.value=1/Math.sqrt(3);for(this.analysers=new Array(4),this.analBuffers=new Array(4),r=0;r<4;r++)this.analysers[r]=this.ctx.createAnalyser(),this.analysers[r].fftSize=this.fftSize,this.analysers[r].smoothingTimeConstant=0,this.analBuffers[r]=new Float32Array(this.fftSize);for(this.in.connect(this.out,0,0),this.in.connect(this.analysers[0],0,0),this.in.connect(this.gains[1],1,0),this.in.connect(this.gains[2],2,0),this.in.connect(this.gains[0],3,0),r=0;r<3;r++)this.gains[r].connect(this.analysers[r+1],0,0),this.gains[r].connect(this.out,0,r+1)}return(0,s.default)(t,[{key:"updateBuffers",value:function(){for(var t=0;t<4;t++)this.analysers[t].getFloatTimeDomainData(this.analBuffers[t])}},{key:"computeIntensity",value:function(){for(var t,e,r,n,a,i,o=0,s=0,u=0,c=0,l=0,h=0,f=0,d=0;d<this.fftSize;d++)o+=this.analBuffers[0][d]*this.analBuffers[1][d],s+=this.analBuffers[0][d]*this.analBuffers[2][d],u+=this.analBuffers[0][d]*this.analBuffers[3][d],c+=this.analBuffers[0][d]*this.analBuffers[0][d],l+=this.analBuffers[1][d]*this.analBuffers[1][d],h+=this.analBuffers[2][d]*this.analBuffers[2][d],f+=this.analBuffers[3][d]*this.analBuffers[3][d];return t=[o,s,u],e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),r=(c+l+h+f)/2,n=1-e/(r+1e-7),a=180*Math.atan2(s,o)/Math.PI,i=180*Math.atan2(t[2],Math.sqrt(t[0]*t[0]+t[1]*t[1]))/Math.PI,[a,i,n,r]}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28,"get-float-time-domain-data":58}],6:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o);t("get-float-time-domain-data");var u=function(){function t(e){(0,i.default)(this,t),this.ctx=e,this.fftSize=2048,this.in=this.ctx.createChannelSplitter(3),this.out=this.ctx.createChannelMerger(3),this.gains=new Array(2);for(var r=0;r<2;r++)this.gains[r]=this.ctx.createGain(),this.gains[r].gain.value=1/Math.sqrt(3);for(this.analysers=new Array(3),this.analBuffers=new Array(3),r=0;r<3;r++)this.analysers[r]=this.ctx.createAnalyser(),this.analysers[r].fftSize=this.fftSize,this.analysers[r].smoothingTimeConstant=0,this.analBuffers[r]=new Float32Array(this.fftSize);for(this.in.connect(this.out,0,0),this.in.connect(this.analysers[0],0,0),this.in.connect(this.gains[1],1,0),this.in.connect(this.gains[0],2,0),r=0;r<2;r++)this.gains[r].connect(this.analysers[r+1],0,0),this.gains[r].connect(this.out,0,r+1)}return(0,s.default)(t,[{key:"updateBuffers",value:function(){for(var t=0;t<3;t++)this.analysers[t].getFloatTimeDomainData(this.analBuffers[t])}},{key:"computeIntensity",value:function(){for(var t,e,r,n,a,i,o=0,s=0,u=0,c=0,l=0,h=0;h<this.fftSize;h++)o+=this.analBuffers[0][h]*this.analBuffers[1][h],s+=this.analBuffers[0][h]*this.analBuffers[2][h],u+=this.analBuffers[0][h]*this.analBuffers[0][h],c+=this.analBuffers[1][h]*this.analBuffers[1][h],l+=this.analBuffers[2][h]*this.analBuffers[2][h];return t=[o,s],e=Math.sqrt(t[0]*t[0]+t[1]*t[1]),r=(u+c+l)/2,n=1-e/(r+1e-7),a=180*-Math.atan2(s,o)/Math.PI,i=0,[a,i,n,r]}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28,"get-float-time-domain-data":58}],7:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=t("spherical-harmonic-transform"),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(u),l=function(){function t(e,r){(0,i.default)(this,t),this.initialized=!1,this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.azim=0,this.elev=0,this.gains=new Array(this.nCh),this.gainNodes=new Array(this.nCh),this.in=this.ctx.createGain(),this.in.channelCountMode="explicit",this.in.channelCount=1,this.out=this.ctx.createChannelMerger(this.nCh);for(var n=0;n<this.nCh;n++)this.gainNodes[n]=this.ctx.createGain(),this.gainNodes[n].channelCountMode="explicit",this.gainNodes[n].channelCount=1;this.updateGains();for(var n=0;n<this.nCh;n++)this.in.connect(this.gainNodes[n]),this.gainNodes[n].connect(this.out,0,n);this.initialized=!0}return(0,s.default)(t,[{key:"updateGains",value:function(){for(var t=this.order,e=c.computeRealSH(t,[[this.azim*Math.PI/180,this.elev*Math.PI/180]]),r=0;r<this.nCh;r++)this.gains[r]=e[r][0],this.gainNodes[r].gain.value=this.gains[r]}}]),t}();r.default=l},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28,"spherical-harmonic-transform":90}],8:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=t("./utils.js"),c=function(){function t(e,r){(0,i.default)(this,t),this.initialized=!1,this.ctx=e,this.order=r,this.nCh=2*r+1,this.azim=0,this.elev=0,this.gains=new Array(this.nCh),this.gainNodes=new Array(this.nCh),this.in=this.ctx.createGain(),this.in.channelCountMode="explicit",this.in.channelCount=1,this.out=this.ctx.createChannelMerger(this.nCh);for(var n=0;n<this.nCh;n++)this.gainNodes[n]=this.ctx.createGain(),this.gainNodes[n].channelCountMode="explicit",this.gainNodes[n].channelCount=1;this.updateGains();for(var n=0;n<this.nCh;n++)this.in.connect(this.gainNodes[n]),this.gainNodes[n].connect(this.out,0,n);this.initialized=!0}return(0,s.default)(t,[{key:"updateGains",value:function(){for(var t=this.order,e=u.getCircHarmonics(t,[this.azim]),r=0;r<this.nCh;r++)this.gainNodes[r].gain.value=e[r][0]}}]),t}();r.default=c},{"./utils.js":24,"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],9:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=function(){function t(e,r,n){(0,i.default)(this,t),this.ctx=e,this.orderIn=r,this.orderOut=n<r?n:r,this.nChIn=(this.orderIn+1)*(this.orderIn+1),this.nChOut=(this.orderOut+1)*(this.orderOut+1),this.in=this.ctx.createChannelSplitter(this.nChIn),this.out=this.ctx.createChannelMerger(this.nChOut);for(var a=0;a<this.nChOut;a++)this.in.connect(this.out,a,a)}return(0,s.default)(t,[{key:"updateOrder",value:function(t){if(t<=this.orderIn){this.orderOut=t,this.nChOut=(this.orderOut+1)*(this.orderOut+1),this.out.disconnect(),this.out=this.ctx.createChannelMerger(this.nChOut);for(var e=0;e<this.nChOut;e++)this.in.connect(this.out,e,e)}}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],10:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=function(){function t(e,r,n){(0,i.default)(this,t),this.ctx=e,this.orderIn=r,this.orderOut=n<r?n:r,this.nChIn=2*this.orderIn+1,this.nChOut=2*this.orderOut+1,this.in=this.ctx.createChannelSplitter(this.nChIn),this.out=this.ctx.createChannelMerger(this.nChOut);for(var a=0;a<this.nChOut;a++)this.in.connect(this.out,a,a)}return(0,s.default)(t,[{key:"updateOrder",value:function(t){if(t<=this.orderIn){this.orderOut=t,this.nChOut=2*this.orderOut+1,this.out.disconnect(),this.out=this.ctx.createChannelMerger(this.nChOut);for(var e=0;e<this.nChOut;e++)this.in.connect(this.out,e,e)}}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],11:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=t("spherical-harmonic-transform"),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(u),l=function(){function t(e,r){(0,i.default)(this,t),this.ctx=e,this.order=r,this.nCh=(this.order+1)*(this.order+1),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh),this.orderGains=new Array(this.order+1),this.orderGains.fill(1);for(var n=0;n<this.nCh;n++)this.gains[n]=this.ctx.createGain(),this.in.connect(this.gains[n],n,0),this.gains[n].connect(this.out,0,n)}return(0,s.default)(t,[{key:"updateOrderGains",value:function(){for(var t,e=0;e<this.nCh;e++)t=Math.floor(Math.sqrt(e)),this.gains[e].gain.value=this.orderGains[t]}},{key:"computeMaxRECoeffs",value:function(){var t=this.order;this.orderGains[0]=1;for(var e=0,r=0,n=0,a=1;a<=t;a++)n=c.recurseLegendrePoly(a,[Math.cos(2.406809/(t+1.51))],e,r),this.orderGains[a]=n[0][0],r=e,e=n}}]),t}();r.default=l},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28,"spherical-harmonic-transform":90}],12:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var i=t("babel-runtime/helpers/classCallCheck"),o=a(i),s=t("babel-runtime/helpers/createClass"),u=a(s);t("get-float-time-domain-data");var c=t("numeric"),l=n(c),h=t("spherical-harmonic-transform"),f=n(h),d=t("./utils.js"),m=function(){function t(e,r,n){(0,o.default)(this,t),this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.fftSize=2048,this.analysers=new Array(this.nCh),this.analBuffers=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh);for(var a=0;a<this.nCh;a++)this.analysers[a]=this.ctx.createAnalyser(),this.analysers[a].fftSize=this.fftSize,this.analysers[a].smoothingTimeConstant=0,this.analBuffers[a]=new Float32Array(this.fftSize);for(var i=0;i<this.nCh;i++)this.in.connect(this.out,i,i),this.in.connect(this.analysers[i],i,0);var s=d.getTdesign(4*r);this.td_dirs_rad=d.deg2rad(s),this.SHmtx=f.computeRealSH(this.order,this.td_dirs_rad),this.mode=n}return(0,u.default)(t,[{key:"updateBuffers",value:function(){for(var t=0;t<this.nCh;t++)this.analysers[t].getFloatTimeDomainData(this.analBuffers[t])}},{key:"computePowermap",value:function(){for(var t=this.td_dirs_rad.length,e=l.dot(l.transpose(this.SHmtx),this.analBuffers),r=new Array(t),n=0;n<t;n++){for(var a=0;a<this.fftSize;a++){var i=0;i+=e[n][a]*e[n][a]}var i=i/this.fftSize;r[n]=[this.td_dirs_rad[n][0],this.td_dirs_rad[n][1],i]}if(0==this.mode)return r;if(1==this.mode){return f.forwardSHT(2*this.order,r)}}}]),t}();r.default=m},{"./utils.js":24,"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28,"get-float-time-domain-data":58,numeric:72,"spherical-harmonic-transform":90}],13:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o);t("get-float-time-domain-data");var u=function(){function t(e,r){(0,i.default)(this,t),this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.fftSize=2048,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.analysers=new Array(this.nCh),this.analBuffers=new Array(this.nCh);for(var n=0;n<this.nCh;n++)this.analysers[n]=this.ctx.createAnalyser(),this.analysers[n].fftSize=this.fftSize,this.analysers[n].smoothingTimeConstant=0,this.analBuffers[n]=new Float32Array(this.fftSize),this.in.connect(this.analysers[n],n,0),this.analysers[n].connect(this.out,0,n)}return(0,s.default)(t,[{key:"updateBuffers",value:function(){for(var t=0;t<this.nCh;t++)this.analysers[t].getFloatTimeDomainData(this.analBuffers[t])}},{key:"computeRMS",value:function(){var t=new Array(this.nCh);t.fill(0);for(var e=0;e<this.nCh;e++){for(var r=0;r<this.fftSize;r++)t[e]=t[e]+this.analBuffers[e][r]*this.analBuffers[e][r];t[e]=Math.sqrt(t[e]/this.fftSize)}return t}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28,"get-float-time-domain-data":58}],14:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=function(){function t(e,r){(0,i.default)(this,t),this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.mirrorPlane=0,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(var n=0;n<this.nCh;n++)this.gains[n]=this.ctx.createGain(),this.gains[n].gain.value=1,this.in.connect(this.gains[n],n,0),this.gains[n].connect(this.out,0,n)}return(0,s.default)(t,[{key:"reset",value:function(){for(var t=0;t<this.nCh;t++)this.gains[t].gain.value=1}},{key:"mirror",value:function(t){switch(t){case 0:this.mirrorPlane=0,this.reset();break;case 1:this.reset(),this.mirrorPlane=1;for(var e,r=0;r<=this.order;r++)for(var n=-r;n<=r;n++)e=r*r+r+n,(n<0&&n%2==0||n>0&&n%2==1)&&(this.gains[e].gain.value=-1);break;case 2:this.reset(),this.mirrorPlane=2;for(var e,r=0;r<=this.order;r++)for(var n=-r;n<=r;n++)e=r*r+r+n,n<0&&(this.gains[e].gain.value=-1);break;case 3:this.reset(),this.mirrorPlane=3;for(var e,r=0;r<=this.order;r++)for(var n=-r;n<=r;n++)e=r*r+r+n,(n+r)%2==1&&(this.gains[e].gain.value=-1);break;default:console.log("The mirroring planes can be either 1 (yz), 2 (xz), 3 (xy), or 0 (no mirroring). Value set to 0."),this.mirrorPlane=0,this.reset()}}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],15:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=function(){function t(e,r){(0,i.default)(this,t),this.ctx=e,this.order=r,this.nCh=2*r+1,this.mirrorPlane=0,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=new Array(this.nCh);for(var n=0;n<this.nCh;n++)this.gains[n]=this.ctx.createGain(),this.gains[n].gain.value=1,this.in.connect(this.gains[n],n,0),this.gains[n].connect(this.out,0,n)}return(0,s.default)(t,[{key:"reset",value:function(){for(var t=0;t<this.nCh;t++)this.gains[t].gain.value=1}},{key:"mirror",value:function(t){switch(t){case 0:this.mirrorPlane=0,this.reset();break;case 1:this.reset(),this.mirrorPlane=1;for(var e=2;e<this.nCh;e++)this.gains[e].gain.value=-1,e%2!=0&&(e+=2);break;case 2:this.reset(),this.mirrorPlane=2;for(var e=0;e<this.nCh;e++)e%2!=0&&(this.gains[e].gain.value=-1);break;case 3:console.log("up-down mirroring in 2D mode not possible");break;default:console.log("The mirroring planes can be either 1 (yz), 2 (xz) or 0 (no mirroring). Value set to 0."),this.mirrorPlane=0,this.reset()}}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],16:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=t("spherical-harmonic-transform"),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(u),l=function(){function t(e,r){(0,i.default)(this,t),this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.yaw=0,this.pitch=0,this.roll=0,this.rotMtx=numeric.identity(this.nCh),this.rotMtxNodes=new Array(this.order),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh);for(var n=1;n<=this.order;n++){for(var a=new Array(2*n+1),o=0;o<2*n+1;o++){a[o]=new Array(2*n+1);for(var s=0;s<2*n+1;s++)a[o][s]=this.ctx.createGain(),a[o][s].gain.value=o==s?1:0}this.rotMtxNodes[n-1]=a}this.in.connect(this.out,0,0);var u=1;for(n=1;n<=this.order;n++){for(o=0;o<2*n+1;o++)for(s=0;s<2*n+1;s++)this.in.connect(this.rotMtxNodes[n-1][o][s],u+s,0),this.rotMtxNodes[n-1][o][s].connect(this.out,0,u+o);u=u+2*n+1}}return(0,s.default)(t,[{key:"updateRotMtx",value:function(){var t=this.yaw*Math.PI/180,e=this.pitch*Math.PI/180,r=this.roll*Math.PI/180;this.rotMtx=c.getSHrotMtx(c.yawPitchRoll2Rzyx(t,e,r),this.order);for(var n=1,a=1;a<this.order+1;a++){for(var i=0;i<2*a+1;i++)for(var o=0;o<2*a+1;o++)this.rotMtxNodes[a-1][i][o].gain.value=this.rotMtx[n+i][n+o];n=n+2*a+1}}}]),t}();r.default=l},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28,"spherical-harmonic-transform":90}],17:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=function(){function t(e,r){(0,i.default)(this,t),this.ctx=e,this.order=r,this.nCh=2*r+1,this.yaw=0,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.rotMtxNodes=new Array(2*this.order),this.in.connect(this.out,0,0);for(var n=0;n<2*this.order;n+=2){var a=new Array(2);a[0]=this.ctx.createGain(),a[1]=this.ctx.createGain();var o=new Array(2);o[0]=this.ctx.createGain(),o[1]=this.ctx.createGain(),this.rotMtxNodes[n]=a,this.rotMtxNodes[n+1]=o,this.in.connect(this.rotMtxNodes[n][0],n+1,0),this.rotMtxNodes[n][0].connect(this.out,0,n+1),this.in.connect(this.rotMtxNodes[n][1],n+2,0),this.rotMtxNodes[n][1].connect(this.out,0,n+1),this.in.connect(this.rotMtxNodes[n+1][0],n+1,0),this.rotMtxNodes[n+1][0].connect(this.out,0,n+2),this.in.connect(this.rotMtxNodes[n+1][1],n+2,0),this.rotMtxNodes[n+1][1].connect(this.out,0,n+2)}this.updateRotMtx()}return(0,s.default)(t,[{key:"updateRotMtx",value:function(){for(var t=this.yaw*Math.PI/180,e=1,r=0;r<2*this.order;r+=2)this.rotMtxNodes[r][0].gain.value=Math.cos(e*t),this.rotMtxNodes[r][1].gain.value=Math.sin(e*t),this.rotMtxNodes[r+1][0].gain.value=-Math.sin(e*t),this.rotMtxNodes[r+1][1].gain.value=Math.cos(e*t),e++}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],18:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=t("spherical-harmonic-transform"),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(u),l=function(){function t(e,r){(0,i.default)(this,t),this.initialized=!1,this.ctx=e,this.order=r,this.nCh=(r+1)*(r+1),this.azim=0,this.elev=0,this.vmicGains=new Array(this.nCh),this.vmicGainNodes=new Array(this.nCh),this.vmicCoeffs=new Array(this.order+1),this.vmicPattern="hypercardioid",this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createGain();for(var n=0;n<this.nCh;n++)this.vmicGainNodes[n]=this.ctx.createGain();for(this.SHxyz=new Array(this.nCh),this.SHxyz.fill(0),this.updatePattern(),this.updateOrientation(),n=0;n<this.nCh;n++)this.in.connect(this.vmicGainNodes[n],n,0),this.vmicGainNodes[n].connect(this.out);this.initialized=!0}return(0,s.default)(t,[{key:"updatePattern",value:function(){function t(t){for(var e=new Array(t+1),r=(t+1)*(t+1),n=0;n<=t;n++)e[n]=1/r;return e}switch(this.vmicPattern){case"cardioid":this.vmicCoeffs=function(t){for(var e=new Array(t+1),r=0;r<=t;r++)e[r]=c.factorial(t)*c.factorial(t)/(c.factorial(t+r+1)*c.factorial(t-r));return e}(this.order);break;case"supercardioid":this.vmicCoeffs=function(t){switch(t){case 1:var e=[.366,.2113];break;case 2:var e=[.2362,.1562,.059];break;case 3:var e=[.1768,.1281,.0633,.0175];break;case 4:var e=[.1414,.1087,.0623,.0247,.0054];break;default:return void console.error("Orders should be in the range of 1-4 at the moment.")}return e}(this.order);break;case"hypercardioid":this.vmicCoeffs=t(this.order);break;case"max_rE":this.vmicCoeffs=function(t){var e=new Array(t+1);e[0]=1;for(var r=0,n=0,a=0,i=1;i<t+1;i++)a=c.recurseLegendrePoly(i,[Math.cos(2.406809/(t+1.51))],r,n),e[i]=a[0][0],n=r,r=a;for(var o=0,i=0;i<=t;i++)o+=e[i]*(2*i+1);for(var i=0;i<=t;i++)e[i]=e[i]/o;return e}(this.order);break;default:this.vmicPattern="hypercardioid",this.vmicCoeffs=t(this.order)}this.updateGains()}},{key:"updateOrientation",value:function(){for(var t=this.azim*Math.PI/180,e=this.elev*Math.PI/180,r=c.computeRealSH(this.order,[[t,e]]),n=0;n<this.nCh;n++)this.SHxyz[n]=r[n][0];this.updateGains()}},{key:"updateGains",value:function(){for(var t,e=0;e<=this.order;e++)for(var r=-e;r<=e;r++)t=e*e+e+r,this.vmicGains[t]=this.vmicCoeffs[e]*this.SHxyz[t];for(var n=0;n<this.nCh;n++)this.vmicGainNodes[n].gain.value=this.vmicGains[n]}}]),t}();r.default=l},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28,"spherical-harmonic-transform":90}],19:[function(t,e,r){
"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=function(){function t(e,r,n,a){function o(t,e){return("000000000"+t).substr(-e)}(0,i.default)(this,t),this.context=e,this.order=r,this.nCh=(r+1)*(r+1),this.nChGroups=Math.ceil(this.nCh/8),this.buffers=new Array,this.loadCount=0,this.loaded=!1,this.onLoad=a,this.urls=new Array(this.nChGroups);var s=n.slice(n.length-3,n.length);this.fileExt=s;for(var u=0;u<this.nChGroups;u++)u==this.nChGroups-1?this.urls[u]=n.slice(0,n.length-4)+"_"+o(8*u+1,2)+"-"+o(this.nCh,2)+"ch."+s:this.urls[u]=n.slice(0,n.length-4)+"_"+o(8*u+1,2)+"-"+o(8*u+8,2)+"ch."+s}return(0,s.default)(t,[{key:"loadBuffers",value:function(t,e){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer";var n=this;r.onload=function(){n.context.decodeAudioData(r.response,function(r){if(!r)return void alert("error decoding file data: "+t);n.buffers[e]=r,++n.loadCount==n.nChGroups&&(n.loaded=!0,n.concatBuffers(),console.log("HOAloader: all buffers loaded and concatenated"),n.onLoad(n.concatBuffer))},function(e){alert("Browser cannot decode audio data:  "+t+"\n\nError: "+e+"\n\n(If you re using Safari and get a null error, this is most likely due to Apple's shady plan going on to stop the .ogg format from easing web developer's life :)")})},r.onerror=function(){alert("HOAloader: XHR error")},r.send()}},{key:"load",value:function(){for(var t=0;t<this.nChGroups;++t)this.loadBuffers(this.urls[t],t)}},{key:"concatBuffers",value:function(){if(this.loaded){var t=this.nCh,e=this.nChGroups,r=this.buffers[0].length;this.buffers.forEach(function(t){r=Math.max(r,t.length)});var n=this.buffers[0].sampleRate,a=[1,2,3,4,5,6,7,8];"ogg"==this.fileExt.toLowerCase()&&(console.log("Loading of 8chan OGG files [Chrome/Firefox]: remap channels to correct order!"),a=[1,3,2,7,8,5,6,4]),this.concatBuffer=this.context.createBuffer(t,r,n);for(var i=0;i<e;i++)for(var o=0;o<this.buffers[i].numberOfChannels;o++)this.concatBuffer.getChannelData(8*i+o).set(this.buffers[i].getChannelData(a[o]-1))}}}]),t}();r.default=u},{"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],20:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=t("./utils.js"),c=function(){function t(e,r,n){(0,i.default)(this,t),this.context=e,this.order=r,this.nCh=2*r+1,this.onLoad=n,this.vls_dirs_deg=u.sampleCircle(2*this.order+2),this.nVLS=this.vls_dirs_deg.length,this.nearestLookupRes=[5,5]}return(0,s.default)(t,[{key:"load",value:function(t){var e=this,r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="json",r.onload=function(){e.parseHrirFromJSON(r.response),e.nearestLookup=u.createNearestLookup(e.hrir_dirs_deg,e.nearestLookupRes);var t=u.findNearest(e.vls_dirs_deg,e.nearestLookup,e.nearestLookupRes);e.nearest_dirs_deg=e.getClosestDirs(t,e.hrir_dirs_deg),e.vls_hrirs=e.getClosestHrirFilters(t,e.hrirs),e.computeDecFilters()},r.send()}},{key:"parseHrirFromJSON",value:function(t){var e=this;this.fs=t.leaves[6].data[0],this.nHrirs=t.leaves[4].data.length,this.nSamples=t.leaves[8].data[0][1].length,this.hrir_dirs_deg=[],t.leaves[4].data.forEach(function(t){e.hrir_dirs_deg.push([t[0],t[1]])}),this.hrirs=[],t.leaves[8].data.forEach(function(t){var r=new Float64Array(t[0]),n=new Float64Array(t[1]);e.hrirs.push([r,n])})}},{key:"getClosestDirs",value:function(t,e){for(var r=t.length,n=[],a=0;a<r;a++)n.push(e[t[a]]);return n}},{key:"getClosestHrirFilters",value:function(t,e){for(var r=t.length,n=[],a=0;a<r;a++)n.push(e[t[a]]);return n}},{key:"computeDecFilters",value:function(){var t=[];t.push(1);for(var e=1;e<this.order+1;e++)t.push(Math.cos(e*Math.PI/(2*this.order+2))),t.push(Math.cos(e*Math.PI/(2*this.order+2)));var r=numeric.diag(t);this.decodingMatrix=numeric.transpose(u.getCircHarmonics(this.order,u.getColumn(this.vls_dirs_deg,0))),this.decodingMatrix=numeric.dot(this.decodingMatrix,r),this.decodingMatrix=numeric.mul(2*Math.PI/this.vls_dirs_deg.length,this.decodingMatrix),this.hoaBuffer=this.getHoaFilterFromHrirFilter(this.nCh,this.nSamples,this.fs,this.vls_hrirs,this.decodingMatrix),this.onLoad(this.hoaBuffer)}},{key:"getHoaFilterFromHrirFilter",value:function(t,e,r,n,a){e>n[0][0].length&&(e=n[0][0].length);for(var i=this.context.createBuffer(t,e,r),o=0;o<t;o++){for(var s=new Float32Array(e),u=0;u<n.length;u++)for(var c=0;c<e;c++)s[c]+=a[u][o]*n[u][0][c];i.getChannelData(o).set(s)}return i}}]),t}();r.default=c},{"./utils.js":24,"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],21:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=t("serve-sofa-hrir"),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(u),l=t("./utils.js"),h=function(){function t(e,r,n){(0,i.default)(this,t),this.context=e,this.order=r,this.nCh=(r+1)*(r+1),this.onLoad=n,this.hrtfSet=new c.HrtfSet({audioContext:this.context,coordinateSystem:"sofaSpherical"}),this.wishedSpeakerPos=l.getTdesign(2*this.order)}return(0,s.default)(t,[{key:"load",value:function(t){var e=this;this.hrtfSet.load(t).then(function(){var t=[];e.hrirBuffer=[];for(var r=0;r<e.wishedSpeakerPos.length;r++)t.push(e.hrtfSet.nearest(e.wishedSpeakerPos[r]).position),e.hrirBuffer.push(e.hrtfSet.nearest(e.wishedSpeakerPos[r]).fir);for(var n=0,a=0;a<e.wishedSpeakerPos.length;a++)e.wishedSpeakerPos[a][0]<0&&(e.wishedSpeakerPos[a][0]+=360),n+=Math.sqrt(Math.pow(e.wishedSpeakerPos[a][0]-t[a][0],2)+Math.pow(e.wishedSpeakerPos[a][1]-t[a][1],2));console.log("summed / average angular dist between asked and present pos:",Math.round(100*n)/100,"deg /",Math.round(n/e.wishedSpeakerPos.length*100)/100,"deg"),e.decodingMatrix=l.getAmbisonicDecMtx(t,e.order),e.hoaBuffer=e.getHoaFilterFromHrirFilter(),e.onLoad(e.hoaBuffer)})}},{key:"getHoaFilterFromHrirFilter",value:function(){for(var t=this.hrirBuffer[0].length,e=this.hrirBuffer[0].sampleRate,r=this.context.createBuffer(this.nCh,t,e),n=0;n<this.nCh;n++){for(var a=new Float32Array(t),i=0;i<this.hrirBuffer.length;i++)for(var o=0;o<t;o++)a[o]+=this.decodingMatrix[i][n]*this.hrirBuffer[i].getChannelData(0)[o];r.getChannelData(n).set(a)}return r}}]),t}();r.default=h},{"./utils.js":24,"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28,"serve-sofa-hrir":81}],22:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var a=t("babel-runtime/helpers/classCallCheck"),i=n(a),o=t("babel-runtime/helpers/createClass"),s=n(o),u=t("./utils.js"),c=function(){function t(e,r,n){(0,i.default)(this,t),this.context=e,this.order=r,this.nCh=(r+1)*(r+1),this.onLoad=n,this.vls_dirs_deg=u.getTdesign(2*this.order),this.nVLS=this.vls_dirs_deg.length,this.nearestLookupRes=[5,5]}return(0,s.default)(t,[{key:"load",value:function(t){var e=this,r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="json",r.onload=function(){e.parseHrirFromJSON(r.response),e.nearestLookup=u.createNearestLookup(e.hrir_dirs_deg,e.nearestLookupRes);var t=u.findNearest(e.vls_dirs_deg,e.nearestLookup,e.nearestLookupRes);e.nearest_dirs_deg=e.getClosestDirs(t,e.hrir_dirs_deg),e.vls_hrirs=e.getClosestHrirFilters(t,e.hrirs),e.computeDecFilters()},r.send()}},{key:"parseHrirFromJSON",value:function(t){var e=this;this.fs=t.leaves[6].data[0],this.nHrirs=t.leaves[4].data.length,this.nSamples=t.leaves[8].data[0][1].length,this.hrir_dirs_deg=[],t.leaves[4].data.forEach(function(t){e.hrir_dirs_deg.push([t[0],t[1]])}),this.hrirs=[],t.leaves[8].data.forEach(function(t){var r=new Float64Array(t[0]),n=new Float64Array(t[1]);e.hrirs.push([r,n])})}},{key:"getClosestDirs",value:function(t,e){for(var r=t.length,n=[],a=0;a<r;a++)n.push(e[t[a]]);return n}},{key:"getClosestHrirFilters",value:function(t,e){for(var r=t.length,n=[],a=0;a<r;a++)n.push(e[t[a]]);return n}},{key:"computeDecFilters",value:function(){this.decodingMatrix=u.getAmbiBinauralDecMtx(this.nearest_dirs_deg,this.order),this.hoaBuffer=this.getHoaFilterFromHrirFilter(this.nCh,this.nSamples,this.fs,this.vls_hrirs,this.decodingMatrix),this.onLoad(this.hoaBuffer)}},{key:"getHoaFilterFromHrirFilter",value:function(t,e,r,n,a){e>n[0][0].length&&(e=n[0][0].length);for(var i=this.context.createBuffer(t,e,r),o=0;o<t;o++){for(var s=new Float32Array(e),u=0;u<n.length;u++)for(var c=0;c<e;c++)s[c]+=a[u][o]*n[u][0][c];i.getChannelData(o).set(s)}return i}}]),t}();r.default=c},{"./utils.js":24,"babel-runtime/helpers/classCallCheck":27,"babel-runtime/helpers/createClass":28}],23:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.converters=r.HRIRloader_ircam=r.HRIRloader2D_local=r.HRIRloader_local=r.HOAloader=r.intensityAnalyser2D=r.intensityAnalyser=r.powermapAnalyser=r.rmsAnalyser=r.virtualMic=r.decoder=r.binDecoder2D=r.binDecoder=r.sceneMirror2D=r.sceneMirror=r.sceneRotator2D=r.sceneRotator=r.orderWeight=r.orderLimiter2D=r.orderLimiter=r.monoEncoder2D=r.monoEncoder=void 0;var i=t("./ambi-monoEncoder");Object.defineProperty(r,"monoEncoder",{enumerable:!0,get:function(){return a(i).default}});var o=t("./ambi-monoEncoder2D");Object.defineProperty(r,"monoEncoder2D",{enumerable:!0,get:function(){return a(o).default}});var s=t("./ambi-orderLimiter");Object.defineProperty(r,"orderLimiter",{enumerable:!0,get:function(){return a(s).default}});var u=t("./ambi-orderLimiter2D");Object.defineProperty(r,"orderLimiter2D",{enumerable:!0,get:function(){return a(u).default}});var c=t("./ambi-orderWeight");Object.defineProperty(r,"orderWeight",{enumerable:!0,get:function(){return a(c).default}});var l=t("./ambi-sceneRotator");Object.defineProperty(r,"sceneRotator",{enumerable:!0,get:function(){return a(l).default}});var h=t("./ambi-sceneRotator2D");Object.defineProperty(r,"sceneRotator2D",{enumerable:!0,get:function(){return a(h).default}});var f=t("./ambi-sceneMirror");Object.defineProperty(r,"sceneMirror",{enumerable:!0,get:function(){return a(f).default}});var d=t("./ambi-sceneMirror2D");Object.defineProperty(r,"sceneMirror2D",{enumerable:!0,get:function(){return a(d).default}});var m=t("./ambi-binauralDecoder");Object.defineProperty(r,"binDecoder",{enumerable:!0,get:function(){return a(m).default}});var p=t("./ambi-binauralDecoder2D");Object.defineProperty(r,"binDecoder2D",{enumerable:!0,get:function(){return a(p).default}});var v=t("./ambi-decoder");Object.defineProperty(r,"decoder",{enumerable:!0,get:function(){return a(v).default}});var g=t("./ambi-virtualMic");Object.defineProperty(r,"virtualMic",{enumerable:!0,get:function(){return a(g).default}});var M=t("./ambi-rmsAnalyser");Object.defineProperty(r,"rmsAnalyser",{enumerable:!0,get:function(){return a(M).default}});var b=t("./ambi-powermapAnalyser");Object.defineProperty(r,"powermapAnalyser",{enumerable:!0,get:function(){return a(b).default}});var y=t("./ambi-intensityAnalyser");Object.defineProperty(r,"intensityAnalyser",{enumerable:!0,get:function(){return a(y).default}});var x=t("./ambi-intensityAnalyser2D");Object.defineProperty(r,"intensityAnalyser2D",{enumerable:!0,get:function(){return a(x).default}});var S=t("./hoa-loader");Object.defineProperty(r,"HOAloader",{enumerable:!0,get:function(){return a(S).default}});var w=t("./hrir-loader_local");Object.defineProperty(r,"HRIRloader_local",{enumerable:!0,get:function(){return a(w).default}});var D=t("./hrir-loader2D_local");Object.defineProperty(r,"HRIRloader2D_local",{enumerable:!0,get:function(){return a(D).default}});var I=t("./hrir-loader_ircam");Object.defineProperty(r,"HRIRloader_ircam",{enumerable:!0,get:function(){return a(I).default}});var F=t("./ambi-converters"),_=n(F),C=t("./utils"),A=n(C);r.converters=_,r.utils=A},{"./ambi-binauralDecoder":1,"./ambi-binauralDecoder2D":2,"./ambi-converters":3,"./ambi-decoder":4,"./ambi-intensityAnalyser":5,"./ambi-intensityAnalyser2D":6,"./ambi-monoEncoder":7,"./ambi-monoEncoder2D":8,"./ambi-orderLimiter":9,"./ambi-orderLimiter2D":10,"./ambi-orderWeight":11,"./ambi-powermapAnalyser":12,"./ambi-rmsAnalyser":13,"./ambi-sceneMirror":14,"./ambi-sceneMirror2D":15,"./ambi-sceneRotator":16,"./ambi-sceneRotator2D":17,"./ambi-virtualMic":18,"./hoa-loader":19,"./hrir-loader2D_local":20,"./hrir-loader_ircam":21,"./hrir-loader_local":22,"./utils":24}],24:[function(t,e,r){"use strict";function n(t){for(var e=[],r=Math.PI/180,n=0;n<t.length;n++)3==t[0].length?e.push([t[n][0]*r,t[n][1]*r,t[n][2]]):2==t[0].length&&e.push([t[n][0]*r,t[n][1]*r]);return e}function a(t){for(var e=[],r=180/Math.PI,n=0;n<t.length;n++)3==t[0].length?e.push([t[n][0]*r,t[n][1]*r,t[n][2]]):2==t[0].length&&e.push([t[n][0]*r,t[n][1]*r]);return e}function i(t,e){return t.map(function(t){return t[e]})}function o(t){for(var e=[],r=360/t,n=0,a=0;a<t;a++)e.push([n,0,1]),n+=r;return e}function s(t,e){var r=t,n=2*r+1,a=e.length,i=new Array(n),o=new Array(a);e=f.mul(e,Math.PI/180),o.fill(1/Math.sqrt(2*Math.PI)),i[0]=o;for(var s=0;s<r;s++)i[2*s+1]=f.div(f.sin(f.mul(-(s+1),e)),Math.sqrt(Math.PI)),i[2*s+2]=f.div(f.cos(f.mul(s+1,e)),Math.sqrt(Math.PI));return i}function u(t,e){for(var r=n(t),a=d.convertSph2Cart(r),i=m(a),o=i.length,s=r.length,u=new Array(o),c=0;c<o;c++){for(var l=new Array(3),v=0;v<3;v++)l[v]=a[i[c][v]];for(var g=f.inv(l),M=[],b=0;b<3;b++)for(var y=0;y<3;y++)M.push(g[y][b]);u[c]=M}var x=h(2*e),S=n(x),w=p(S,i,u,s);w=f.transpose(w);var D=d.computeRealSH(e,S);D=f.transpose(D);var I=S.length,F=f.dotMMsmall(w,D);return F=f.mul(1/I,F)}function c(t,e){var r=t.length,a=d.convertSph2Cart(n(t)),i=Math.round(360/e[0])+1,o=Math.round(180/e[1])+1,s=new Array(i);s[0]=-180;for(var u=1;u<i;u++)s[u]=s[u-1]+e[0];for(var c=i*o,l=new Array(c),h=0;h<c;h++)for(var m=[[h%i*e[0]-180,Math.floor(h/i)*e[1]-90]],p=d.convertSph2Cart(n(m)),v=1e3,g=0;g<r;g++){var M=f.sum(f.pow(f.sub(p[0],a[g]),2));M<v&&(l[h]=g,v=M)}return l}function l(t,e,r){for(var n=t.length,a=[],i=[],o=0;o<n;o++)a.push(t[o][0]+180),i.push(t[o][1]+90);for(var s=Math.round(360/r[0])+1,u=f.round(f.div(f.mod(a,360),r[0])),c=f.round(f.div(i,r[1])),l=f.add(f.mul(c,s),u,1),h=[],d=0;d<n;d++)h.push(e[l[d]]);return h}function h(t){if(t>21)throw new Error("Designs of order greater than 21 are not implemented");if(t<1)throw new Error("Order should be at least 1")
;return[[[0,0,1],[180,0,1]],[[45,35.26,1],[-45,-35.26,1],[135,-35.26,1],[-135,35.26,1]],[[0,0,1],[180,0,1],[90,0,1],[-90,0,1],[0,90,1],[0,-90,1]],[[0,-31.72,1],[-58.28,0,1],[-90,58.28,1],[0,31.72,1],[-121.72,0,1],[90,-58.28,1],[180,-31.72,1],[121.72,0,1],[90,58.28,1],[180,31.72,1],[58.28,0,1],[-90,-58.28,1]],[[0,-31.72,1],[-58.28,0,1],[-90,58.28,1],[0,31.72,1],[-121.72,0,1],[90,-58.28,1],[180,-31.72,1],[121.72,0,1],[90,58.28,1],[180,31.72,1],[58.28,0,1],[-90,-58.28,1]],[[26,15.46,1],[-26,-15.46,1],[17.11,-24.99,1],[-17.11,24.99,1],[154,-15.46,1],[-154,15.46,1],[162.89,24.99,1],[-162.89,-24.99,1],[72.89,24.99,1],[107.11,-24.99,1],[116,15.46,1],[64,-15.46,1],[-107.11,24.99,1],[-72.89,-24.99,1],[-64,15.46,1],[-116,-15.46,1],[32.25,60.03,1],[-147.75,60.03,1],[-57.75,60.03,1],[122.25,60.03,1],[-32.25,-60.03,1],[147.75,-60.03,1],[57.75,-60.03,1],[-122.25,-60.03,1]],[[26,15.46,1],[-26,-15.46,1],[17.11,-24.99,1],[-17.11,24.99,1],[154,-15.46,1],[-154,15.46,1],[162.89,24.99,1],[-162.89,-24.99,1],[72.89,24.99,1],[107.11,-24.99,1],[116,15.46,1],[64,-15.46,1],[-107.11,24.99,1],[-72.89,-24.99,1],[-64,15.46,1],[-116,-15.46,1],[32.25,60.03,1],[-147.75,60.03,1],[-57.75,60.03,1],[122.25,60.03,1],[-32.25,-60.03,1],[147.75,-60.03,1],[57.75,-60.03,1],[-122.25,-60.03,1]],[[-31.11,53.65,1],[110.82,30.5,1],[148.89,53.65,1],[32.21,-17.83,1],[69.18,-30.5,1],[-32.21,17.83,1],[-69.18,30.5,1],[-147.79,-17.83,1],[-110.82,-30.5,1],[147.79,17.83,1],[31.11,-53.65,1],[-148.89,-53.65,1],[-21.25,-47.78,1],[-108.2,38.78,1],[158.75,-47.78,1],[139.77,-14.09,1],[-71.8,-38.78,1],[-139.77,14.09,1],[71.8,38.78,1],[-40.23,-14.09,1],[108.2,-38.78,1],[40.23,14.09,1],[21.25,47.78,1],[-158.75,47.78,1],[106.65,-2.55,1],[-2.66,-16.63,1],[-73.35,-2.55,1],[-98.84,73.16,1],[-177.34,16.63,1],[98.84,-73.16,1],[177.34,-16.63,1],[81.16,73.16,1],[2.66,16.63,1],[-81.16,-73.16,1],[-106.65,2.55,1],[73.35,2.55,1]],[[20.75,-3.55,1],[-20.75,3.55,1],[-3.8,-20.7,1],[3.8,20.7,1],[159.25,3.55,1],[-159.25,-3.55,1],[-176.2,20.7,1],[176.2,-20.7,1],[93.8,20.7,1],[86.2,-20.7,1],[110.75,-3.55,1],[69.25,3.55,1],[-86.2,20.7,1],[-93.8,-20.7,1],[-69.25,-3.55,1],[-110.75,3.55,1],[-9.94,68.97,1],[170.06,68.97,1],[-99.94,68.97,1],[80.06,68.97,1],[9.94,-68.97,1],[-170.06,-68.97,1],[99.94,-68.97,1],[-80.06,-68.97,1],[42.15,17.57,1],[-42.15,-17.57,1],[23.12,-39.77,1],[-23.12,39.77,1],[137.85,-17.57,1],[-137.85,17.57,1],[156.88,39.77,1],[-156.88,-39.77,1],[66.88,39.77,1],[113.12,-39.77,1],[132.15,17.57,1],[47.85,-17.57,1],[-113.12,39.77,1],[-66.88,-39.77,1],[-47.85,17.57,1],[-132.15,-17.57,1],[25.26,44.98,1],[-154.74,44.98,1],[-64.74,44.98,1],[115.26,44.98,1],[-25.26,-44.98,1],[154.74,-44.98,1],[64.74,-44.98,1],[-115.26,-44.98,1]],[[144.09,-21.45,1],[-33.81,-48.92,1],[-35.91,-21.45,1],[-115.87,33.09,1],[-146.19,48.92,1],[115.87,-33.09,1],[146.19,-48.92,1],[64.13,33.09,1],[33.81,48.92,1],[-64.13,-33.09,1],[-144.09,21.45,1],[35.91,21.45,1],[-45.53,1.95,1],[177.26,44.44,1],[134.47,1.95,1],[87.21,-45.49,1],[2.74,-44.44,1],[-87.21,45.49,1],[-2.74,44.44,1],[-92.79,-45.49,1],[-177.26,-44.44,1],[92.79,45.49,1],[45.53,-1.95,1],[-134.47,-1.95,1],[15.59,-73.34,1],[-85.4,16.04,1],[-164.41,-73.34,1],[163.92,4.42,1],[-94.6,-16.04,1],[-163.92,-4.42,1],[94.6,16.04,1],[-16.08,4.42,1],[85.4,-16.04,1],[16.08,-4.42,1],[-15.59,73.34,1],[164.41,73.34,1],[-60.02,25.27,1],[151.41,26.86,1],[119.98,25.27,1],[46.63,-51.57,1],[28.59,-26.86,1],[-46.63,51.57,1],[-28.59,26.86,1],[-133.37,-51.57,1],[-151.41,-26.86,1],[133.37,51.57,1],[60.02,-25.27,1],[-119.98,-25.27,1],[-109.94,6.91,1],[172.65,-19.79,1],[70.06,6.91,1],[-70.44,-68.94,1],[7.35,19.79,1],[70.44,68.94,1],[-7.35,-19.79,1],[109.56,-68.94,1],[-172.65,19.79,1],[-109.56,68.94,1],[109.94,-6.91,1],[-70.06,-6.91,1]],[[132.93,7.69,1],[-83.93,-23.73,1],[8.47,23.51,1],[-113.34,70.42,1],[-103.27,-9.9,1],[-33.24,-70.75,1],[21.86,-26.46,1],[-156.54,47.78,1],[-64.26,-7.72,1],[165.78,44.53,1],[-25.2,26.39,1],[-97,-44.66,1],[27.85,9.77,1],[153.21,-47.71,1],[-155.06,7.45,1],[-11.84,-23.59,1],[80.54,23.72,1],[-42.06,70.44,1],[-31.22,-9.84,1],[38.84,-70.5,1],[93.76,-26.29,1],[-84.76,47.61,1],[7.76,-7.52,1],[-122.28,44.29,1],[46.8,26.64,1],[-24.77,-44.57,1],[99.89,9.91,1],[-134.78,-47.96,1],[-83.09,7.3,1],[60.13,-23.34,1],[152.64,23.64,1],[29.76,70.68,1],[40.78,-9.58,1],[110.18,-70.39,1],[165.65,-26.43,1],[-12.99,47.75,1],[79.74,-7.31,1],[-50.52,44.26,1],[118.92,26.71,1],[47.22,-44.31,1],[171.93,9.76,1],[-62.51,-48.04,1],[-11.12,7.44,1],[132.02,-23.33,1],[-135.36,23.39,1],[102.37,70.82,1],[112.74,-9.49,1],[-178.3,-70.58,1],[-122.32,-26.67,1],[59.08,48,1],[151.7,-7.38,1],[21.38,44.5,1],[-169.01,26.5,1],[118.98,-44.25,1],[-116.09,9.52,1],[9.65,-47.83,1],[60.89,7.68,1],[-156.02,-23.57,1],[-63.46,23.31,1],[174.93,70.66,1],[-175.29,-9.68,1],[-105.95,-70.8,1],[-50.19,-26.7,1],[131.36,48.01,1],[-136.3,-7.64,1],[93.56,44.67,1],[-97.08,26.3,1],[-169.16,-44.46,1],[-44.13,9.52,1],[81.48,-47.62,1]],[[-154.47,7.9,1],[162.15,-63.36,1],[25.53,7.9,1],[-81.26,-25.27,1],[17.85,63.36,1],[81.26,25.27,1],[-17.85,-63.36,1],[98.74,-25.27,1],[-162.15,63.36,1],[-98.74,25.27,1],[154.47,-7.9,1],[-25.53,-7.9,1],[1.3,-10.47,1],[-83.01,79.45,1],[-178.7,-10.47,1],[100.48,1.28,1],[-96.99,-79.45,1],[-100.48,-1.28,1],[96.99,79.45,1],[-79.52,1.28,1],[83.01,-79.45,1],[79.52,-1.28,1],[-1.3,10.47,1],[178.7,10.47,1],[157.24,13.15,1],[31.14,-63.89,1],[-22.76,13.15,1],[-75.78,22.13,1],[148.86,63.89,1],[75.78,-22.13,1],[-148.86,-63.89,1],[104.22,22.13,1],[-31.14,63.89,1],[-104.22,-22.13,1],[-157.24,-13.15,1],[22.76,-13.15,1],[110.44,-60.62,1],[-62.18,-9.87,1],[-69.56,-60.62,1],[-168.88,27.37,1],[-117.82,9.87,1],[168.88,-27.37,1],[117.82,-9.87,1],[11.12,27.37,1],[62.18,9.87,1],[-11.12,-27.37,1],[-110.44,60.62,1],[69.56,60.62,1],[-125.93,-47.4,1],[-126.67,-23.4,1],[54.07,-47.4,1],[-151.65,-33.24,1],[-53.33,23.4,1],[151.65,33.24,1],[53.33,-23.4,1],[28.35,-33.24,1],[126.67,23.4,1],[-28.35,33.24,1],[125.93,47.4,1],[-54.07,47.4,1],[61.41,37.54,1],[41.19,22.3,1],[-118.59,37.54,1],[31.92,44.13,1],[138.81,-22.3,1],[-31.92,-44.13,1],[-138.81,22.3,1],[-148.08,44.13,1],[-41.19,-22.3,1],[148.08,-44.13,1],[-61.41,-37.54,1],[118.59,-37.54,1],[132.92,4.73,1],[6.45,-42.74,1],[-47.08,4.73,1],[-83.07,46.87,1],[173.55,42.74,1],[83.07,-46.87,1],[-173.55,-42.74,1],[96.93,46.87,1],[-6.45,42.74,1],[-96.93,-46.87,1],[-132.92,-4.73,1],[47.08,-4.73,1]],[[-40.36,68.7,1],[61.12,65.68,1],[141.73,70.75,1],[-131.25,72.32,1],[-154.88,-12.62,1],[-66.2,-9.78,1],[26.36,-11.97,1],[114.95,-12.58,1],[37.02,51.13,1],[129.77,51.95,1],[-140.63,50.15,1],[-56.5,47.88,1],[-65.05,12.58,1],[25.12,12.62,1],[113.8,9.78,1],[-153.64,11.97,1],[-134.51,-9.73,1],[-46.23,-8.37,1],[47.91,-9.73,1],[141.51,-8.73,1],[-17.84,-44.1,1],[69.37,-43.27,1],[151.22,-42.67,1],[-106.78,-40.18,1],[-50.23,-51.95,1],[39.37,-50.15,1],[123.5,-47.88,1],[-142.98,-51.13,1],[-179.19,-60.75,1],[-84.57,-54.07,1],[5.39,-58.05,1],[89.5,-60.75,1],[-145.98,31.02,1],[-54.39,26.43,1],[28.92,32.51,1],[125.34,30.94,1],[168.71,-7.06,1],[-112.49,-10.38,1],[-21.96,-9.6,1],[73.11,-8.31,1],[95.68,.04,1],[-170.71,2.32,1],[-84.32,-.04,1],[9.29,-2.32,1],[9.19,-34.33,1],[98.21,-37.31,1],[-179.2,-40.48,1],[-77.81,-31.6,1],[-177.08,-21.74,1],[-93.77,-18.83,1],[-2.72,-19.8,1],[90.51,-20.91,1],[-106.89,8.31,1],[-11.29,7.06,1],[67.51,10.38,1],[158.04,9.6,1],[-118.88,-65.68,1],[-38.27,-70.75,1],[48.75,-72.32,1],[139.64,-68.7,1],[-54.66,-30.94,1],[34.02,-31.02,1],[125.61,-26.43,1],[-151.08,-32.51,1],[-170.81,34.33,1],[-81.79,37.31,1],[.8,40.48,1],[102.19,31.6,1],[-28.78,42.67,1],[73.22,40.18,1],[162.16,44.1,1],[-110.63,43.27,1],[-89.49,20.91,1],[2.92,21.74,1],[86.23,18.83,1],[177.28,19.8,1],[133.77,8.37,1],[-132.09,9.73,1],[-38.49,8.73,1],[45.49,9.73,1],[-25.6,24.04,1],[55.12,30.23,1],[149.3,28.05,1],[-118.71,26.06,1],[.81,60.75,1],[95.43,54.07,1],[-174.61,58.05,1],[-90.5,60.75,1],[-124.88,-30.23,1],[-30.7,-28.05,1],[61.29,-26.06,1],[154.4,-24.04,1],[-132.92,-85.6,1],[47.08,85.6,1]],[[-129.19,8.11,1],[169.58,-38.73,1],[50.81,8.12,1],[-77.27,-50.11,1],[10.42,38.73,1],[77.3,50.12,1],[-10.41,-38.72,1],[102.71,-50.11,1],[-169.57,38.72,1],[-102.71,50.11,1],[129.19,-8.11,1],[-50.8,-8.11,1],[-4.59,-56.01,1],[-93.1,33.85,1],[175.39,-56.03,1],[146.11,-2.57,1],[-86.89,-33.86,1],[-146.1,2.56,1],[86.91,33.86,1],[-33.89,-2.57,1],[93.1,-33.85,1],[33.9,2.58,1],[4.6,56.03,1],[-175.38,56.01,1],[106.57,26.1,1],[27.07,-14.82,1],[-73.44,26.09,1],[-30.2,59.41,1],[152.94,14.83,1],[30.2,-59.4,1],[-152.93,-14.84,1],[149.82,59.41,1],[-27.06,14.83,1],[-149.8,-59.42,1],[-106.55,-26.1,1],[73.44,-26.09,1],[-171.42,77.45,1],[91.9,-12.4,1],[8.54,77.46,1],[-12.4,-1.85,1],[88.11,12.41,1],[12.41,1.86,1],[-88.1,-12.41,1],[167.6,-1.86,1],[-91.89,12.4,1],[-167.59,1.84,1],[171.43,-77.46,1],[-8.52,-77.45,1],[-122.73,-10.44,1],[-167.65,-32.13,1],[57.27,-10.43,1],[-108.8,-55.83,1],[-12.35,32.13,1],[108.83,55.83,1],[12.36,-32.12,1],[71.19,-55.82,1],[167.66,32.12,1],[-71.19,55.82,1],[122.74,10.44,1],[-57.27,10.44,1],[-135.84,-23.05,1],[-148.58,-41.32,1],[44.16,-23.04,1],[-120.66,-39.88,1],[-31.41,41.31,1],[120.68,39.87,1],[31.42,-41.3,1],[59.33,-39.86,1],[148.6,41.31,1],[-59.33,39.87,1],[135.85,23.05,1],[-44.16,23.05,1],[-161.55,20.62,1],[130.04,-62.6,1],[18.45,20.64,1],[-68.35,-17.23,1],[49.96,62.61,1],[68.36,17.23,1],[-49.93,-62.6,1],[111.65,-17.22,1],[-130.05,62.59,1],[-111.64,17.22,1],[161.56,-20.63,1],[-18.44,-20.62,1],[-105.23,-3.38,1],[-176.5,-15.21,1],[74.77,-3.37,1],[-102.64,-74.41,1],[-3.5,15.21,1],[102.69,74.41,1],[3.51,-15.2,1],[77.33,-74.4,1],[176.51,15.2,1],[-77.36,74.4,1],[105.24,3.38,1],[-74.76,3.37,1],[-142.39,25.42,1],[142.08,-45.69,1],[37.61,25.43,1],[-59.02,-33.44,1],[37.92,45.69,1],[59.04,33.45,1],[-37.91,-45.68,1],[120.97,-33.44,1],[-142.07,45.68,1],[-120.96,33.44,1],[142.4,-25.43,1],[-37.6,-25.42,1]],[[-30.6,6.94,1],[166.56,58.69,1],[149.4,6.96,1],[81.95,-30.36,1],[13.48,-58.69,1],[-81.93,30.36,1],[-13.46,58.68,1],[-98.06,-30.37,1],[-166.54,-58.68,1],[98.07,30.37,1],[30.62,-6.95,1],[-149.38,-6.95,1],[106.69,-22.68,1],[-23.57,-15.36,1],[-73.31,-22.69,1],[-145.5,62.1,1],[-156.41,15.36,1],[145.53,-62.1,1],[156.43,-15.35,1],[34.47,62.11,1],[23.58,15.36,1],[-34.46,-62.11,1],[-106.67,22.68,1],[73.33,22.69,1],[166.82,1.39,1],[6.09,-76.74,1],[-13.19,1.38,1],[-88.57,13.18,1],[173.99,76.74,1],[88.59,-13.18,1],[-173.97,-76.73,1],[91.43,13.2,1],[-6.07,76.73,1],[-91.42,-13.2,1],[-166.8,-1.38,1],[13.2,-1.39,1],[-74.67,48.11,1],[130.86,10.16,1],[105.32,48.13,1],[13.34,-40.08,1],[49.16,-10.15,1],[-13.32,40.07,1],[-49.14,10.15,1],[-166.67,-40.08,1],[-130.84,-10.16,1],[166.69,40.08,1],[74.7,-48.11,1],[-105.31,-48.13,1],[-126.99,26.55,1],[147.96,-32.57,1],[53,26.56,1],[-50.28,-45.59,1],[32.05,32.58,1],[50.3,45.59,1],[-32.03,-32.58,1],[129.71,-45.58,1],[-147.94,32.57,1],[-129.69,45.58,1],[127.02,-26.55,1],[-52.98,-26.56,1],[-171.93,30.37,1],[103.47,-58.68,1],[8.07,30.36,1],[-59.38,-6.96,1],[76.54,58.69,1],[59.4,6.95,1],[-76.53,-58.69,1],[120.62,-6.94,1],[-103.44,58.68,1],[-120.6,6.95,1],[171.94,-30.36,1],[-8.05,-30.37,1],[40.86,10.16,1],[15.32,48.12,1],[-139.14,10.16,1],[76.68,40.09,1],[164.69,-48.12,1],[-76.67,-40.09,1],[-164.67,48.12,1],[-103.31,40.07,1],[-15.3,-48.13,1],[103.34,-40.07,1],[-40.84,-10.16,1],[139.16,-10.15,1],[103.2,-1.38,1],[-1.41,-13.19,1],[-76.8,-1.39,1],[-96.02,76.73,1],[-178.57,13.19,1],[96.07,-76.73,1],[178.58,-13.19,1],[83.94,76.74,1],[1.43,13.19,1],[-83.95,-76.74,1],[-103.18,1.38,1],[76.81,1.39,1],[37.02,-26.56,1],[-39.7,45.58,1],[-142.99,-26.56,1],[122.05,32.58,1],[-140.29,-45.59,1],[-122.04,-32.58,1],[140.31,45.59,1],[-57.95,32.57,1],[39.72,-45.58,1],[57.97,-32.57,1],[-37,26.55,1],[143,26.56,1],[163.33,22.69,1],[55.55,-62.1,1],[-16.67,22.68,1],[-66.41,15.35,1],[124.49,62.11,1],[66.43,-15.35,1],[-124.48,-62.11,1],[113.58,15.36,1],[-55.52,62.1,1],[-113.57,-15.36,1],[-163.31,-22.68,1],[16.69,-22.69,1]],[[-10.57,-17.35,1],[-120.42,69.76,1],[169.43,-17.35,1],[107.63,-10.08,1],[-59.57,-69.78,1],[-107.63,10.08,1],[59.57,69.78,1],[-72.37,-10.09,1],[120.42,-69.76,1],[72.37,10.09,1],[10.57,17.35,1],[-169.43,17.35,1],[-30.77,68.25,1],[101.53,18.57,1],[149.25,68.26,1],[18.92,-10.92,1],[78.47,-18.56,1],[-18.92,10.92,1],[-78.47,18.56,1],[-161.09,-10.92,1],[-101.53,-18.56,1],[161.09,10.92,1],[30.78,-68.26,1],[-149.26,-68.26,1],[56.46,41.26,1],[46.46,24.54,1],[-123.53,41.26,1],[32.19,38.8,1],[133.53,-24.53,1],[-32.19,-38.8,1],[-133.53,24.53,1],[-147.8,38.8,1],[-46.46,-24.54,1],[147.8,-38.8,1],[-56.46,-41.27,1],[123.53,-41.26,1],[84.74,27.31,1],[27.41,4.68,1],[-95.26,27.3,1],[10.06,62.23,1],[152.59,-4.67,1],[-10.06,-62.23,1],[-152.59,4.67,1],[-169.92,62.23,1],[-27.4,-4.68,1],[169.92,-62.22,1],[-84.74,-27.31,1],[95.26,-27.3,1],[136.27,-.73,1],[-1.05,-46.27,1],[-43.73,-.74,1],[-91.01,43.72,1],[-178.94,46.27,1],[91.01,-43.72,1],[178.94,-46.27,1],[88.99,43.73,1],[1.05,46.27,1],[-88.99,-43.73,1],[-136.27,.73,1],[43.73,.73,1],[55.23,10.82,1],[13.09,34.07,1],[-124.77,10.81,1],[71.48,53.8,1],[166.91,-34.06,1],[-71.48,-53.8,1],[-166.9,34.06,1],[-108.52,53.79,1],[-13.09,-34.06,1],[108.52,-53.79,1],[-55.23,-10.82,1],[124.77,-10.81,1],[-105.49,-68.13,1],[-111.15,-5.71,1],[74.52,-68.12,1],[-173.89,-21.04,1],[-68.85,5.7,1],[173.89,21.04,1],[68.85,-5.7,1],[6.12,-21.04,1],[111.15,5.71,1],[-6.12,21.04,1],[105.49,68.13,1],[-74.52,68.12,1],[35.28,-15.18,1],[-25.17,51.98,1],[-144.72,-15.19,1],[108.39,33.88,1],[-154.84,-51.99,1],[-108.39,-33.88,1],[154.84,51.99,1],[-71.61,33.87,1],[25.17,-51.98,1],[71.61,-33.87,1],[-35.28,15.18,1],[144.72,15.19,1],[-125.28,-28.56,1],[-146.32,-30.49,1],[54.72,-28.55,1],[-133.29,-45.82,1],[-33.69,30.48,1],[133.3,45.82,1],[33.68,-30.48,1],[46.71,-45.81,1],[146.32,30.49,1],[-46.71,45.81,1],[125.28,28.56,1],[-54.72,28.54,1],[-144.4,54.71,1],[112.38,-28.01,1],[35.58,54.72,1],[-29.92,-19.65,1],[67.62,28.02,1],[29.92,19.65,1],[-67.62,-28.02,1],[150.08,-19.64,1],[-112.38,28.01,1],[-150.08,19.64,1],[144.4,-54.71,1],[-35.58,-54.72,1],[68.53,-52.85,1],[-54.82,12.76,1],[-111.46,-52.87,1],[164.51,34.19,1],[-125.18,-12.77,1],[-164.51,-34.19,1],[125.18,12.77,1],[-15.5,34.19,1],[54.82,-12.76,1],[15.49,-34.19,1],[-68.53,52.85,1],[111.47,52.86,1],[91.48,-7.37,1],[-7.38,-1.47,1],[-88.52,-7.38,1],[-168.69,82.47,1],[-172.62,1.47,1],[168.69,-82.47,1],[172.62,-1.46,1],[11.22,82.48,1],[7.38,1.47,1],[-11.21,-82.48,1],[-91.48,7.37,1],[88.52,7.38,1]],[[-110.97,-81.34,1],[-98.09,-3.09,1],[69.03,-81.34,1],[-176.88,-8.08,1],[-81.91,3.09,1],[176.88,8.08,1],[81.91,-3.09,1],[3.12,-8.08,1],[98.09,3.09,1],[-3.12,8.08,1],[110.97,81.34,1],[-69.03,81.34,1],[145.76,30.52,1],[46.33,-45.41,1],[-34.24,30.52,1],[-54.51,28.99,1],[133.67,45.41,1],[54.51,-28.99,1],[-133.67,-45.41,1],[125.49,28.99,1],[-46.33,45.41,1],[-125.49,-28.99,1],[-145.76,-30.52,1],[34.24,-30.52,1],[159.58,41.4,1],[68.4,-44.67,1],[-20.42,41.4,1],[-46.75,15.18,1],[111.6,44.67,1],[46.75,-15.18,1],[-111.6,-44.67,1],[133.25,15.18,1],[-68.4,44.67,1],[-133.25,-15.18,1],[-159.58,-41.4,1],[20.42,-41.4,1],[85.43,-37.93,1],[-38.02,3.6,1],[-94.57,-37.93,1],[174.17,51.83,1],[-141.98,-3.6,1],[-174.17,-51.83,1],[141.98,3.6,1],[-5.83,51.83,1],[38.02,-3.6,1],[5.83,-51.83,1],[-85.43,37.93,1],[94.57,37.93,1],[21.18,27.17,1],[54.86,56.05,1],[-158.82,27.17,1],[61.17,18.75,1],[125.14,-56.05,1],[-61.17,-18.75,1],[-125.14,56.05,1],[-118.83,18.75,1],[-54.86,-56.05,1],[118.83,-18.75,1],[-21.18,-27.17,1],[158.82,-27.17,1],[104.66,-9.56,1],[-9.88,-14.45,1],[-75.34,-9.56,1],[-123.65,72.56,1],[-170.12,14.45,1],[123.65,-72.56,1],[170.12,-14.45,1],[56.35,72.56,1],[9.88,14.45,1],[-56.35,-72.56,1],[-104.66,9.56,1],[75.34,9.56,1],[25.94,-16.83,1],[-34.66,59.4,1],[-154.06,-16.83,1],[108.59,24.75,1],[-145.34,-59.41,1],[-108.59,-24.75,1],[145.34,59.41,1],[-71.41,24.75,1],[34.66,-59.41,1],[71.41,-24.75,1],[-25.94,16.83,1],[154.06,16.83,1],[-100.89,26.49,1],[153.1,-9.74,1],[79.11,26.49,1],[-20.77,-61.51,1],[26.9,9.74,1],[20.77,61.51,1],[-26.9,-9.74,1],[159.23,-61.51,1],[-153.1,9.74,1],[-159.23,61.51,1],[100.89,-26.49,1],[-79.11,-26.49,1],[44.31,12.28,1],[17.3,44.36,1],[-135.69,12.28,1],[73.08,43.05,1],[162.7,-44.36,1],[-73.08,-43.05,1],[-162.7,44.36,1],[-106.92,43.05,1],[-17.3,-44.36,1],[106.92,-43.05,1],[-44.31,-12.28,1],[135.69,-12.28,1],[-169.08,-24.53,1],[-112.54,-63.29,1],[10.92,-24.53,1],[-114.93,-9.92,1],[-67.46,63.28,1],[114.93,9.92,1],[67.46,-63.29,1],[65.07,-9.92,1],[112.54,63.29,1],[-65.07,9.92,1],[169.08,24.53,1],[-10.92,24.53,1],[93.2,-57.39,1],[-57.43,-1.73,1],[-86.8,-57.39,1],[-177.95,32.55,1],[-122.57,1.73,1],[177.95,-32.55,1],[122.57,-1.73,1],[2.05,32.55,1],[57.43,1.73,1],[-2.05,-32.55,1],[-93.2,57.39,1],[86.8,57.39,1],[-17.59,3.04,1],[170.04,72.16,1],[162.41,3.04,1],[86.81,-17.56,1],[9.96,-72.16,1],[-86.81,17.56,1],[-9.96,72.16,1],[-93.19,-17.56,1],[-170.04,-72.16,1],[93.19,17.56,1],[17.59,-3.04,1],[-162.41,-3.04,1],[39.38,44.26,1],[56.93,33.61,1],[-140.62,44.26,1],[38.42,27.03,1],[123.07,-33.61,1],[-38.42,-27.03,1],[-123.07,33.61,1],[-141.58,27.03,1],[-56.93,-33.61,1],[141.58,-27.03,1],[-39.38,-44.26,1],[140.62,-44.26,1]],[[165.52,26.52,1],[63.39,-60.04,1],[-14.48,26.52,1],[-62.74,12.93,1],[116.61,60.04,1],[62.74,-12.93,1],[-116.61,-60.04,1],[117.26,12.93,1],[-63.39,60.04,1],[-117.26,-12.93,1],[-165.52,-26.52,1],[14.48,-26.52,1],[-150.22,-21.62,1],[-141.41,-53.79,1],[29.78,-21.62,1],[-114.55,-27.5,1],[-38.59,53.79,1],[114.55,27.5,1],[38.59,-53.79,1],[65.45,-27.5,1],[141.41,53.79,1],[-65.45,27.5,1],[150.22,21.62,1],[-29.78,21.62,1],[-163.47,81.91,1],[92.31,-7.75,1],[16.53,81.91,1],[-7.76,-2.29,1],[87.69,7.75,1],[7.76,2.29,1],[-87.69,-7.75,1],[172.24,-2.29,1],[-92.31,7.75,1],[-172.24,2.29,1],[163.47,-81.91,1],[-16.53,-81.91,1],[-79.91,-73.49,1],[-106.27,2.85,1],[100.09,-73.49,1],[177.03,-16.24,1],[-73.73,-2.85,1],[-177.03,16.24,1],[73.73,2.85,1],[-2.97,-16.24,1],[106.27,-2.85,1],[2.97,16.24,1],[79.91,73.49,1],[-100.09,73.49,1],[-43.19,73.63,1],[101.37,11.86,1],[136.81,73.63,1],[12.09,-11.12,1],[78.63,-11.86,1],[-12.09,11.12,1],[-78.63,11.86,1],[-167.91,-11.12,1],[-101.37,-11.86,1],[167.91,11.12,1],[43.19,-73.63,1],[-136.81,-73.63,1],[109.86,-34.83,1],[-36.5,-16.19,1],[-70.14,-34.83,1],[-153.97,50.53,1],[-143.5,16.19,1],[153.97,-50.53,1],[143.5,-16.19,1],[26.03,50.53,1],[36.5,16.19,1],[-26.03,-50.53,1],[-109.86,34.83,1],[70.14,34.83,1],[-23.31,-6.54,1],[-163.84,65.83,1],[156.69,-6.54,1],[97.12,-23.15,1],[-16.16,-65.83,1],[-97.12,23.15,1],[16.16,65.83,1],[-82.88,-23.15,1],[163.84,-65.83,1],[82.88,23.15,1],[23.31,6.54,1],[-156.69,6.54,1],[-.87,-31.92,1],[-91.4,58.07,1],[179.13,-31.92,1],[121.93,-.74,1],[-88.6,-58.07,1],[-121.93,.74,1],[88.6,58.07,1],[-58.07,-.74,1],[91.4,-58.07,1],[58.07,.74,1],[.87,31.92,1],[-179.13,31.92,1],[163.12,43.35,1],[72.9,-44.1,1],[-16.88,43.35,1],[-45.39,12.19,1],[107.1,44.1,1],[45.39,-12.19,1],[-107.1,-44.1,1],[134.61,12.19,1],[-72.9,44.1,1],[-134.61,-12.19,1],[-163.12,-43.35,1],[16.88,-43.35,1],[-114.23,50.37,1],[127.06,-15.17,1],[65.77,50.37,1],[-18.77,-35.57,1],[52.94,15.17,1],[18.77,35.57,1],[-52.94,-15.17,1],[161.23,-35.57,1],[-127.06,15.17,1],[-161.23,35.57,1],[114.23,-50.37,1],[-65.77,-50.37,1],[54.17,30.16,1],[35.63,30.41,1],[-125.83,30.16,1],[45.21,44.51,1],[144.37,-30.41,1],[-45.21,-44.51,1],[-144.37,30.41,1],[-134.79,44.51,1],[-35.63,-30.41,1],[134.79,-44.51,1],[-54.17,-30.16,1],[125.83,-30.16,1],[126.2,41.73,1],[47.86,-26.15,1],[-53.8,41.73,1],[-33.51,37.03,1],[132.14,26.15,1],[33.51,-37.03,1],[-132.14,-26.15,1],[146.49,37.03,1],[-47.86,26.15,1],[-146.49,-37.03,1],[-126.2,-41.73,1],[53.8,-41.73,1],[-161.75,20.38,1],[130.12,-62.91,1],[18.25,20.38,1],[-68.63,-17.07,1],[49.88,62.91,1],[68.63,17.07,1],[-49.88,-62.91,1],[111.37,-17.07,1],[-130.12,62.91,1],[-111.37,17.07,1],[161.75,-20.38,1],[-18.25,-20.38,1],[2.71,48.49,1],[87.6,41.45,1],[-177.29,48.49,1],[41.48,1.8,1],[92.4,-41.45,1],[-41.48,-1.8,1],[-92.4,41.45,1],[-138.52,1.8,1],[-87.6,-41.45,1],[138.52,-1.8,1],[-2.71,-48.49,1],[177.29,-48.49,1],[-98.15,-27.54,1],[-152.22,-7.22,1],[81.85,-27.54,1],[-164.79,-61.37,1],[-27.78,7.22,1],[164.79,61.37,1],[27.78,-7.22,1],[15.21,-61.37,1],[152.22,7.22,1],[-15.21,61.37,1],[98.15,27.54,1],[-81.85,27.54,1]],[[-40.48,43.36,1],[124.51,33.58,1],[139.52,43.36,1],[38.85,-28.17,1],[55.49,-33.58,1],[-38.85,28.17,1],[-55.49,33.58,1],[-141.15,-28.17,1],[-124.51,-33.58,1],[141.15,28.17,1],[40.48,-43.36,1],[-139.52,-43.36,1],[56.01,17.18,1],[20.46,32.29,1],[-123.99,17.18,1],[61.05,52.38,1],[159.54,-32.29,1],[-61.05,-52.38,1],[-159.54,32.29,1],[-118.95,52.38,1],[-20.46,-32.29,1],[118.95,-52.38,1],[-56.01,-17.18,1],[123.99,-17.18,1],[-179.51,-8.95,1],[-93.08,-81.04,1],[.49,-8.95,1],[-98.95,-.48,1],[-86.92,81.04,1],[98.95,.48,1],[86.92,-81.04,1],[81.05,-.48,1],[93.08,81.04,1],[-81.05,.48,1],[179.51,8.95,1],[-.49,8.95,1],[12.04,-13.56,1],[-49.15,71.95,1],[-167.96,-13.56,1],[103.85,11.7,1],[-130.85,-71.95,1],[-103.85,-11.7,1],[130.85,71.95,1],[-76.15,11.7,1],[49.15,-71.95,1],[76.15,-11.7,1],[-12.04,13.56,1],[167.96,13.56,1],[-13.62,-58.2,1],[-98.3,30.8,1],[166.38,-58.2,1],[148.93,-7.13,1],[-81.7,-30.8,1],[-148.93,7.13,1],[81.7,30.8,1],[-31.07,-7.13,1],[98.3,-30.8,1],[31.07,7.13,1],[13.62,58.2,1],[-166.38,58.2,1],[65.26,-20.55,1],[-22.43,23.07,1],[-114.74,-20.55,1],[131.85,58.26,1],[-157.57,-23.07,1],[-131.85,-58.26,1],[157.57,23.07,1],[-48.15,58.26,1],[22.43,-23.07,1],[48.15,-58.26,1],[-65.26,20.55,1],[114.74,20.55,1],[-135.39,26.5,1],[144.63,-39.58,1],[44.61,26.5,1],[-55,-38.94,1],[35.37,39.58,1],[55,38.94,1],[-35.37,-39.58,1],[125,-38.94,1],[-144.63,39.58,1],[-125,38.94,1],[135.39,-26.5,1],[-44.61,-26.5,1],[114.95,-4.75,1],[-5.23,-24.86,1],[-65.05,-4.75,1],[-101.14,64.63,1],[-174.77,24.86,1],[101.14,-64.63,1],[174.77,-24.86,1],[78.86,64.63,1],[5.23,24.86,1],[-78.86,-64.63,1],[-114.95,4.75,1],[65.05,4.75,1],[35.85,52.64,1],[65.91,29.46,1],[-144.15,52.64,1],[31.75,20.82,1],[114.09,-29.46,1],[-31.75,-20.82,1],[-114.09,29.46,1],[-148.25,20.82,1],[-65.91,-29.46,1],[148.25,-20.82,1],[-35.85,-52.64,1],[144.15,-52.64,1],[86.45,11.52,1],[11.54,3.48,1],[-93.55,11.52,1],[16.9,77.95,1],[168.46,-3.48,1],[-16.9,-77.95,1],[-168.46,3.48,1],[-163.1,77.95,1],[-11.54,-3.48,1],[163.1,-77.95,1],[-86.45,-11.52,1],[93.55,-11.52,1],[135.24,4.02,1],[5.69,-45.1,1],[-44.76,4.02,1],[-84.35,44.62,1],[174.31,45.1,1],[84.35,-44.62,1],[-174.31,-45.1,1],[95.65,44.62,1],[-5.69,45.1,1],[-95.65,-44.62,1],[-135.24,-4.02,1],[44.76,-4.02,1],[-129.84,-18.16,1],[-156.86,-37.5,1],[50.16,-18.16,1],[-117.12,-46.85,1],[-23.14,37.5,1],[117.12,46.85,1],[23.14,-37.5,1],[62.88,-46.85,1],[156.86,37.5,1],[-62.88,46.85,1],[129.84,18.16,1],[-50.16,18.16,1],[-74.1,32.87,1],[146.1,13.3,1],[105.9,32.87,1],[22.97,-53.88,1],[33.9,-13.3,1],[-22.97,53.88,1],[-33.9,13.3,1],[-157.03,-53.88,1],[-146.1,-13.3,1],[157.03,53.88,1],[74.1,-32.87,1],[-105.9,-32.87,1],[-119.92,-5.64,1],[-173.5,-29.76,1],[60.08,-5.64,1],[-101.2,-59.6,1],[-6.5,29.76,1],[101.2,59.6,1],[6.5,-29.76,1],[78.8,-59.6,1],[173.5,29.76,1],[-78.8,59.6,1],[119.92,5.64,1],[-60.08,5.64,1],[73.14,16.13,1],[16.82,16.18,1],[-106.86,16.13,1],[45.09,66.83,1],[163.18,-16.18,1],[-45.09,-66.83,1],[-163.18,16.18,1],[-134.91,66.83,1],[-16.82,-16.18,1],[134.91,-66.83,1],[-73.14,-16.13,1],[106.86,-16.13,1],[-11.7,-43.38,1],[-102.11,45.38,1],[168.3,-43.38,1],[133.98,-8.47,1],[-77.89,-45.38,1],[-133.98,8.47,1],[77.89,45.38,1],[-46.02,-8.47,1],[102.11,-45.38,1],[46.02,8.47,1],[11.7,43.38,1],[-168.3,43.38,1],[-24.11,3.73,1],[170.94,65.63,1],[155.89,3.73,1],[85.92,-24.05,1],[9.06,-65.63,1],[-85.92,24.05,1],[-9.06,65.63,1],[-94.08,-24.05,1],[-170.94,-65.63,1],[94.08,24.05,1],[24.11,-3.73,1],[-155.89,-3.73,1]],[[104.6,-3.68,1],[-3.81,-14.57,1],[-75.4,-3.68,1],[-104.32,74.95,1],[-176.19,14.57,1],[104.32,-74.95,1],[176.19,-14.57,1],[75.68,74.95,1],[3.81,14.57,1],[-75.68,-74.95,1],[-104.6,3.68,1],[75.4,3.68,1],[153.77,-30.33,1],[-52.93,-50.74,1],[-26.23,-30.33,1],[-123.11,22.43,1],[-127.07,50.74,1],[123.11,-22.43,1],[127.07,-50.74,1],[56.89,22.43,1],[52.93,50.74,1],[-56.89,-22.43,1],[-153.77,30.33,1],[26.23,30.33,1],[35.99,-39.77,1],[-54.77,38.45,1],[-144.01,-39.77,1],[135.81,26.85,1],[-125.23,-38.45,1],[-135.81,-26.85,1],[125.23,38.45,1],[-44.19,26.85,1],[54.77,-38.45,1],[44.19,-26.85,1],[-35.99,39.77,1],[144.01,39.77,1],[71.82,-25.43,1],[-26.58,16.37,1],[-108.18,-25.43,1],[146.72,59.1,1],[-153.42,-16.37,1],[-146.72,-59.1,1],[153.42,16.37,1],[-33.28,59.1,1],[26.58,-16.37,1],[33.28,-59.1,1],[-71.82,25.43,1],[108.18,25.43,1],[-136.55,26.52,1],[144.03,-40.51,1],[43.45,26.52,1],[-55.5,-37.97,1],[35.97,40.51,1],[55.5,37.97,1],[-35.97,-40.51,1],[124.5,-37.97,1],[-144.03,40.51,1],[-124.5,37.97,1],[136.55,-26.52,1],[-43.45,-26.52,1],[-6.52,-1.08,1],[-170.58,83.4,1],[173.48,-1.08,1],[91.09,-6.52,1],[-9.42,-83.4,1],[-91.09,6.52,1],[9.42,83.4,1],[-88.91,-6.52,1],[170.58,-83.4,1],[88.91,6.52,1],[6.52,1.08,1],[-173.48,1.08,1],[-71.13,40.38,1],[138.05,14.26,1],[108.87,40.38,1],[20.82,-46.12,1],[41.95,-14.26,1],[-20.82,46.12,1],[-41.95,14.26,1],[-159.18,-46.12,1],[-138.05,-14.26,1],[159.18,46.12,1],[71.13,-40.38,1],[-108.87,-40.38,1],[-153.97,-27.97,1],[-129.57,-52.52,1],[26.03,-27.97,1],[-120.59,-22.81,1],[-50.43,52.52,1],[120.59,22.81,1],[50.43,-52.52,1],[59.41,-22.81,1],[129.57,52.52,1],[-59.41,22.81,1],[153.97,27.97,1],[-26.03,27.97,1],[-80.23,13.48,1],[166.33,9.49,1],[99.77,13.48,1],[35.29,-73.41,1],[13.67,-9.49,1],[-35.29,73.41,1],[-13.67,9.49,1],[-144.71,-73.41,1],[-166.33,-9.49,1],[144.71,73.41,1],[80.23,-13.48,1],[-99.77,-13.48,1],[55.43,-9,1],[-10.89,34.09,1],[-124.57,-9,1],[105.6,54.41,1],[-169.11,-34.09,1],[-105.6,-54.41,1],[169.11,34.09,1],[-74.4,54.41,1],[10.89,-34.09,1],[74.4,-54.41,1],[-55.43,9,1],[124.57,9,1],[68.32,-7.14,1],[-7.68,21.51,1],[-111.68,-7.14,1],[108.74,67.22,1],[-172.32,-21.51,1],[-108.74,-67.22,1],[172.32,21.51,1],[-71.26,67.22,1],[7.68,-21.51,1],[71.26,-67.22,1],[-68.32,7.14,1],[111.68,7.14,1],[-174.97,36.12,1],[96.85,-53.58,1],[5.03,36.12,1],[-53.77,-4.06,1],[83.15,53.58,1],[53.77,4.06,1],[-83.15,-53.58,1],[126.23,-4.06,1],[-96.85,53.58,1],[-126.23,4.06,1],[174.97,-36.12,1],[-5.03,-36.12,1],[-149.91,16.26,1],[149.81,-56.16,1],[30.09,16.26,1],[-71.37,-28.77,1],[30.19,56.16,1],[71.37,28.77,1],[-30.19,-56.16,1],[108.63,-28.77,1],[-149.81,56.16,1],[-108.63,28.77,1],[149.91,-16.26,1],[-30.09,-16.26,1],[2.52,-51.45,1],[-87.99,38.5,1],[-177.48,-51.45,1],[141.48,1.57,1],[-92.01,-38.5,1],[-141.48,-1.57,1],[92.01,38.5,1],[-38.52,1.57,1],[87.99,-38.5,1],[38.52,-1.57,1],[-2.52,51.45,1],[177.48,51.45,1],[161.12,-9.98,1],[-28.54,-68.73,1],[-18.88,-9.98,1],[-100.54,18.59,1],[-151.46,68.73,1],[100.54,-18.59,1],[151.46,-68.73,1],[79.46,18.59,1],[28.54,68.73,1],[-79.46,-18.59,1],[-161.12,9.98,1],[18.88,9.98,1],[12.84,24.97,1],[64.49,62.11,1],[-167.16,24.97,1],[64.47,11.62,1],[115.51,-62.11,1],[-64.47,-11.62,1],[-115.51,62.11,1],[-115.53,11.62,1],[-64.49,-62.11,1],[115.53,-11.62,1],[-12.84,-24.97,1],[167.16,-24.97,1],[74.13,41.65,1],[42.76,11.79,1],[-105.87,41.65,1],[17.09,45.95,1],[137.24,-11.79,1],[-17.09,-45.95,1],[-137.24,11.79,1],[-162.91,45.95,1],[-42.76,-11.79,1],[162.91,-45.95,1],[-74.13,-41.65,1],[105.87,-41.65,1],[154.04,1.27,1],[2.9,-64.01,1],[-25.96,1.27,1],[-88.59,25.96,1],[177.1,64.01,1],[88.59,-25.96,1],[-177.1,-64.01,1],[91.41,25.96,1],[-2.9,64.01,1],[-91.41,-25.96,1],[-154.04,-1.27,1],[25.96,-1.27,1]],[[24.8,-10.46,1],[-23.76,63.21,1],[-155.2,-10.46,1],[101.5,24.36,1],[-156.24,-63.21,1],[-101.5,-24.36,1],[156.24,63.21,1],[-78.5,24.36,1],[23.76,-63.21,1],[78.5,-24.36,1],[-24.8,10.46,1],[155.2,10.46,1],[-134.64,65.44,1],[108.01,-16.98,1],[45.36,65.44,1],[-17.8,-17.2,1],[71.99,16.98,1],[17.8,17.2,1],[-71.99,-16.98,1],[162.2,-17.2,1],[-108.01,16.98,1],[-162.2,17.2,1],[134.64,-65.44,1],[-45.36,-65.44,1],[177.6,54.85,1],[88.31,-35.12,1],[-2.4,54.85,1],[-35.13,1.38,1],[91.69,35.12,1],[35.13,-1.38,1],[-91.69,-35.12,1],[144.87,1.38,1],[-88.31,35.12,1],[-144.87,-1.38,1],[-177.6,-54.85,1],[2.4,-54.85,1],[157.93,82.01,1],[86.98,-7.4,1],[-22.07,82.01,1],[-7.41,2.99,1],[93.02,7.4,1],[7.41,-2.99,1],[-93.02,-7.4,1],[172.59,2.99,1],[-86.98,7.4,1],[-172.59,-2.99,1],[-157.93,-82.01,1],[22.07,-82.01,1],[42.48,-13.21,1],[-19.17,45.89,1],[-137.52,-13.21,1],[107.66,41.11,1],[-160.83,-45.89,1],[-107.66,-41.11,1],[160.83,45.89,1],[-72.34,41.11,1],[19.17,-45.89,1],[72.34,-41.11,1],[-42.48,13.21,1],[137.52,13.21,1],[28.48,10.9,1],[21.99,59.68,1],[-151.52,10.9,1],[77.65,27.92,1],[158.01,-59.68,1],[-77.65,-27.92,1],[-158.01,59.68,1],[-102.35,27.92,1],[-21.99,-59.68,1],[102.35,-27.92,1],[-28.48,-10.9,1],[151.52,-10.9,1],[-33.79,21.61,1],[144.53,50.59,1],[146.21,21.61,1],[64.51,-31.14,1],[35.47,-50.59,1],[-64.51,31.14,1],[-35.47,50.59,1],[-115.49,-31.14,1],[-144.53,-50.59,1],[115.49,31.14,1],[33.79,-21.61,1],[-146.21,-21.61,1],[-175.53,-31.74,1],[-97.19,-57.98,1],[4.47,-31.74,1],[-121.82,-3.8,1],[-82.81,57.98,1],[121.82,3.8,1],[82.81,-57.98,1],[58.18,-3.8,1],[97.19,57.98,1],[-58.18,3.8,1],[175.53,31.74,1],[-4.47,31.74,1],[89.4,19.43,1],[19.43,.56,1],[-90.6,19.43,1],[1.69,70.56,1],[160.57,-.56,1],[-1.69,-70.56,1],[-160.57,.56,1],[-178.31,70.56,1],[-19.43,-.56,1],[178.31,-70.56,1],[-89.4,-19.43,1],[90.6,-19.43,1],[-27.28,-27.88,1],[-130.91,51.78,1],[152.72,-27.88,1],[120.76,-23.9,1],[-49.09,-51.78,1],[-120.76,23.9,1],[49.09,51.78,1],[-59.24,-23.9,1],[130.91,-51.78,1],[59.24,23.9,1],[27.28,27.88,1],[-152.72,27.88,1],[139.9,-15.44,1],[-23.21,-47.5,1],[-40.1,-15.44,1],[-109.85,38.38,1],[-156.79,47.5,1],[109.85,-38.38,1],[156.79,-47.5,1],[70.15,38.38,1],[23.21,47.5,1],[-70.15,-38.38,1],[-139.9,15.44,1],[40.1,15.44,1],[-2.17,-43.33,1],[-92.29,46.62,1],[177.83,-43.33,1],[133.35,-1.58,1],[-87.71,-46.62,1],[-133.35,1.58,1],[87.71,46.62,1],[-46.65,-1.58,1],[92.29,-46.62,1],[46.65,1.58,1],[2.17,43.33,1],[-177.83,43.33,1],[41.12,27.96,1],[38.91,41.71,1],[-138.88,27.96,1],[54.83,35.51,1],[141.09,-41.71,1],[-54.83,-35.51,1],[-141.09,41.71,1],[-125.17,35.51,1],[-38.91,-41.71,1],[125.17,-35.51,1],[-41.12,-27.96,1],[138.88,-27.96,1],[-126.67,13.75,1],[163.04,-35.46,1],[53.33,13.75,1],[-67.73,-51.18,1],[16.96,35.46,1],[67.73,51.18,1],[-16.96,-35.46,1],[112.27,-51.18,1],[-163.04,35.46,1],[-112.27,51.18,1],[126.67,-13.75,1],[-53.33,-13.75,1],[6.02,-15.42,1],[-69.18,73.47,1],[-173.98,-15.42,1],[105.51,5.8,1],[-110.82,-73.47,1],[-105.51,-5.8,1],[110.82,73.47,1],[-74.49,5.8,1],[69.18,-73.47,1],[74.49,-5.8,1],[-6.02,15.42,1],[173.98,15.42,1],[160.08,33.45,1],[62.71,-51.67,1],[-19.92,33.45,1],[-54.9,16.52,1],[117.29,51.67,1],[54.9,-16.52,1],[-117.29,-51.67,1],[125.1,16.52,1],[-62.71,51.67,1],[-125.1,-16.52,1],[-160.08,-33.45,1],[19.92,-33.45,1],[80.34,6.51,1],[6.61,9.59,1],[-99.66,6.51,1],[55.76,78.37,1],[173.39,-9.59,1],[-55.76,-78.37,1],[-173.39,9.59,1],[-124.24,78.37,1],[-6.61,-9.59,1],[124.24,-78.37,1],[-80.34,-6.51,1],[99.66,-6.51,1],[6.25,24.64,1],[76.64,64.63,1],[-173.75,24.64,1],[65.23,5.68,1],[103.36,-64.63,1],[-65.23,-5.68,1],[-103.36,64.63,1],[-114.77,5.68,1],[-76.64,-64.63,1],[114.77,-5.68,1],[-6.25,-24.64,1],[173.75,-24.64,1],[51.41,-63.45,1],[-68.67,16.19,1],[-128.59,-63.45,1],[162.69,20.45,1],[-111.33,-16.19,1],[-162.69,-20.45,1],[111.33,16.19,1],[-17.31,20.45,1],[68.67,-16.19,1],[17.31,-20.45,1],[-51.41,63.45,1],[128.59,63.45,1],[-50.6,28.85,1],[144.51,33.77,1],[129.4,28.85,1],[49.04,-42.6,1],[35.49,-33.77,1],[-49.04,42.6,1],[-35.49,33.77,1],[-130.96,-42.6,1],[-144.51,-33.77,1],[130.96,42.6,1],[50.6,-28.85,1],[-129.4,-28.85,1]]][t-1]}Object.defineProperty(r,"__esModule",{value:!0}),r.deg2rad=n,r.rad2deg=a,r.getColumn=i,r.sampleCircle=o,r.getCircHarmonics=s,r.getAmbisonicDecMtx=u,r.createNearestLookup=c,r.findNearest=l,r.getTdesign=h;var f=t("numeric"),d=t("spherical-harmonic-transform"),m=t("convex-hull"),p=function(t,e,r,n){for(var a=t.length,i=n,o=e.length,s=new Array(a),u=d.convertSph2Cart(t),c=0;c<a;c++){var l=u[c],h=new Array(i);h.fill(0);for(var m=0;m<o;m++){var p=[],v=[r[m][0],r[m][1],r[m][2]];if(p[0]=f.dotVV(v,l),v=[r[m][3],r[m][4],r[m][5]],p[1]=f.dotVV(v,l),v=[r[m][6],r[m][7],r[m][8]],p[2]=f.dotVV(v,l),function(t){return Math.min.apply(null,t)}(p)>-.001){for(var g=Math.sqrt(f.sum(f.pow(p,2))),M=f.div(p,g),b=0;b<3;b++)h[e[m][b]]=M[b];break}}var y=Math.sqrt(f.sum(f.pow(h,2))),x=f.div(h,y);s[c]=x}return s}
;e.exports.getAmbisonicDecMtx=u,e.exports.getTdesign=h,e.exports.deg2rad=n,e.exports.rad2deg=a,e.exports.createNearestLookup=c,e.exports.findNearest=l},{"convex-hull":30,numeric:72,"spherical-harmonic-transform":90}],25:[function(t,e,r){"use strict";function n(t,e){for(var r=new Array(e+1),n=0;n<t.length;++n)r[n]=t[n];for(var n=0;n<=t.length;++n){for(var a=t.length;a<=e;++a){for(var o=new Array(e),s=0;s<e;++s)o[s]=Math.pow(a+1-n,s);r[a]=o}if(i.apply(void 0,r))return!0}return!1}function a(t){var e=t.length;if(0===e)return[];if(1===e)return[0];for(var r=t[0].length,a=[t[0]],i=[0],o=1;o<e;++o)if(a.push(t[o]),n(a,r)){if(i.push(o),i.length===r+1)return i}else a.pop();return i}e.exports=a;var i=t("robust-orientation")},{"robust-orientation":73}],26:[function(t,e,r){e.exports={default:t("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":34}],27:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},{}],28:[function(t,e,r){"use strict";r.__esModule=!0;var n=t("../core-js/object/define-property"),a=function(t){return t&&t.__esModule?t:{default:t}}(n);r.default=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,a.default)(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}()},{"../core-js/object/define-property":26}],29:[function(t,e,r){"use strict";"use restrict";function n(t){var e=32;return t&=-t,t&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}r.INT_BITS=32,r.INT_MAX=2147483647,r.INT_MIN=-1<<31,r.sign=function(t){return(t>0)-(t<0)},r.abs=function(t){var e=t>>31;return(t^e)-e},r.min=function(t,e){return e^(t^e)&-(t<e)},r.max=function(t,e){return t^(t^e)&-(t<e)},r.isPow2=function(t){return!(t&t-1||!t)},r.log2=function(t){var e,r;return e=(t>65535)<<4,t>>>=e,r=(t>255)<<3,t>>>=r,e|=r,r=(t>15)<<2,t>>>=r,e|=r,r=(t>3)<<1,t>>>=r,(e|=r)|t>>1},r.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},r.popCount=function(t){return t-=t>>>1&1431655765,16843009*((t=(858993459&t)+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},r.countTrailingZeros=n,r.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1},r.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},r.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var a=new Array(256);!function(t){for(var e=0;e<256;++e){var r=e,n=e,a=7;for(r>>>=1;r;r>>>=1)n<<=1,n|=1&r,--a;t[e]=n<<a&255}}(a),r.reverse=function(t){return a[255&t]<<24|a[t>>>8&255]<<16|a[t>>>16&255]<<8|a[t>>>24&255]},r.interleave2=function(t,e){return t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1},r.deinterleave2=function(t,e){return t=t>>>e&1431655765,t=858993459&(t|t>>>1),t=252645135&(t|t>>>2),t=16711935&(t|t>>>4),(t=65535&(t|t>>>16))<<16>>16},r.interleave3=function(t,e,r){return t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t|=e<<1,r&=1023,r=4278190335&(r|r<<16),r=251719695&(r|r<<8),r=3272356035&(r|r<<4),r=1227133513&(r|r<<2),t|r<<2},r.deinterleave3=function(t,e){return t=t>>>e&1227133513,t=3272356035&(t|t>>>2),t=251719695&(t|t>>>4),t=4278190335&(t|t>>>8),(t=1023&(t|t>>>16))<<22>>22},r.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>n(t)+1}},{}],30:[function(t,e,r){"use strict";function n(t){var e=t.length;if(0===e)return[];if(1===e)return[[0]];var r=t[0].length;return 0===r?[]:1===r?a(t):2===r?i(t):o(t,r)}var a=t("./lib/ch1d"),i=t("./lib/ch2d"),o=t("./lib/chnd");e.exports=n},{"./lib/ch1d":31,"./lib/ch2d":32,"./lib/chnd":33}],31:[function(t,e,r){"use strict";function n(t){for(var e=0,r=0,n=1;n<t.length;++n)t[n][0]<t[e][0]&&(e=n),t[n][0]>t[r][0]&&(r=n);return e<r?[[e],[r]]:e>r?[[r],[e]]:[[e]]}e.exports=n},{}],32:[function(t,e,r){"use strict";function n(t){var e=a(t),r=e.length;if(r<=2)return[];for(var n=new Array(r),i=e[r-1],o=0;o<r;++o){var s=e[o];n[o]=[i,s],i=s}return n}e.exports=n;var a=t("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":71}],33:[function(t,e,r){"use strict";function n(t,e){for(var r=t.length,n=new Array(r),a=0;a<e.length;++a)n[a]=t[e[a]];for(var i=e.length,a=0;a<r;++a)e.indexOf(a)<0&&(n[i++]=t[a]);return n}function a(t,e){for(var r=t.length,n=e.length,a=0;a<r;++a)for(var i=t[a],o=0;o<i.length;++o){var s=i[o];if(s<n)i[o]=e[s];else{s-=n;for(var u=0;u<n;++u)s>=e[u]&&(s+=1);i[o]=s}}return t}function i(t,e){try{return o(t,!0)}catch(c){var r=s(t);if(r.length<=e)return[];var i=n(t,r),u=o(i,!0);return a(u,r)}}e.exports=i;var o=t("incremental-convex-hull"),s=t("affine-hull")},{"affine-hull":25,"incremental-convex-hull":69}],34:[function(t,e,r){t("../../modules/es6.object.define-property");var n=t("../../modules/_core").Object;e.exports=function(t,e,r){return n.defineProperty(t,e,r)}},{"../../modules/_core":37,"../../modules/es6.object.define-property":50}],35:[function(t,e,r){e.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},{}],36:[function(t,e,r){var n=t("./_is-object");e.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},{"./_is-object":46}],37:[function(t,e,r){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},{}],38:[function(t,e,r){var n=t("./_a-function");e.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,a){return t.call(e,r,n,a)}}return function(){return t.apply(e,arguments)}}},{"./_a-function":35}],39:[function(t,e,r){e.exports=!t("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":42}],40:[function(t,e,r){var n=t("./_is-object"),a=t("./_global").document,i=n(a)&&n(a.createElement);e.exports=function(t){return i?a.createElement(t):{}}},{"./_global":43,"./_is-object":46}],41:[function(t,e,r){var n=t("./_global"),a=t("./_core"),i=t("./_ctx"),o=t("./_hide"),s=function(t,e,r){var u,c,l,h=t&s.F,f=t&s.G,d=t&s.S,m=t&s.P,p=t&s.B,v=t&s.W,g=f?a:a[e]||(a[e]={}),M=g.prototype,b=f?n:d?n[e]:(n[e]||{}).prototype;f&&(r=e);for(u in r)(c=!h&&b&&void 0!==b[u])&&u in g||(l=c?b[u]:r[u],g[u]=f&&"function"!=typeof b[u]?r[u]:p&&c?i(l,n):v&&b[u]==l?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):m&&"function"==typeof l?i(Function.call,l):l,m&&((g.virtual||(g.virtual={}))[u]=l,t&s.R&&M&&!M[u]&&o(M,u,l)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},{"./_core":37,"./_ctx":38,"./_global":43,"./_hide":44}],42:[function(t,e,r){e.exports=function(t){try{return!!t()}catch(t){return!0}}},{}],43:[function(t,e,r){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],44:[function(t,e,r){var n=t("./_object-dp"),a=t("./_property-desc");e.exports=t("./_descriptors")?function(t,e,r){return n.f(t,e,a(1,r))}:function(t,e,r){return t[e]=r,t}},{"./_descriptors":39,"./_object-dp":47,"./_property-desc":48}],45:[function(t,e,r){e.exports=!t("./_descriptors")&&!t("./_fails")(function(){return 7!=Object.defineProperty(t("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":39,"./_dom-create":40,"./_fails":42}],46:[function(t,e,r){e.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},{}],47:[function(t,e,r){var n=t("./_an-object"),a=t("./_ie8-dom-define"),i=t("./_to-primitive"),o=Object.defineProperty;r.f=t("./_descriptors")?Object.defineProperty:function(t,e,r){if(n(t),e=i(e,!0),n(r),a)try{return o(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},{"./_an-object":36,"./_descriptors":39,"./_ie8-dom-define":45,"./_to-primitive":49}],48:[function(t,e,r){e.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},{}],49:[function(t,e,r){var n=t("./_is-object");e.exports=function(t,e){if(!n(t))return t;var r,a;if(e&&"function"==typeof(r=t.toString)&&!n(a=r.call(t)))return a;if("function"==typeof(r=t.valueOf)&&!n(a=r.call(t)))return a;if(!e&&"function"==typeof(r=t.toString)&&!n(a=r.call(t)))return a;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":46}],50:[function(t,e,r){var n=t("./_export");n(n.S+n.F*!t("./_descriptors"),"Object",{defineProperty:t("./_object-dp").f})},{"./_descriptors":39,"./_export":41,"./_object-dp":47}],51:[function(t,e,r){"use strict";var n=t("babel-runtime/helpers/create-class").default,a=t("babel-runtime/helpers/class-call-check").default;Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(e,r){a(this,t),this.delayTime=0,this.posRead=0,this.posWrite=0,this.fracXi1=0,this.fracYi1=0,this.intDelay=0,this.fracDelay=0,this.a1=void 0,this.sampleRate=e,this.maxDelayTime=r||1,this.bufferSize=this.maxDelayTime*this.sampleRate,this.bufferSize%1!=0&&(this.bufferSize=parseInt(this.bufferSize)+1),this.buffer=new Float32Array(this.bufferSize)}return n(t,[{key:"setDelay",value:function(t){if(!(t<this.maxDelayTime))throw new Error("delayTime > maxDelayTime");this.delayTime=t;var e=t*this.sampleRate;this.intDelay=parseInt(e),this.fracDelay=e-this.intDelay,this.resample(),0!==this.fracDelay&&this.updateThiranCoefficient()}},{key:"getDelay",value:function(){return this.delayTime}},{key:"process",value:function(t){for(var e=new Float32Array(t.length),r=0;r<t.length;r+=1)this.buffer[this.posWrite]=t[r],e[r]=this.buffer[this.posRead],this.updatePointers();return 0===this.fracDelay?e:e=new Float32Array(this.fractionalThiranProcess(e))}},{key:"updatePointers",value:function(){this.posWrite===this.buffer.length-1?this.posWrite=0:this.posWrite=this.posWrite+1,this.posRead===this.buffer.length-1?this.posRead=0:this.posRead=this.posRead+1}},{key:"updateThiranCoefficient",value:function(){this.a1=(1-this.fracDelay)/(1+this.fracDelay)}},{key:"resample",value:function(){if(this.posWrite-this.intDelay<0){var t=this.intDelay-this.posWrite;this.posRead=this.buffer.length-t}else this.posRead=this.posWrite-this.intDelay}},{key:"fractionalThiranProcess",value:function(t){for(var e,r,n=new Float32Array(t.length),a=this.fracXi1,i=this.fracYi1,o=0;o<t.length;o+=1)e=t[o],r=this.a1*e+a-this.a1*i,a=e,i=r,n[o]=r;return this.fracXi1=a,this.fracYi1=i,n}}]),t}();r.default=i,e.exports=r.default},{"babel-runtime/helpers/class-call-check":54,"babel-runtime/helpers/create-class":55}],52:[function(t,e,r){e.exports=t("./dist/fractional-delay")},{"./dist/fractional-delay":51}],53:[function(t,e,r){arguments[4][26][0].apply(r,arguments)},{"core-js/library/fn/object/define-property":56,dup:26}],54:[function(t,e,r){"use strict";r.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},r.__esModule=!0},{}],55:[function(t,e,r){"use strict";var n=t("babel-runtime/core-js/object/define-property").default;r.default=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),n(t,a.key,a)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),r.__esModule=!0},{"babel-runtime/core-js/object/define-property":53}],56:[function(t,e,r){var n=t("../../modules/$");e.exports=function(t,e,r){return n.setDesc(t,e,r)}},{"../../modules/$":57}],57:[function(t,e,r){var n=Object;e.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},{}],58:[function(t,e,r){(function(t){"use strict";if(t.AnalyserNode&&!t.AnalyserNode.prototype.getFloatTimeDomainData){var e=new Uint8Array(2048);t.AnalyserNode.prototype.getFloatTimeDomainData=function(t){this.getByteTimeDomainData(e);for(var r=0,n=t.length;r<n;r++)t[r]=.0078125*(e[r]-128)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],59:[function(t,e,r){r.glMatrix=t("./gl-matrix/common.js"),r.mat2=t("./gl-matrix/mat2.js"),r.mat2d=t("./gl-matrix/mat2d.js"),r.mat3=t("./gl-matrix/mat3.js"),r.mat4=t("./gl-matrix/mat4.js"),r.quat=t("./gl-matrix/quat.js"),r.vec2=t("./gl-matrix/vec2.js"),r.vec3=t("./gl-matrix/vec3.js"),r.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":60,"./gl-matrix/mat2.js":61,"./gl-matrix/mat2d.js":62,"./gl-matrix/mat3.js":63,"./gl-matrix/mat4.js":64,"./gl-matrix/quat.js":65,"./gl-matrix/vec2.js":66,"./gl-matrix/vec3.js":67,"./gl-matrix/vec4.js":68}],60:[function(t,e,r){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(t){n.ARRAY_TYPE=t};var a=Math.PI/180;n.toRadian=function(t){return t*a},n.equals=function(t,e){return Math.abs(t-e)<=n.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.exports=n},{}],61:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.fromValues=function(t,e,r,a){var i=new n.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=a,i},a.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},a.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*i-a*n;return o?(o=1/o,t[0]=i*o,t[1]=-n*o,t[2]=-a*o,t[3]=r*o,t):null},a.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},a.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},a.multiply=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*s+i*u,t[1]=a*s+o*u,t[2]=n*c+i*l,t[3]=a*c+o*l,t},a.mul=a.multiply,a.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*s,t[1]=a*u+o*s,t[2]=n*-s+i*u,t[3]=a*-s+o*u,t},a.scale=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1];return t[0]=n*s,t[1]=a*s,t[2]=i*u,t[3]=o*u,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},a.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},a.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},a.sub=a.subtract,a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=t[3],s=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},e.exports=a},{"./common.js":60}],62:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.fromValues=function(t,e,r,a,i,o){var s=new n.ARRAY_TYPE(6);return s[0]=t,s[1]=e,s[2]=r,s[3]=a,s[4]=i,s[5]=o,s},a.set=function(t,e,r,n,a,i,o){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=r*i-n*a;return u?(u=1/u,t[0]=i*u,t[1]=-n*u,t[2]=-a*u,t[3]=r*u,t[4]=(a*s-i*o)*u,t[5]=(n*o-r*s)*u,t):null},a.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},a.multiply=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=r[0],l=r[1],h=r[2],f=r[3],d=r[4],m=r[5];return t[0]=n*c+i*l,t[1]=a*c+o*l,t[2]=n*h+i*f,t[3]=a*h+o*f,t[4]=n*d+i*m+s,t[5]=a*d+o*m+u,t},a.mul=a.multiply,a.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=Math.sin(r),l=Math.cos(r);return t[0]=n*l+i*c,t[1]=a*l+o*c,t[2]=n*-c+i*l,t[3]=a*-c+o*l,t[4]=s,t[5]=u,t},a.scale=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=r[0],l=r[1];return t[0]=n*c,t[1]=a*c,t[2]=i*l,t[3]=o*l,t[4]=s,t[5]=u,t},a.translate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=r[0],l=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=n*c+i*l+s,t[5]=a*c+o*l+u,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},a.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=e[0],l=e[1],h=e[2],f=e[3],d=e[4],m=e[5];return Math.abs(r-c)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(a-l)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(i-h)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-f)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-d)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(u-m)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(m))},e.exports=a},{"./common.js":60}],63:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},a.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromValues=function(t,e,r,a,i,o,s,u,c){var l=new n.ARRAY_TYPE(9);return l[0]=t,l[1]=e,l[2]=r,l[3]=a,l[4]=i,l[5]=o,l[6]=s,l[7]=u,l[8]=c,l},a.set=function(t,e,r,n,a,i,o,s,u,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=l*o-s*c,f=-l*i+s*u,d=c*i-o*u,m=r*h+n*f+a*d;return m?(m=1/m,t[0]=h*m,t[1]=(-l*n+a*c)*m,t[2]=(s*n-a*o)*m,t[3]=f*m,t[4]=(l*r-a*u)*m,t[5]=(-s*r+a*i)*m,t[6]=d*m,t[7]=(-c*r+n*u)*m,t[8]=(o*r-n*i)*m,t):null},a.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8];return t[0]=o*l-s*c,t[1]=a*c-n*l,t[2]=n*s-a*o,t[3]=s*u-i*l,t[4]=r*l-a*u,t[5]=a*i-r*s,t[6]=i*c-o*u,t[7]=n*u-r*c,t[8]=r*o-n*i,t},a.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],c=t[8];return e*(c*i-o*u)+r*(-c*a+o*s)+n*(u*a-i*s)},a.multiply=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=r[0],d=r[1],m=r[2],p=r[3],v=r[4],g=r[5],M=r[6],b=r[7],y=r[8];return t[0]=f*n+d*o+m*c,t[1]=f*a+d*s+m*l,t[2]=f*i+d*u+m*h,t[3]=p*n+v*o+g*c,t[4]=p*a+v*s+g*l,t[5]=p*i+v*u+g*h,t[6]=M*n+b*o+y*c,t[7]=M*a+b*s+y*l,t[8]=M*i+b*u+y*h,t},a.mul=a.multiply,a.translate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=r[0],d=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=f*n+d*o+c,t[7]=f*a+d*s+l,t[8]=f*i+d*u+h,t},a.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=Math.sin(r),d=Math.cos(r);return t[0]=d*n+f*o,t[1]=d*a+f*s,t[2]=d*i+f*u,t[3]=d*o-f*n,t[4]=d*s-f*a,t[5]=d*u-f*i,t[6]=c,t[7]=l,t[8]=h,t},a.scale=function(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},a.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,s=n+n,u=a+a,c=r*o,l=n*o,h=n*s,f=a*o,d=a*s,m=a*u,p=i*o,v=i*s,g=i*u;return t[0]=1-h-m,t[3]=l-g,t[6]=f+v,t[1]=l+g,t[4]=1-c-m,t[7]=d-p,t[2]=f-v,t[5]=d+p,t[8]=1-c-h,t},a.normalFromMat4=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],m=e[12],p=e[13],v=e[14],g=e[15],M=r*s-n*o,b=r*u-a*o,y=r*c-i*o,x=n*u-a*s,S=n*c-i*s,w=a*c-i*u,D=l*p-h*m,I=l*v-f*m,F=l*g-d*m,_=h*v-f*p,C=h*g-d*p,A=f*g-d*v,k=M*A-b*C+y*_+x*F-S*I+w*D;return k?(k=1/k,t[0]=(s*A-u*C+c*_)*k,t[1]=(u*F-o*A-c*I)*k,t[2]=(o*C-s*F+c*D)*k,t[3]=(a*C-n*A-i*_)*k,t[4]=(r*A-a*F+i*I)*k,t[5]=(n*F-r*C-i*D)*k,t[6]=(p*w-v*S+g*x)*k,t[7]=(v*y-m*w-g*b)*k,t[8]=(m*S-p*y+g*M)*k,t):null},a.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=e[0],d=e[1],m=e[2],p=e[3],v=e[4],g=e[5],M=t[6],b=e[7],y=e[8];return Math.abs(r-f)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(a-d)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(i-m)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(o-p)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-v)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-g)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-M)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(l-b)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(h-y)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(y))},e.exports=a},{"./common.js":60}],64:[function(t,e,r){var n=t("./common.js"),a={scalar:{},SIMD:{}};a.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.fromValues=function(t,e,r,a,i,o,s,u,c,l,h,f,d,m,p,v){var g=new n.ARRAY_TYPE(16);return g[0]=t,g[1]=e,g[2]=r,g[3]=a,g[4]=i,g[5]=o,g[6]=s,g[7]=u,g[8]=c,g[9]=l,g[10]=h,g[11]=f,g[12]=d,g[13]=m,g[14]=p,g[15]=v,g},a.set=function(t,e,r,n,a,i,o,s,u,c,l,h,f,d,m,p,v){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=h,t[11]=f,t[12]=d,t[13]=m,t[14]=p,t[15]=v,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.scalar.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],i=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=a,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},a.SIMD.transpose=function(t,e){var r,n,a,i,o,s,u,c,l,h;return r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),o=SIMD.Float32x4.shuffle(r,n,0,1,4,5),s=SIMD.Float32x4.shuffle(a,i,0,1,4,5),u=SIMD.Float32x4.shuffle(o,s,0,2,4,6),c=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,c),o=SIMD.Float32x4.shuffle(r,n,2,3,6,7),s=SIMD.Float32x4.shuffle(a,i,2,3,6,7),l=SIMD.Float32x4.shuffle(o,s,0,2,4,6),h=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(t,8,l),SIMD.Float32x4.store(t,12,h),t},a.transpose=n.USE_SIMD?a.SIMD.transpose:a.scalar.transpose,a.scalar.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],m=e[12],p=e[13],v=e[14],g=e[15],M=r*s-n*o,b=r*u-a*o,y=r*c-i*o,x=n*u-a*s,S=n*c-i*s,w=a*c-i*u,D=l*p-h*m,I=l*v-f*m,F=l*g-d*m,_=h*v-f*p,C=h*g-d*p,A=f*g-d*v,k=M*A-b*C+y*_+x*F-S*I+w*D;return k?(k=1/k,t[0]=(s*A-u*C+c*_)*k,t[1]=(a*C-n*A-i*_)*k,t[2]=(p*w-v*S+g*x)*k,t[3]=(f*S-h*w-d*x)*k,t[4]=(u*F-o*A-c*I)*k,t[5]=(r*A-a*F+i*I)*k,t[6]=(v*y-m*w-g*b)*k,t[7]=(l*w-f*y+d*b)*k,t[8]=(o*C-s*F+c*D)*k,t[9]=(n*F-r*C-i*D)*k,t[10]=(m*S-p*y+g*M)*k,t[11]=(h*y-l*S-d*M)*k,t[12]=(s*I-o*_-u*D)*k,t[13]=(r*_-n*I+a*D)*k,t[14]=(p*b-m*x-v*M)*k,t[15]=(l*x-h*b+f*M)*k,t):null},a.SIMD.invert=function(t,e){var r,n,a,i,o,s,u,c,l,h,f=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),m=SIMD.Float32x4.load(e,8),p=SIMD.Float32x4.load(e,12);return o=SIMD.Float32x4.shuffle(f,d,0,1,4,5),n=SIMD.Float32x4.shuffle(m,p,0,1,4,5),r=SIMD.Float32x4.shuffle(o,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,o,1,3,5,7),o=SIMD.Float32x4.shuffle(f,d,2,3,6,7),i=SIMD.Float32x4.shuffle(m,p,2,3,6,7),a=SIMD.Float32x4.shuffle(o,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,o,1,3,5,7),o=SIMD.Float32x4.mul(a,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.mul(n,o),u=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),s),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),o=SIMD.Float32x4.mul(n,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),s),l=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(i,o)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),s),c=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,o)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),o=SIMD.Float32x4.mul(r,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),c),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),l),o=SIMD.Float32x4.swizzle(o,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),c),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,o)),o=SIMD.Float32x4.mul(r,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,o)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),c),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.mul(r,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),u),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,o)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),l),h=SIMD.Float32x4.mul(r,s),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,2,3,0,1),h),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,1,0,3,2),h),o=SIMD.Float32x4.reciprocalApproximation(h),h=SIMD.Float32x4.sub(SIMD.Float32x4.add(o,o),SIMD.Float32x4.mul(h,SIMD.Float32x4.mul(o,o))),(h=SIMD.Float32x4.swizzle(h,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(h,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(h,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(h,c)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(h,l)),t):null},a.invert=n.USE_SIMD?a.SIMD.invert:a.scalar.invert,a.scalar.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],m=e[12],p=e[13],v=e[14],g=e[15];return t[0]=s*(f*g-d*v)-h*(u*g-c*v)+p*(u*d-c*f),t[1]=-(n*(f*g-d*v)-h*(a*g-i*v)+p*(a*d-i*f)),t[2]=n*(u*g-c*v)-s*(a*g-i*v)+p*(a*c-i*u),t[3]=-(n*(u*d-c*f)-s*(a*d-i*f)+h*(a*c-i*u)),t[4]=-(o*(f*g-d*v)-l*(u*g-c*v)+m*(u*d-c*f)),t[5]=r*(f*g-d*v)-l*(a*g-i*v)+m*(a*d-i*f),t[6]=-(r*(u*g-c*v)-o*(a*g-i*v)+m*(a*c-i*u)),t[7]=r*(u*d-c*f)-o*(a*d-i*f)+l*(a*c-i*u),t[8]=o*(h*g-d*p)-l*(s*g-c*p)+m*(s*d-c*h),t[9]=-(r*(h*g-d*p)-l*(n*g-i*p)+m*(n*d-i*h)),t[10]=r*(s*g-c*p)-o*(n*g-i*p)+m*(n*c-i*s),t[11]=-(r*(s*d-c*h)-o*(n*d-i*h)+l*(n*c-i*s)),t[12]=-(o*(h*v-f*p)-l*(s*v-u*p)+m*(s*f-u*h)),
t[13]=r*(h*v-f*p)-l*(n*v-a*p)+m*(n*f-a*h),t[14]=-(r*(s*v-u*p)-o*(n*v-a*p)+m*(n*u-a*s)),t[15]=r*(s*f-u*h)-o*(n*f-a*h)+l*(n*u-a*s),t},a.SIMD.adjoint=function(t,e){var r,n,a,i,o,s,u,c,l,h,f,d,m,r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12);return l=SIMD.Float32x4.shuffle(r,n,0,1,4,5),s=SIMD.Float32x4.shuffle(a,i,0,1,4,5),o=SIMD.Float32x4.shuffle(l,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,l,1,3,5,7),l=SIMD.Float32x4.shuffle(r,n,2,3,6,7),c=SIMD.Float32x4.shuffle(a,i,2,3,6,7),u=SIMD.Float32x4.shuffle(l,c,0,2,4,6),c=SIMD.Float32x4.shuffle(c,l,1,3,5,7),l=SIMD.Float32x4.mul(u,c),l=SIMD.Float32x4.swizzle(l,1,0,3,2),h=SIMD.Float32x4.mul(s,l),f=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,l),h),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),l=SIMD.Float32x4.mul(s,u),l=SIMD.Float32x4.swizzle(l,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),h),m=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(c,l)),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),m),m=SIMD.Float32x4.swizzle(m,2,3,0,1),l=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),c),l=SIMD.Float32x4.swizzle(l,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,l),h),d=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,l)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),l=SIMD.Float32x4.mul(o,s),l=SIMD.Float32x4.swizzle(l,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),d),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,l),m),l=SIMD.Float32x4.swizzle(l,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,l),d),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(u,l)),l=SIMD.Float32x4.mul(o,c),l=SIMD.Float32x4.swizzle(l,1,0,3,2),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,l)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),d),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,l),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,l)),l=SIMD.Float32x4.mul(o,u),l=SIMD.Float32x4.swizzle(l,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),f),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(s,l)),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(c,l)),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),m),SIMD.Float32x4.store(t,0,h),SIMD.Float32x4.store(t,4,f),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,m),t},a.adjoint=n.USE_SIMD?a.SIMD.adjoint:a.scalar.adjoint,a.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],d=t[12],m=t[13],p=t[14],v=t[15];return(e*o-r*i)*(h*v-f*p)-(e*s-n*i)*(l*v-f*m)+(e*u-a*i)*(l*p-h*m)+(r*s-n*o)*(c*v-f*d)-(r*u-a*o)*(c*p-h*d)+(n*u-a*s)*(c*m-l*d)},a.SIMD.multiply=function(t,e,r){var n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.load(r,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),o))));SIMD.Float32x4.store(t,0,u);var c=SIMD.Float32x4.load(r,4),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),o))));SIMD.Float32x4.store(t,4,l);var h=SIMD.Float32x4.load(r,8),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),o))));SIMD.Float32x4.store(t,8,f);var d=SIMD.Float32x4.load(r,12),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),o))));return SIMD.Float32x4.store(t,12,m),t},a.scalar.multiply=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],m=e[11],p=e[12],v=e[13],g=e[14],M=e[15],b=r[0],y=r[1],x=r[2],S=r[3];return t[0]=b*n+y*s+x*h+S*p,t[1]=b*a+y*u+x*f+S*v,t[2]=b*i+y*c+x*d+S*g,t[3]=b*o+y*l+x*m+S*M,b=r[4],y=r[5],x=r[6],S=r[7],t[4]=b*n+y*s+x*h+S*p,t[5]=b*a+y*u+x*f+S*v,t[6]=b*i+y*c+x*d+S*g,t[7]=b*o+y*l+x*m+S*M,b=r[8],y=r[9],x=r[10],S=r[11],t[8]=b*n+y*s+x*h+S*p,t[9]=b*a+y*u+x*f+S*v,t[10]=b*i+y*c+x*d+S*g,t[11]=b*o+y*l+x*m+S*M,b=r[12],y=r[13],x=r[14],S=r[15],t[12]=b*n+y*s+x*h+S*p,t[13]=b*a+y*u+x*f+S*v,t[14]=b*i+y*c+x*d+S*g,t[15]=b*o+y*l+x*m+S*M,t},a.multiply=n.USE_SIMD?a.SIMD.multiply:a.scalar.multiply,a.mul=a.multiply,a.scalar.translate=function(t,e,r){var n,a,i,o,s,u,c,l,h,f,d,m,p=r[0],v=r[1],g=r[2];return e===t?(t[12]=e[0]*p+e[4]*v+e[8]*g+e[12],t[13]=e[1]*p+e[5]*v+e[9]*g+e[13],t[14]=e[2]*p+e[6]*v+e[10]*g+e[14],t[15]=e[3]*p+e[7]*v+e[11]*g+e[15]):(n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],m=e[11],t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=m,t[12]=n*p+s*v+h*g+e[12],t[13]=a*p+u*v+f*g+e[13],t[14]=i*p+c*v+d*g+e[14],t[15]=o*p+l*v+m*g+e[15]),t},a.SIMD.translate=function(t,e,r){var n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(r[0],r[1],r[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,0,0,0,0)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,1,1,1,1)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(n,SIMD.Float32x4.add(a,SIMD.Float32x4.add(i,o)));return SIMD.Float32x4.store(t,12,u),t},a.translate=n.USE_SIMD?a.SIMD.translate:a.scalar.translate,a.scalar.scale=function(t,e,r){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.SIMD.scale=function(t,e,r){var n,a,i,o=SIMD.Float32x4(r[0],r[1],r[2],0);return n=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(o,0,0,0,0))),a=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(o,1,1,1,1))),i=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(o,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.scale=n.USE_SIMD?a.SIMD.scale:a.scalar.scale,a.rotate=function(t,e,r,a){var i,o,s,u,c,l,h,f,d,m,p,v,g,M,b,y,x,S,w,D,I,F,_,C,A=a[0],k=a[1],P=a[2],j=Math.sqrt(A*A+k*k+P*P);return Math.abs(j)<n.EPSILON?null:(j=1/j,A*=j,k*=j,P*=j,i=Math.sin(r),o=Math.cos(r),s=1-o,u=e[0],c=e[1],l=e[2],h=e[3],f=e[4],d=e[5],m=e[6],p=e[7],v=e[8],g=e[9],M=e[10],b=e[11],y=A*A*s+o,x=k*A*s+P*i,S=P*A*s-k*i,w=A*k*s-P*i,D=k*k*s+o,I=P*k*s+A*i,F=A*P*s+k*i,_=k*P*s-A*i,C=P*P*s+o,t[0]=u*y+f*x+v*S,t[1]=c*y+d*x+g*S,t[2]=l*y+m*x+M*S,t[3]=h*y+p*x+b*S,t[4]=u*w+f*D+v*I,t[5]=c*w+d*D+g*I,t[6]=l*w+m*D+M*I,t[7]=h*w+p*D+b*I,t[8]=u*F+f*_+v*C,t[9]=c*F+d*_+g*C,t[10]=l*F+m*_+M*C,t[11]=h*F+p*_+b*C,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},a.scalar.rotateX=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],o=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+c*n,t[5]=o*a+l*n,t[6]=s*a+h*n,t[7]=u*a+f*n,t[8]=c*a-i*n,t[9]=l*a-o*n,t[10]=h*a-s*n,t[11]=f*a-u*n,t},a.SIMD.rotateX=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),t},a.rotateX=n.USE_SIMD?a.SIMD.rotateX:a.scalar.rotateX,a.scalar.rotateY=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],u=e[3],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-c*n,t[1]=o*a-l*n,t[2]=s*a-h*n,t[3]=u*a-f*n,t[8]=i*n+c*a,t[9]=o*n+l*a,t[10]=s*n+h*a,t[11]=u*n+f*a,t},a.SIMD.rotateY=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,n),SIMD.Float32x4.mul(o,a))),t},a.rotateY=n.USE_SIMD?a.SIMD.rotateY:a.scalar.rotateY,a.scalar.rotateZ=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+c*n,t[1]=o*a+l*n,t[2]=s*a+h*n,t[3]=u*a+f*n,t[4]=c*a-i*n,t[5]=l*a-o*n,t[6]=h*a-s*n,t[7]=f*a-u*n,t},a.SIMD.rotateZ=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),t},a.rotateZ=n.USE_SIMD?a.SIMD.rotateZ:a.scalar.rotateZ,a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotation=function(t,e,r){var a,i,o,s=r[0],u=r[1],c=r[2],l=Math.sqrt(s*s+u*u+c*c);return Math.abs(l)<n.EPSILON?null:(l=1/l,s*=l,u*=l,c*=l,a=Math.sin(e),i=Math.cos(e),o=1-i,t[0]=s*s*o+i,t[1]=u*s*o+c*a,t[2]=c*s*o-u*a,t[3]=0,t[4]=s*u*o-c*a,t[5]=u*u*o+i,t[6]=c*u*o+s*a,t[7]=0,t[8]=s*c*o+u*a,t[9]=u*c*o-s*a,t[10]=c*c*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},a.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotationTranslation=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=n+n,u=a+a,c=i+i,l=n*s,h=n*u,f=n*c,d=a*u,m=a*c,p=i*c,v=o*s,g=o*u,M=o*c;return t[0]=1-(d+p),t[1]=h+M,t[2]=f-g,t[3]=0,t[4]=h-M,t[5]=1-(l+p),t[6]=m+v,t[7]=0,t[8]=f+g,t[9]=m-v,t[10]=1-(l+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},a.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},a.getRotation=function(t,e){var r=e[0]+e[5]+e[10],n=0;return r>0?(n=2*Math.sqrt(r+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t},a.fromRotationTranslationScale=function(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=e[3],u=a+a,c=i+i,l=o+o,h=a*u,f=a*c,d=a*l,m=i*c,p=i*l,v=o*l,g=s*u,M=s*c,b=s*l,y=n[0],x=n[1],S=n[2];return t[0]=(1-(m+v))*y,t[1]=(f+b)*y,t[2]=(d-M)*y,t[3]=0,t[4]=(f-b)*x,t[5]=(1-(h+v))*x,t[6]=(p+g)*x,t[7]=0,t[8]=(d+M)*S,t[9]=(p-g)*S,t[10]=(1-(h+m))*S,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},a.fromRotationTranslationScaleOrigin=function(t,e,r,n,a){var i=e[0],o=e[1],s=e[2],u=e[3],c=i+i,l=o+o,h=s+s,f=i*c,d=i*l,m=i*h,p=o*l,v=o*h,g=s*h,M=u*c,b=u*l,y=u*h,x=n[0],S=n[1],w=n[2],D=a[0],I=a[1],F=a[2];return t[0]=(1-(p+g))*x,t[1]=(d+y)*x,t[2]=(m-b)*x,t[3]=0,t[4]=(d-y)*S,t[5]=(1-(f+g))*S,t[6]=(v+M)*S,t[7]=0,t[8]=(m+b)*w,t[9]=(v-M)*w,t[10]=(1-(f+p))*w,t[11]=0,t[12]=r[0]+D-(t[0]*D+t[4]*I+t[8]*F),t[13]=r[1]+I-(t[1]*D+t[5]*I+t[9]*F),t[14]=r[2]+F-(t[2]*D+t[6]*I+t[10]*F),t[15]=1,t},a.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,s=n+n,u=a+a,c=r*o,l=n*o,h=n*s,f=a*o,d=a*s,m=a*u,p=i*o,v=i*s,g=i*u;return t[0]=1-h-m,t[1]=l+g,t[2]=f-v,t[3]=0,t[4]=l-g,t[5]=1-c-m,t[6]=d+p,t[7]=0,t[8]=f+v,t[9]=d-p,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.frustum=function(t,e,r,n,a,i,o){var s=1/(r-e),u=1/(a-n),c=1/(i-o);return t[0]=2*i*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*u,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(a+n)*u,t[10]=(o+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*c,t[15]=0,t},a.perspective=function(t,e,r,n,a){var i=1/Math.tan(e/2),o=1/(n-a);return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+n)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*n*o,t[15]=0,t},a.perspectiveFromFieldOfView=function(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(a+i);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(a-i)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},a.ortho=function(t,e,r,n,a,i,o){var s=1/(e-r),u=1/(n-a),c=1/(i-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(a+n)*u,t[14]=(o+i)*c,t[15]=1,t},a.lookAt=function(t,e,r,i){var o,s,u,c,l,h,f,d,m,p,v=e[0],g=e[1],M=e[2],b=i[0],y=i[1],x=i[2],S=r[0],w=r[1],D=r[2];return Math.abs(v-S)<n.EPSILON&&Math.abs(g-w)<n.EPSILON&&Math.abs(M-D)<n.EPSILON?a.identity(t):(f=v-S,d=g-w,m=M-D,p=1/Math.sqrt(f*f+d*d+m*m),f*=p,d*=p,m*=p,o=y*m-x*d,s=x*f-b*m,u=b*d-y*f,p=Math.sqrt(o*o+s*s+u*u),p?(p=1/p,o*=p,s*=p,u*=p):(o=0,s=0,u=0),c=d*u-m*s,l=m*o-f*u,h=f*s-d*o,p=Math.sqrt(c*c+l*l+h*h),p?(p=1/p,c*=p,l*=p,h*=p):(c=0,l=0,h=0),t[0]=o,t[1]=c,t[2]=f,t[3]=0,t[4]=s,t[5]=l,t[6]=d,t[7]=0,t[8]=u,t[9]=h,t[10]=m,t[11]=0,t[12]=-(o*v+s*g+u*M),t[13]=-(c*v+l*g+h*M),t[14]=-(f*v+d*g+m*M),t[15]=1,t)},a.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=t[9],d=t[10],m=t[11],p=t[12],v=t[13],g=t[14],M=t[15],b=e[0],y=e[1],x=e[2],S=e[3],w=e[4],D=e[5],I=e[6],F=e[7],_=e[8],C=e[9],A=e[10],k=e[11],P=e[12],j=e[13],T=e[14],R=e[15];return Math.abs(r-b)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(a-y)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(i-x)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-S)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(s-w)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(u-D)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(c-I)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(l-F)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(h-_)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(f-C)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(d-A)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(m-k)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(k))&&Math.abs(p-P)<=n.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(v-j)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(j))&&Math.abs(g-T)<=n.EPSILON*Math.max(1,Math.abs(g),Math.abs(T))&&Math.abs(M-R)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(R))},e.exports=a},{"./common.js":60}],65:[function(t,e,r){var n=t("./common.js"),a=t("./mat3.js"),i=t("./vec3.js"),o=t("./vec4.js"),s={};s.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=i.create(),e=i.fromValues(1,0,0),r=i.fromValues(0,1,0);return function(n,a,o){var u=i.dot(a,o);return u<-.999999?(i.cross(t,e,a),i.length(t)<1e-6&&i.cross(t,r,a),i.normalize(t,t),s.setAxisAngle(n,t,Math.PI),n):u>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(i.cross(t,a,o),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+u,s.normalize(n,n))}}(),s.setAxes=function(){var t=a.create();return function(e,r,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=o.clone,s.fromValues=o.fromValues,s.copy=o.copy,s.set=o.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t},s.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return 0!=n?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r},s.add=o.add,s.multiply=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*l+o*s+a*c-i*u,t[1]=a*l+o*u+i*s-n*c,t[2]=i*l+o*c+n*u-a*s,t[3]=o*l-n*s-a*u-i*c,t},s.mul=s.multiply,s.scale=o.scale,s.rotateX=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+o*s,t[1]=a*u+i*s,t[2]=i*u-a*s,t[3]=o*u-n*s,t},s.rotateY=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u-i*s,t[1]=a*u+o*s,t[2]=i*u+n*s,t[3]=o*u-a*s,t},s.rotateZ=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+a*s,t[1]=a*u-n*s,t[2]=i*u+o*s,t[3]=o*u-i*s,t},s.calculateW=function(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=n,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),t},s.dot=o.dot,s.lerp=o.lerp,s.slerp=function(t,e,r,n){var a,i,o,s,u,c=e[0],l=e[1],h=e[2],f=e[3],d=r[0],m=r[1],p=r[2],v=r[3];return i=c*d+l*m+h*p+f*v,i<0&&(i=-i,d=-d,m=-m,p=-p,v=-v),1-i>1e-6?(a=Math.acos(i),o=Math.sin(a),s=Math.sin((1-n)*a)/o,u=Math.sin(n*a)/o):(s=1-n,u=n),t[0]=s*c+u*d,t[1]=s*l+u*m,t[2]=s*h+u*p,t[3]=s*f+u*v,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(r,n,a,i,o,u){return s.slerp(t,n,o,u),s.slerp(e,a,i,u),s.slerp(r,t,e,2*u*(1-u)),r}}(),s.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*r+n*n+a*a+i*i,s=o?1/o:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-a*s,t[3]=i*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=o.length,s.len=s.length,s.squaredLength=o.squaredLength,s.sqrLen=s.squaredLength,s.normalize=o.normalize,s.fromMat3=function(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*i+i]-e[3*o+o]+1),t[a]=.5*r,r=.5/r,t[3]=(e[3*i+o]-e[3*o+i])*r,t[i]=(e[3*i+a]+e[3*a+i])*r,t[o]=(e[3*o+a]+e[3*a+o])*r}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},s.exactEquals=o.exactEquals,s.equals=o.equals,e.exports=s},{"./common.js":60,"./mat3.js":63,"./vec3.js":67,"./vec4.js":68}],66:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},a.fromValues=function(t,e){var r=new n.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},a.set=function(t,e,r){return t[0]=e,t[1]=r,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=r*r+n*n;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},a.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},a.lerp=function(t,e,r,n){var a=e[0],i=e[1];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t},a.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},a.transformMat2=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a,t[1]=r[1]*n+r[3]*a,t},a.transformMat2d=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a+r[4],t[1]=r[1]*n+r[3]*a+r[5],t},a.transformMat3=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[3]*a+r[6],t[1]=r[1]*n+r[4]*a+r[7],t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[4]*a+r[12],t[1]=r[1]*n+r[5]*a+r[13],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,i,o){var s,u;for(r||(r=2),n||(n=0),u=a?Math.min(a*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],i(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},a.equals=function(t,e){var r=t[0],a=t[1],i=e[0],o=e[1];return Math.abs(r-i)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-o)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))},e.exports=a},{"./common.js":60}],67:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.fromValues=function(t,e,r){var a=new n.ARRAY_TYPE(3);return a[0]=t,a[1]=e,a[2]=r,a},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(r*r+n*n+a*a)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return r*r+n*n+a*a},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.cross=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],u=r[2];return t[0]=a*u-i*s,t[1]=i*o-n*u,t[2]=n*s-a*o,t},a.lerp=function(t,e,r,n){var a=e[0],i=e[1],o=e[2];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t[2]=o+n*(r[2]-o),t},a.hermite=function(t,e,r,n,a,i){var o=i*i,s=o*(2*i-3)+1,u=o*(i-2)+i,c=o*(i-1),l=o*(3-2*i);return t[0]=e[0]*s+r[0]*u+n[0]*c+a[0]*l,t[1]=e[1]*s+r[1]*u+n[1]*c+a[1]*l,t[2]=e[2]*s+r[2]*u+n[2]*c+a[2]*l,t},a.bezier=function(t,e,r,n,a,i){var o=1-i,s=o*o,u=i*i,c=s*o,l=3*i*s,h=3*u*o,f=u*i;return t[0]=e[0]*c+r[0]*l+n[0]*h+a[0]*f,t[1]=e[1]*c+r[1]*l+n[1]*h+a[1]*f,t[2]=e[2]*c+r[2]*l+n[2]*h+a[2]*f,t},a.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI,a=2*n.RANDOM()-1,i=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=a*e,t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[3]*n+r[7]*a+r[11]*i+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/o,t[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/o,t[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/o,t},a.transformMat3=function(t,e,r){var n=e[0],a=e[1],i=e[2];return t[0]=n*r[0]+a*r[3]+i*r[6],t[1]=n*r[1]+a*r[4]+i*r[7],t[2]=n*r[2]+a*r[5]+i*r[8],t},a.transformQuat=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*i-u*a,h=c*a+u*n-o*i,f=c*i+o*a-s*n,d=-o*n-s*a-u*i;return t[0]=l*c+d*-o+h*-u-f*-s,t[1]=h*c+d*-s+f*-o-l*-u,t[2]=f*c+d*-u+l*-s-h*-o,t},a.rotateX=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},a.rotateY=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},a.rotateZ=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,i,o){var s,u;for(r||(r=3),n||(n=0),u=a?Math.min(a*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],i(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),a.angle=function(t,e){var r=a.fromValues(t[0],t[1],t[2]),n=a.fromValues(e[0],e[1],e[2]);a.normalize(r,r),a.normalize(n,n);var i=a.dot(r,n);return i>1?0:Math.acos(i)},a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=e[0],s=e[1],u=e[2];return Math.abs(r-o)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-s)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(i-u)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))},e.exports=a},{"./common.js":60}],68:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.fromValues=function(t,e,r,a){var i=new n.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=a,i},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(r*r+n*n+a*a+i*i)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return r*r+n*n+a*a+i*i},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1],n=t[2],a=t[3]
;return Math.sqrt(e*e+r*r+n*n+a*a)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],a=t[3];return e*e+r*r+n*n+a*a},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*r+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=n*o,t[2]=a*o,t[3]=i*o),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},a.lerp=function(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=e[3];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t[2]=o+n*(r[2]-o),t[3]=s+n*(r[3]-s),t},a.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),a.normalize(t,t),a.scale(t,t,e),t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o,t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o,t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o,t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o,t},a.transformQuat=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*i-u*a,h=c*a+u*n-o*i,f=c*i+o*a-s*n,d=-o*n-s*a-u*i;return t[0]=l*c+d*-o+h*-u-f*-s,t[1]=h*c+d*-s+f*-o-l*-u,t[2]=f*c+d*-u+l*-s-h*-o,t[3]=e[3],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,i,o){var s,u;for(r||(r=4),n||(n=0),u=a?Math.min(a*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],i(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),a.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=t[3],s=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},e.exports=a},{"./common.js":60}],69:[function(t,e,r){"use strict";function n(t,e,r){this.vertices=t,this.adjacent=e,this.boundary=r,this.lastVisited=-1}function a(t,e,r){this.vertices=t,this.cell=e,this.index=r}function i(t,e){return l(t.vertices,e.vertices)}function o(t){for(var e=["function orient(){var tuple=this.tuple;return test("],r=0;r<=t;++r)r>0&&e.push(","),e.push("tuple[",r,"]");e.push(")}return orient");var n=new Function("test",e.join("")),a=c[t+1];return a||(a=c),n(a)}function s(t,e,r){this.dimension=t,this.vertices=e,this.simplices=r,this.interior=r.filter(function(t){return!t.boundary}),this.tuple=new Array(t+1);for(var n=0;n<=t;++n)this.tuple[n]=this.vertices[n];var a=h[t];a||(a=h[t]=o(t)),this.orient=a}function u(t,e){var r=t.length;if(0===r)throw new Error("Must have at least d+1 points");var a=t[0].length;if(r<=a)throw new Error("Must input at least d+1 points");var i=t.slice(0,a+1),o=c.apply(void 0,i);if(0===o)throw new Error("Input not in general position");for(var u=new Array(a+1),l=0;l<=a;++l)u[l]=l;o<0&&(u[0]=1,u[1]=0);for(var h=new n(u,new Array(a+1),!1),f=h.adjacent,d=new Array(a+2),l=0;l<=a;++l){for(var m=u.slice(),p=0;p<=a;++p)p===l&&(m[p]=-1);var v=m[0];m[0]=m[1],m[1]=v;var g=new n(m,new Array(a+1),!0);f[l]=g,d[l]=g}d[a+1]=h;for(var l=0;l<=a;++l)for(var m=f[l].vertices,M=f[l].adjacent,p=0;p<=a;++p){var b=m[p];if(b<0)M[p]=h;else for(var y=0;y<=a;++y)f[y].vertices.indexOf(b)<0&&(M[p]=f[y])}for(var x=new s(a,i,d),S=!!e,l=a+1;l<r;++l)x.insert(t[l],S);return x.boundary()}e.exports=u;var c=t("robust-orientation"),l=t("simplicial-complex").compareCells;n.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var e=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=e};var h=[],f=s.prototype;f.handleBoundaryDegeneracy=function(t,e){var r=this.dimension,n=this.vertices.length-1,a=this.tuple,i=this.vertices,o=[t];for(t.lastVisited=-n;o.length>0;){t=o.pop();for(var s=(t.vertices,t.adjacent),u=0;u<=r;++u){var c=s[u];if(c.boundary&&!(c.lastVisited<=-n)){for(var l=c.vertices,h=0;h<=r;++h){var f=l[h];a[h]=f<0?e:i[f]}var d=this.orient();if(d>0)return c;c.lastVisited=-n,0===d&&o.push(c)}}}return null},f.walk=function(t,e){var r=this.vertices.length-1,n=this.dimension,a=this.vertices,i=this.tuple,o=e?this.interior.length*Math.random()|0:this.interior.length-1,s=this.interior[o];t:for(;!s.boundary;){for(var u=s.vertices,c=s.adjacent,l=0;l<=n;++l)i[l]=a[u[l]];s.lastVisited=r;for(var l=0;l<=n;++l){var h=c[l];if(!(h.lastVisited>=r)){var f=i[l];i[l]=t;var d=this.orient();if(i[l]=f,d<0){s=h;continue t}h.boundary?h.lastVisited=-r:h.lastVisited=r}}return}return s},f.addPeaks=function(t,e){var r=this.vertices.length-1,o=this.dimension,s=this.vertices,u=this.tuple,c=this.interior,l=this.simplices,h=[e];e.lastVisited=r,e.vertices[e.vertices.indexOf(-1)]=r,e.boundary=!1,c.push(e);for(var f=[];h.length>0;){var e=h.pop(),d=e.vertices,m=e.adjacent,p=d.indexOf(r);if(!(p<0))for(var v=0;v<=o;++v)if(v!==p){var g=m[v];if(g.boundary&&!(g.lastVisited>=r)){var M=g.vertices;if(g.lastVisited!==-r){for(var b=0,y=0;y<=o;++y)M[y]<0?(b=y,u[y]=t):u[y]=s[M[y]];var x=this.orient();if(x>0){M[b]=r,g.boundary=!1,c.push(g),h.push(g),g.lastVisited=r;continue}g.lastVisited=-r}var S=g.adjacent,w=d.slice(),D=m.slice(),I=new n(w,D,!0);l.push(I);var F=S.indexOf(e);if(!(F<0)){S[F]=I,D[p]=g,w[v]=-1,D[v]=e,m[v]=I,I.flip();for(var y=0;y<=o;++y){var _=w[y];if(!(_<0||_===r)){for(var C=new Array(o-1),A=0,k=0;k<=o;++k){var P=w[k];P<0||k===y||(C[A++]=P)}f.push(new a(C,I,y))}}}}}}f.sort(i);for(var v=0;v+1<f.length;v+=2){var j=f[v],T=f[v+1],R=j.index,O=T.index;R<0||O<0||(j.cell.adjacent[j.index]=T.cell,T.cell.adjacent[T.index]=j.cell)}},f.insert=function(t,e){var r=this.vertices;r.push(t);var n=this.walk(t,e);if(n){for(var a=this.dimension,i=this.tuple,o=0;o<=a;++o){var s=n.vertices[o];i[o]=s<0?t:r[s]}var u=this.orient(i);u<0||(0!==u||(n=this.handleBoundaryDegeneracy(n,t)))&&this.addPeaks(t,n)}},f.boundary=function(){for(var t=this.dimension,e=[],r=this.simplices,n=r.length,a=0;a<n;++a){var i=r[a];if(i.boundary){for(var o=new Array(t),s=i.vertices,u=0,c=0,l=0;l<=t;++l)s[l]>=0?o[u++]=s[l]:c=1&l;if(c===(1&t)){var h=o[0];o[0]=o[1],o[1]=h}e.push(o)}}return e}},{"robust-orientation":73,"simplicial-complex":89}],70:[function(t,e,r){function n(t,e,r){this.obj=t,this.left=null,this.right=null,this.parent=r,this.dimension=e}function a(t,e,r){function a(t,e,i){var o,s,u=e%r.length;return 0===t.length?null:1===t.length?new n(t[0],u,i):(t.sort(function(t,e){return t[r[u]]-e[r[u]]}),o=Math.floor(t.length/2),s=new n(t[o],u,i),s.left=a(t.slice(0,o),e+1,s),s.right=a(t.slice(o+1),e+1,s),s)}var o=this;this.root=a(t,0,null),this.insert=function(t){function e(n,a){if(null===n)return a;var i=r[n.dimension];return t[i]<n.obj[i]?e(n.left,n):e(n.right,n)}var a,i,o=e(this.root,null);if(null===o)return void(this.root=new n(t,0,null));a=new n(t,(o.dimension+1)%r.length,o),i=r[o.dimension],t[i]<o.obj[i]?o.left=a:o.right=a},this.remove=function(t){function e(n){if(null===n)return null;if(n.obj===t)return n;var a=r[n.dimension];return t[a]<n.obj[a]?e(n.left,n):e(n.right,n)}function n(t){function e(t,n){var a,i,o,s,u;return null===t?null:(a=r[n],t.dimension===n?null!==t.right?e(t.right,n):t:(i=t.obj[a],o=e(t.left,n),s=e(t.right,n),u=t,null!==o&&o.obj[a]>i&&(u=o),null!==s&&s.obj[a]>u.obj[a]&&(u=s),u))}function a(t,e){var n,i,o,s,u;return null===t?null:(n=r[e],t.dimension===e?null!==t.left?a(t.left,e):t:(i=t.obj[n],o=a(t.left,e),s=a(t.right,e),u=t,null!==o&&o.obj[n]<i&&(u=o),null!==s&&s.obj[n]<u.obj[n]&&(u=s),u))}var i,s,u;if(null===t.left&&null===t.right)return null===t.parent?void(o.root=null):(u=r[t.parent.dimension],void(t.obj[u]<t.parent.obj[u]?t.parent.left=null:t.parent.right=null));i=null!==t.left?e(t.left,t.dimension):a(t.right,t.dimension),s=i.obj,n(i),t.obj=s}var a;null!==(a=e(o.root))&&n(a)},this.nearest=function(t,n,a){function s(a){function i(t,e){l.push([t,e]),l.size()>n&&l.pop()}if(!o.root)return[];var u,c,h,f,d=r[a.dimension],m=e(t,a.obj),p={};for(f=0;f<r.length;f+=1)f===a.dimension?p[r[f]]=t[r[f]]:p[r[f]]=a.obj[r[f]];if(c=e(p,a.obj),null===a.right&&null===a.left)return void((l.size()<n||m<l.peek()[1])&&i(a,m));u=null===a.right?a.left:null===a.left?a.right:t[d]<a.obj[d]?a.left:a.right,s(u),(l.size()<n||m<l.peek()[1])&&i(a,m),(l.size()<n||Math.abs(c)<l.peek()[1])&&null!==(h=u===a.left?a.right:a.left)&&s(h)}var u,c,l;if(l=new i(function(t){return-t[1]}),a)for(u=0;u<n;u+=1)l.push([null,a]);for(s(o.root),c=[],u=0;u<n&&u<l.content.length;u+=1)l.content[u][0]&&c.push([l.content[u][0].obj,l.content[u][1]]);return c},this.balanceFactor=function(){function t(e){return null===e?0:Math.max(t(e.left),t(e.right))+1}function e(t){return null===t?0:e(t.left)+e(t.right)+1}return t(o.root)/(Math.log(e(o.root))/Math.log(2))}}function i(t){this.content=[],this.scoreFunction=t}i.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t},peek:function(){return this.content[0]},remove:function(t){for(var e=this.content.length,r=0;r<e;r++)if(this.content[r]==t){var n=this.content.pop();return void(r!=e-1&&(this.content[r]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.bubbleUp(r):this.sinkDown(r)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(t){for(var e=this.content[t];t>0;){var r=Math.floor((t+1)/2)-1,n=this.content[r];if(!(this.scoreFunction(e)<this.scoreFunction(n)))break;this.content[r]=e,this.content[t]=n,t=r}},sinkDown:function(t){for(var e=this.content.length,r=this.content[t],n=this.scoreFunction(r);;){var a=2*(t+1),i=a-1,o=null;if(i<e){var s=this.content[i],u=this.scoreFunction(s);u<n&&(o=i)}if(a<e){var c=this.content[a];this.scoreFunction(c)<(null==o?n:u)&&(o=a)}if(null==o)break;this.content[t]=this.content[o],this.content[o]=r,t=o}}},e.exports={createKdTree:function(t,e,r){return new a(t,e,r)}}},{}],71:[function(t,e,r){"use strict";function n(t){var e=t.length;if(e<3){for(var r=new Array(e),n=0;n<e;++n)r[n]=n;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:r}for(var i=new Array(e),n=0;n<e;++n)i[n]=n;i.sort(function(e,r){var n=t[e][0]-t[r][0];return n||t[e][1]-t[r][1]});for(var o=[i[0],i[1]],s=[i[0],i[1]],n=2;n<e;++n){for(var u=i[n],c=t[u],l=o.length;l>1&&a(t[o[l-2]],t[o[l-1]],c)<=0;)l-=1,o.pop();for(o.push(u),l=s.length;l>1&&a(t[s[l-2]],t[s[l-1]],c)>=0;)l-=1,s.pop();s.push(u)}for(var r=new Array(s.length+o.length-2),h=0,n=0,f=o.length;n<f;++n)r[h++]=o[n];for(var d=s.length-2;d>0;--d)r[h++]=s[d];return r}e.exports=n;var a=t("robust-orientation")[3]},{"robust-orientation":73}],72:[function(require,module,exports){(function(global){"use strict";var numeric=void 0===exports?function(){}:exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(t,e){var r,n,a,i;for(void 0===e&&(e=15),a=.5,r=new Date;;){for(a*=2,i=a;i>3;i-=4)t(),t(),t(),t();for(;i>0;)t(),i--;if((n=new Date)-r>e)break}for(i=a;i>3;i-=4)t(),t(),t(),t();for(;i>0;)t(),i--;return n=new Date,1e3*(3*a-1)/(n-r)},numeric._myIndexOf=function(t){var e,r=this.length;for(e=0;e<r;++e)if(this[e]===t)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(t){function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var r=Math.floor(Math.log(t)/Math.log(10)),n=t/Math.pow(10,r),a=n.toPrecision(numeric.precision);return 10===parseFloat(a)&&(r++,n=1,a=n.toPrecision(numeric.precision)),parseFloat(a).toString()+"e"+r.toString()}return"Infinity"}function r(t){var a;if(void 0===t)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof t)return n.push('"'+t+'"'),!1;if("boolean"==typeof t)return n.push(t.toString()),!1;if("number"==typeof t){var i=e(t),o=t.toPrecision(numeric.precision),s=parseFloat(t.toString()).toString(),u=[i,o,s,parseFloat(o).toString(),parseFloat(s).toString()];for(a=1;a<u.length;a++)u[a].length<i.length&&(i=u[a]);return n.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===t)return n.push("null"),!1;if("function"==typeof t){n.push(t.toString());var c=!1;for(a in t)t.hasOwnProperty(a)&&(c?n.push(",\n"):n.push("\n{"),c=!0,n.push(a),n.push(": \n"),r(t[a]));return c&&n.push("}\n"),!0}if(t instanceof Array){if(t.length>numeric.largeArray)return n.push("...Large Array..."),!0;var c=!1;for(n.push("["),a=0;a<t.length;a++)a>0&&(n.push(","),c&&n.push("\n ")),c=r(t[a]);return n.push("]"),!0}n.push("{");var c=!1;for(a in t)t.hasOwnProperty(a)&&(c&&n.push(",\n"),c=!0,n.push(a),n.push(": \n"),r(t[a]));return n.push("}"),!0}var n=[];return r(t),n.join("")},numeric.parseDate=function(t){function e(t){if("string"==typeof t)return Date.parse(t.replace(/-/g,"/"));if(!(t instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var r,n=[];for(r=0;r<t.length;r++)n[r]=e(t[r]);return n}return e(t)},numeric.parseFloat=function(t){function e(t){if("string"==typeof t)return parseFloat(t);if(!(t instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var r,n=[];for(r=0;r<t.length;r++)n[r]=e(t[r]);return n}return e(t)},numeric.parseCSV=function(t){var e,r,n=t.split("\n"),a=[],i=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,s=0;for(r=0;r<n.length;r++){var u,c=(n[r]+",").match(i);if(c.length>0){for(a[s]=[],e=0;e<c.length;e++)u=function(t){return t.substr(0,t.length-1)}(c[e]),o.test(u)?a[s][e]=parseFloat(u):a[s][e]=u;s++}}return a},numeric.toCSV=function(t){var e,r,n,a,i,o=numeric.dim(t);for(n=o[0],o[1],i=[],e=0;e<n;e++){for(a=[],r=0;r<n;r++)a[r]=t[e][r].toString();i[e]=a.join(", ")}return i.join("\n")+"\n"},numeric.getURL=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e},numeric.imageURL=function(t){function e(t,e,r){void 0===e&&(e=0),void 0===r&&(r=t.length);var n,a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,o=0;t.length;for(n=e;n<r;n++)o=255&(i^t[n]),i=i>>>8^a[o];return-1^i}var r,n,a,i,o,s,u,c,l,h,f=t[0].length,d=t[0][0].length,m=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,d>>24&255,d>>16&255,d>>8&255,255&d,f>>24&255,f>>16&255,f>>8&255,255&f,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=e(m,12,29),m[29]=h>>24&255,m[30]=h>>16&255,m[31]=h>>8&255,m[32]=255&h,r=1,n=0,u=0;u<f;u++){for(u<f-1?m.push(0):m.push(1),o=3*d+1+(0===u)&255,s=3*d+1+(0===u)>>8&255,m.push(o),m.push(s),m.push(255&~o),m.push(255&~s),0===u&&m.push(0),c=0;c<d;c++)for(a=0;a<3;a++)o=t[a][u][c],o=o>255?255:o<0?0:Math.round(o),r=(r+o)%65521,n=(n+r)%65521,m.push(o);m.push(0)}return l=(n<<16)+r,m.push(l>>24&255),m.push(l>>16&255),m.push(l>>8&255),m.push(255&l),i=m.length-41,m[33]=i>>24&255,m[34]=i>>16&255,m[35]=i>>8&255,m[36]=255&i,h=e(m,37),m.push(h>>24&255),m.push(h>>16&255),m.push(h>>8&255),m.push(255&h),m.push(0),m.push(0),m.push(0),m.push(0),m.push(73),m.push(69),m.push(78),m.push(68),m.push(174),m.push(66),m.push(96),m.push(130),"data:image/png;base64,"+function(t){var e,r,n,a,i,o,s,u,c=t.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="";for(e=0;e<c;e+=3)r=t[e],n=t[e+1],a=t[e+2],i=r>>2,o=((3&r)<<4)+(n>>4),s=((15&n)<<2)+(a>>6),u=63&a,e+1>=c?s=u=64:e+2>=c&&(u=64),h+=l.charAt(i)+l.charAt(o)+l.charAt(s)+l.charAt(u);return h}(m)},numeric._dim=function(t){for(var e=[];"object"==typeof t;)e.push(t.length),t=t[0];return e},numeric.dim=function(t){var e,r;return"object"==typeof t?(e=t[0],"object"==typeof e?(r=e[0],"object"==typeof r?numeric._dim(t):[t.length,e.length]):[t.length]):[]},numeric.mapreduce=function(t,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+t+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+t+";\n    xi = x[i-1];\n    "+t+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+t+"\n}\nreturn accum;")},numeric.mapreduce2=function(t,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+t+";\n}\nreturn accum;")},numeric.same=function t(e,r){var n,a;if(!(e instanceof Array&&r instanceof Array))return!1;if((a=e.length)!==r.length)return!1;for(n=0;n<a;n++)if(e[n]!==r[n]){if("object"!=typeof e[n])return!1;if(!t(e[n],r[n]))return!1}return!0},numeric.rep=function(t,e,r){void 0===r&&(r=0);var n,a=t[r],i=Array(a);if(r===t.length-1){for(n=a-2;n>=0;n-=2)i[n+1]=e,i[n]=e;return-1===n&&(i[0]=e),i}for(n=a-1;n>=0;n--)i[n]=numeric.rep(t,e,r+1);return i},numeric.dotMMsmall=function(t,e){var r,n,a,i,o,s,u,c,l,h,f;for(i=t.length,o=e.length,s=e[0].length,u=Array(i),r=i-1;r>=0;r--){for(c=Array(s),l=t[r],a=s-1;a>=0;a--){for(h=l[o-1]*e[o-1][a],n=o-2;n>=1;n-=2)f=n-1,h+=l[n]*e[n][a]+l[f]*e[f][a];0===n&&(h+=l[0]*e[0][a]),c[a]=h}u[r]=c}return u},numeric._getCol=function(t,e,r){var n,a=t.length;for(n=a-1;n>0;--n)r[n]=t[n][e],--n,r[n]=t[n][e];0===n&&(r[0]=t[0][e])},numeric.dotMMbig=function(t,e){var r,n,a,i=numeric._getCol,o=e.length,s=Array(o),u=t.length,c=e[0].length,l=new Array(u),h=numeric.dotVV;for(--o,--u,n=u;-1!==n;--n)l[n]=Array(c);for(--c,n=c;-1!==n;--n)for(i(e,n,s),a=u;-1!==a;--a)0,r=t[a],l[a][n]=h(r,s);return l},numeric.dotMV=function(t,e){var r,n=t.length,a=(e.length,Array(n)),i=numeric.dotVV;for(r=n-1;r>=0;r--)a[r]=i(t[r],e);return a},numeric.dotVM=function(t,e){var r,n,a,i,o,s,u;for(a=t.length,i=e[0].length,o=Array(i),n=i-1;n>=0;n--){for(s=t[a-1]*e[a-1][n],r=a-2;r>=1;r-=2)u=r-1,s+=t[r]*e[r][n]+t[u]*e[u][n];0===r&&(s+=t[0]*e[0][n]),o[n]=s}return o},numeric.dotVV=function(t,e){var r,n,a=t.length,i=t[a-1]*e[a-1];for(r=a-2;r>=1;r-=2)n=r-1,i+=t[r]*e[r]+t[n]*e[n];return 0===r&&(i+=t[0]*e[0]),i},numeric.dot=function(t,e){var r=numeric.dim;switch(1e3*r(t).length+r(e).length){case 2002:return e.length<10?numeric.dotMMsmall(t,e):numeric.dotMMbig(t,e);case 2001:return numeric.dotMV(t,e);case 1002:return numeric.dotVM(t,e);case 1001:return numeric.dotVV(t,e);case 1e3:return numeric.mulVS(t,e);case 1:return numeric.mulSV(t,e);case 0:return t*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(t){var e,r,n,a,i=t.length,o=Array(i);for(e=i-1;e>=0;e--){for(a=Array(i),r=e+2,n=i-1;n>=r;n-=2)a[n]=0,a[n-1]=0;for(n>e&&(a[n]=0),a[e]=t[e],n=e-1;n>=1;n-=2)a[n]=0,a[n-1]=0;0===n&&(a[0]=0),o[e]=a}return o},numeric.getDiag=function(t){var e,r=Math.min(t.length,t[0].length),n=Array(r);for(e=r-1;e>=1;--e)n[e]=t[e][e],--e,n[e]=t[e][e];return 0===e&&(n[0]=t[0][0]),n},numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))},numeric.pointwise=function(t,e,r){void 0===r&&(r="");var n,a,i=[],o=/\[i\]$/,s="",u=!1;for(n=0;n<t.length;n++)o.test(t[n])?(a=t[n].substring(0,t[n].length-3),s=a):a=t[n],"ret"===a&&(u=!0),i.push(a);return i[t.length]="_s",i[t.length+1]="_k",i[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+t.join(",")+",_s,_k+1);\n    return ret;\n}\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,i)},numeric.pointwise2=function(t,e,r){void 0===r&&(r="");var n,a,i=[],o=/\[i\]$/,s="",u=!1;for(n=0;n<t.length;n++)o.test(t[n])?(a=t[n].substring(0,t[n].length-3),s=a):a=t[n],"ret"===a&&(u=!0),i.push(a);return i[t.length]="var _n = "+s+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,i)},numeric._biforeach=function t(e,r,n,a,i){if(a===n.length-1)return void i(e,r);var o,s=n[a];for(o=s-1;o>=0;o--)t("object"==typeof e?e[o]:e,"object"==typeof r?r[o]:r,n,a+1,i)},numeric._biforeach2=function t(e,r,n,a,i){if(a===n.length-1)return i(e,r);var o,s=n[a],u=Array(s);for(o=s-1;o>=0;--o)u[o]=t("object"==typeof e?e[o]:e,"object"==typeof r?r[o]:r,n,a+1,i);return u},numeric._foreach=function t(e,r,n,a){if(n===r.length-1)return void a(e);var i,o=r[n];for(i=o-1;i>=0;i--)t(e[i],r,n+1,a)},numeric._foreach2=function t(e,r,n,a){if(n===r.length-1)return a(e);var i,o=r[n],s=Array(o);for(i=o-1;i>=0;i--)s[i]=t(e[i],r,n+1,a);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var t,e;for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],numeric.ops2[e]=e;for(t in numeric.ops2)if(numeric.ops2.hasOwnProperty(t)){e=numeric.ops2[t];var r,n,a="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,t)?(a="var "+e+" = Math."+e+";\n",r=function(t,r,n){return t+" = "+e+"("+r+","+n+")"},n=function(t,r){return t+" = "+e+"("+t+","+r+")"}):(r=function(t,r,n){return t+" = "+r+" "+e+" "+n},n=numeric.opseq.hasOwnProperty(t+"eq")?function(t,r){return t+" "+e+"= "+r}:function(t,r){return t+" = "+t+" "+e+" "+r}),numeric[t+"VV"]=numeric.pointwise2(["x[i]","y[i]"],r("ret[i]","x[i]","y[i]"),a),numeric[t+"SV"]=numeric.pointwise2(["x","y[i]"],r("ret[i]","x","y[i]"),a),numeric[t+"VS"]=numeric.pointwise2(["x[i]","y"],r("ret[i]","x[i]","y"),a),numeric[t]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+t+"VV, VS = numeric."+t+"VS, SV = numeric."+t+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+n("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[t],numeric[t+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),a),numeric[t+"eqS"]=numeric.pointwise2(["ret[i]","x"],n("ret[i]","x"),a),numeric[t+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+t+"eqV, S = numeric."+t+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],delete numeric.ops2[e];for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],numeric.ops1[e]=e;for(t in numeric.ops1)numeric.ops1.hasOwnProperty(t)&&(a="",e=numeric.ops1[t],-1!==numeric.myIndexOf.call(numeric.mathfuns,t)&&Math.hasOwnProperty(e)&&(a="var "+e+" = Math."+e+";\n"),numeric[t+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",a),numeric[t+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+t+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[t+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",a),numeric[t]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+t+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],delete numeric.ops1[e];for(t in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(t)&&(e=numeric.mapreducers[t],numeric[t+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[t]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+t+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(t,e){return"object"==typeof t?"object"==typeof e?numeric.truncVV(t,e):numeric.truncVS(t,e):"object"==typeof e?numeric.truncSV(t,e):Math.round(t/e)*e},numeric.inv=function(t){var e,r,n,a,i,o,s,t,u=numeric.dim(t),c=Math.abs,l=u[0],h=u[1],f=numeric.clone(t),d=numeric.identity(l);for(o=0;o<h;++o){var m=-1,p=-1;for(i=o;i!==l;++i)(s=c(f[i][o]))>p&&(m=i,p=s);for(r=f[m],f[m]=f[o],f[o]=r,a=d[m],d[m]=d[o],d[o]=a,t=r[o],s=o;s!==h;++s)r[s]/=t;for(s=h-1;-1!==s;--s)a[s]/=t;for(i=l-1;-1!==i;--i)if(i!==o){for(e=f[i],n=d[i],t=e[o],s=o+1;s!==h;++s)e[s]-=r[s]*t;for(s=h-1;s>0;--s)n[s]-=a[s]*t,--s,n[s]-=a[s]*t;0===s&&(n[0]-=a[0]*t)}}return d},numeric.det=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var r,n,a,i,o,s,u,c,l=e[0],h=1,f=numeric.clone(t);for(n=0;n<l-1;n++){for(a=n,r=n+1;r<l;r++)Math.abs(f[r][n])>Math.abs(f[a][n])&&(a=r);for(a!==n&&(u=f[a],f[a]=f[n],f[n]=u,h*=-1),i=f[n],r=n+1;r<l;r++){for(o=f[r],s=o[n]/i[n],a=n+1;a<l-1;a+=2)c=a+1,o[a]-=i[a]*s,o[c]-=i[c]*s;a!==l&&(o[a]-=i[a]*s)}if(0===i[n])return 0;h*=i[n]}return h*f[n][n]},numeric.transpose=function(t){var e,r,n,a,i,o=t.length,s=t[0].length,u=Array(s);for(r=0;r<s;r++)u[r]=Array(o);for(e=o-1;e>=1;e-=2){for(a=t[e],n=t[e-1],r=s-1;r>=1;--r)i=u[r],i[e]=a[r],i[e-1]=n[r],--r,i=u[r],i[e]=a[r],i[e-1]=n[r];0===r&&(i=u[0],i[e]=a[0],i[e-1]=n[0])}if(0===e){for(n=t[0],r=s-1;r>=1;--r)u[r][0]=n[r],--r,u[r][0]=n[r];0===r&&(u[0][0]=n[0])}return u},numeric.negtranspose=function(t){var e,r,n,a,i,o=t.length,s=t[0].length,u=Array(s);for(r=0;r<s;r++)u[r]=Array(o);for(e=o-1;e>=1;e-=2){for(a=t[e],n=t[e-1],r=s-1;r>=1;--r)i=u[r],i[e]=-a[r],i[e-1]=-n[r],--r,i=u[r],i[e]=-a[r],i[e-1]=-n[r];0===r&&(i=u[0],i[e]=-a[0],i[e-1]=-n[0])}if(0===e){for(n=t[0],r=s-1;r>=1;--r)u[r][0]=-n[r],--r,u[r][0]=-n[r];0===r&&(u[0][0]=-n[0])}return u},numeric._random=function t(e,r){var n,a,i=e[r],o=Array(i);if(r===e.length-1){for(a=Math.random,n=i-1;n>=1;n-=2)o[n]=a(),o[n-1]=a();return 0===n&&(o[0]=a()),o}for(n=i-1;n>=0;n--)o[n]=t(e,r+1);return o},numeric.random=function(t){return numeric._random(t,0)},numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))},numeric.linspace=function(t,e,r){if(void 0===r&&(r=Math.max(Math.round(e-t)+1,1)),r<2)return 1===r?[t]:[];var n,a=Array(r);for(r--,n=r;n>=0;n--)a[n]=(n*e+(r-n)*t)/r;return a},numeric.getBlock=function(t,e,r){function n(t,i){var o,s=e[i],u=r[i]-s,c=Array(u);if(i===a.length-1){for(o=u;o>=0;o--)c[o]=t[o+s];return c}for(o=u;o>=0;o--)c[o]=n(t[o+s],i+1);return c}var a=numeric.dim(t);return n(t,0)},numeric.setBlock=function(t,e,r,n){function a(t,n,o){var s,u=e[o],c=r[o]-u;if(o===i.length-1)for(s=c;s>=0;s--)t[s+u]=n[s];for(s=c;s>=0;s--)a(t[s+u],n[s],o+1)}var i=numeric.dim(t);return a(t,n,0),t},numeric.getRange=function(t,e,r){var n,a,i,o,s=e.length,u=r.length,c=Array(s);for(n=s-1;-1!==n;--n)for(c[n]=Array(u),i=c[n],o=t[e[n]],a=u-1;-1!==a;--a)i[a]=o[r[a]];return c},numeric.blockMatrix=function(t){var e=numeric.dim(t);if(e.length<4)return numeric.blockMatrix([t]);var r,n,a,i,o,s=e[0],u=e[1];for(r=0,n=0,a=0;a<s;++a)r+=t[a][0].length;for(i=0;i<u;++i)n+=t[0][i][0].length;var c=Array(r);for(a=0;a<r;++a)c[a]=Array(n);var l,h,f,d,m,p=0;for(a=0;a<s;++a){for(l=n,i=u-1;-1!==i;--i)for(o=t[a][i],l-=o[0].length,f=o.length-1;-1!==f;--f)for(m=o[f],h=c[p+f],d=m.length-1;-1!==d;--d)h[l+d]=m[d];p+=t[a][0].length}return c},numeric.tensor=function(t,e){if("number"==typeof t||"number"==typeof e)return numeric.mul(t,e);var r=numeric.dim(t),n=numeric.dim(e);if(1!==r.length||1!==n.length)throw new Error("numeric: tensor product is only defined for vectors");var a,i,o,s,u=r[0],c=n[0],l=Array(u);for(i=u-1;i>=0;i--){for(a=Array(c),s=t[i],o=c-1;o>=3;--o)a[o]=s*e[o],--o,a[o]=s*e[o],--o,a[o]=s*e[o],--o,a[o]=s*e[o];for(;o>=0;)a[o]=s*e[o],--o;l[i]=a}return l},numeric.T=function(t,e){this.x=t,this.y=e},numeric.t=function(t,e){return new numeric.T(t,e)},numeric.Tbinop=function(t,e,r,n,a){numeric.indexOf;if("string"!=typeof a){var i;a=""
;for(i in numeric)numeric.hasOwnProperty(i)&&(t.indexOf(i)>=0||e.indexOf(i)>=0||r.indexOf(i)>=0||n.indexOf(i)>=0)&&i.length>1&&(a+="var "+i+" = numeric."+i+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+a+"\nif(x.y) {  if(y.y) {    return new numeric.T("+n+");\n  }\n  return new numeric.T("+r+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+t+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var t=numeric.mul,e=numeric.div;if(this.y){var r=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(e(this.x,r),e(numeric.neg(this.y),r))}return new T(e(1,this.x))},numeric.T.prototype.div=function(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,e=this.x,r=this.y;return r?new numeric.T(t(e),t(r)):new numeric.T(t(e))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,e=this.x,r=this.y;return r?new numeric.T(t(e),numeric.negtranspose(r)):new numeric.T(t(e))},numeric.Tunop=function(t,e,r){return"string"!=typeof r&&(r=""),Function("var x = this;\n"+r+"\nif(x.y) {  "+e+";\n}\n"+t+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var t=this;if(void 0===t.y)return new numeric.T(numeric.inv(t.x));var e,r,n,a,i,o,s,u,c,l,h,e,r,n,f,d,m,p,v,g,M,b=t.x.length,y=numeric.identity(b),x=numeric.rep([b,b],0),S=numeric.clone(t.x),w=numeric.clone(t.y);for(e=0;e<b;e++){for(m=S[e][e],p=w[e][e],f=m*m+p*p,n=e,r=e+1;r<b;r++)m=S[r][e],p=w[r][e],(d=m*m+p*p)>f&&(n=r,f=d);for(n!==e&&(M=S[e],S[e]=S[n],S[n]=M,M=w[e],w[e]=w[n],w[n]=M,M=y[e],y[e]=y[n],y[n]=M,M=x[e],x[e]=x[n],x[n]=M),a=S[e],i=w[e],u=y[e],c=x[e],m=a[e],p=i[e],r=e+1;r<b;r++)v=a[r],g=i[r],a[r]=(v*m+g*p)/f,i[r]=(g*m-v*p)/f;for(r=0;r<b;r++)v=u[r],g=c[r],u[r]=(v*m+g*p)/f,c[r]=(g*m-v*p)/f;for(r=e+1;r<b;r++){for(o=S[r],s=w[r],l=y[r],h=x[r],m=o[e],p=s[e],n=e+1;n<b;n++)v=a[n],g=i[n],o[n]-=v*m-g*p,s[n]-=g*m+v*p;for(n=0;n<b;n++)v=u[n],g=c[n],l[n]-=v*m-g*p,h[n]-=g*m+v*p}}for(e=b-1;e>0;e--)for(u=y[e],c=x[e],r=e-1;r>=0;r--)for(l=y[r],h=x[r],m=S[r][e],p=w[r][e],n=b-1;n>=0;n--)v=u[n],g=c[n],l[n]-=m*v-p*g,h[n]-=m*g+p*v;return new numeric.T(y,x)},numeric.T.prototype.get=function(t){var e,r=this.x,n=this.y,a=0,i=t.length;if(n){for(;a<i;)e=t[a],r=r[e],n=n[e],a++;return new numeric.T(r,n)}for(;a<i;)e=t[a],r=r[e],a++;return new numeric.T(r)},numeric.T.prototype.set=function(t,e){var r,n=this.x,a=this.y,i=0,o=t.length,s=e.x,u=e.y;if(0===o)return u?this.y=u:a&&(this.y=void 0),this.x=n,this;if(u){for(a||(a=numeric.rep(numeric.dim(n),0),this.y=a);i<o-1;)r=t[i],n=n[r],a=a[r],i++;return r=t[i],n[r]=s,a[r]=u,this}if(a){for(;i<o-1;)r=t[i],n=n[r],a=a[r],i++;return r=t[i],n[r]=s,s instanceof Array?a[r]=numeric.rep(numeric.dim(s),0):a[r]=0,this}for(;i<o-1;)r=t[i],n=n[r],i++;return r=t[i],n[r]=s,this},numeric.T.prototype.getRows=function(t,e){var r,n,a=e-t+1,i=Array(a),o=this.x,s=this.y;for(r=t;r<=e;r++)i[r-t]=o[r];if(s){for(n=Array(a),r=t;r<=e;r++)n[r-t]=s[r];return new numeric.T(i,n)}return new numeric.T(i)},numeric.T.prototype.setRows=function(t,e,r){var n,a=this.x,i=this.y,o=r.x,s=r.y;for(n=t;n<=e;n++)a[n]=o[n-t];if(s)for(i||(i=numeric.rep(numeric.dim(a),0),this.y=i),n=t;n<=e;n++)i[n]=s[n-t];else if(i)for(n=t;n<=e;n++)i[n]=numeric.rep([o[n-t].length],0);return this},numeric.T.prototype.getRow=function(t){var e=this.x,r=this.y;return r?new numeric.T(e[t],r[t]):new numeric.T(e[t])},numeric.T.prototype.setRow=function(t,e){var r=this.x,n=this.y,a=e.x,i=e.y;return r[t]=a,i?(n||(n=numeric.rep(numeric.dim(r),0),this.y=n),n[t]=i):n&&(n=numeric.rep([a.length],0)),this},numeric.T.prototype.getBlock=function(t,e){var r=this.x,n=this.y,a=numeric.getBlock;return n?new numeric.T(a(r,t,e),a(n,t,e)):new numeric.T(a(r,t,e))},numeric.T.prototype.setBlock=function(t,e,r){r instanceof numeric.T||(r=new numeric.T(r));var n=this.x,a=this.y,i=numeric.setBlock,o=r.x,s=r.y;if(s)return a||(this.y=numeric.rep(numeric.dim(this),0),a=this.y),i(n,t,e,o),i(a,t,e,s),this;i(n,t,e,o),a&&i(a,t,e,numeric.rep(numeric.dim(o),0))},numeric.T.rep=function(t,e){var r=numeric.T;e instanceof r||(e=new r(e));var n=e.x,a=e.y,i=numeric.rep;return a?new r(i(t,n),i(t,a)):new r(i(t,n))},numeric.T.diag=function(t){t instanceof numeric.T||(t=new numeric.T(t));var e=t.x,r=t.y,n=numeric.diag;return r?new numeric.T(n(e),n(r)):new numeric.T(n(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))},numeric.T.prototype.getDiag=function(){var t=numeric,e=this.x,r=this.y;return r?new t.T(t.getDiag(e),t.getDiag(r)):new t.T(t.getDiag(e))},numeric.house=function(t){var e=numeric.clone(t),r=t[0]>=0?1:-1,n=r*numeric.norm2(t);e[0]+=n;var a=numeric.norm2(e);if(0===a)throw new Error("eig: internal error");return numeric.div(e,a)},numeric.toUpperHessenberg=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r,n,a,i,o,s,u,c,l,h,f=e[0],d=numeric.clone(t),m=numeric.identity(f);for(n=0;n<f-2;n++){for(i=Array(f-n-1),r=n+1;r<f;r++)i[r-n-1]=d[r][n];if(numeric.norm2(i)>0){for(o=numeric.house(i),s=numeric.getBlock(d,[n+1,n],[f-1,f-1]),u=numeric.tensor(o,numeric.dot(o,s)),r=n+1;r<f;r++)for(c=d[r],l=u[r-n-1],a=n;a<f;a++)c[a]-=2*l[a-n];for(s=numeric.getBlock(d,[0,n+1],[f-1,f-1]),u=numeric.tensor(numeric.dot(s,o),o),r=0;r<f;r++)for(c=d[r],l=u[r],a=n+1;a<f;a++)c[a]-=2*l[a-n-1];for(s=Array(f-n-1),r=n+1;r<f;r++)s[r-n-1]=m[r];for(u=numeric.tensor(o,numeric.dot(o,s)),r=n+1;r<f;r++)for(h=m[r],l=u[r-n-1],a=0;a<f;a++)h[a]-=2*l[a]}}return{H:d,Q:m}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(t,e){void 0===e&&(e=1e4),t=numeric.clone(t);var r,n,a,i,o,s,u,c,l,h,f,d,m,p,v,g,M,b,y=(numeric.clone(t),numeric.dim(t)),x=y[0],S=numeric.identity(x);if(x<3)return{Q:S,B:[[0,x-1]]};var w=numeric.epsilon;for(b=0;b<e;b++){for(g=0;g<x-1;g++)if(Math.abs(t[g+1][g])<w*(Math.abs(t[g][g])+Math.abs(t[g+1][g+1]))){var D=numeric.QRFrancis(numeric.getBlock(t,[0,0],[g,g]),e),I=numeric.QRFrancis(numeric.getBlock(t,[g+1,g+1],[x-1,x-1]),e);for(d=Array(g+1),v=0;v<=g;v++)d[v]=S[v];for(m=numeric.dot(D.Q,d),v=0;v<=g;v++)S[v]=m[v];for(d=Array(x-g-1),v=g+1;v<x;v++)d[v-g-1]=S[v];for(m=numeric.dot(I.Q,d),v=g+1;v<x;v++)S[v]=m[v-g-1];return{Q:S,B:D.B.concat(numeric.add(I.B,g+1))}}if(a=t[x-2][x-2],i=t[x-2][x-1],o=t[x-1][x-2],s=t[x-1][x-1],c=a+s,u=a*s-i*o,l=numeric.getBlock(t,[0,0],[2,2]),c*c>=4*u){var F,_;F=.5*(c+Math.sqrt(c*c-4*u)),_=.5*(c-Math.sqrt(c*c-4*u)),l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,F+_)),numeric.diag(numeric.rep([3],F*_)))}else l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,c)),numeric.diag(numeric.rep([3],u)));for(r=[l[0][0],l[1][0],l[2][0]],n=numeric.house(r),d=[t[0],t[1],t[2]],m=numeric.tensor(n,numeric.dot(n,d)),v=0;v<3;v++)for(f=t[v],p=m[v],M=0;M<x;M++)f[M]-=2*p[M];for(d=numeric.getBlock(t,[0,0],[x-1,2]),m=numeric.tensor(numeric.dot(d,n),n),v=0;v<x;v++)for(f=t[v],p=m[v],M=0;M<3;M++)f[M]-=2*p[M];for(d=[S[0],S[1],S[2]],m=numeric.tensor(n,numeric.dot(n,d)),v=0;v<3;v++)for(h=S[v],p=m[v],M=0;M<x;M++)h[M]-=2*p[M];var C;for(g=0;g<x-2;g++){for(M=g;M<=g+1;M++)if(Math.abs(t[M+1][M])<w*(Math.abs(t[M][M])+Math.abs(t[M+1][M+1]))){var D=numeric.QRFrancis(numeric.getBlock(t,[0,0],[M,M]),e),I=numeric.QRFrancis(numeric.getBlock(t,[M+1,M+1],[x-1,x-1]),e);for(d=Array(M+1),v=0;v<=M;v++)d[v]=S[v];for(m=numeric.dot(D.Q,d),v=0;v<=M;v++)S[v]=m[v];for(d=Array(x-M-1),v=M+1;v<x;v++)d[v-M-1]=S[v];for(m=numeric.dot(I.Q,d),v=M+1;v<x;v++)S[v]=m[v-M-1];return{Q:S,B:D.B.concat(numeric.add(I.B,M+1))}}for(C=Math.min(x-1,g+3),r=Array(C-g),v=g+1;v<=C;v++)r[v-g-1]=t[v][g];for(n=numeric.house(r),d=numeric.getBlock(t,[g+1,g],[C,x-1]),m=numeric.tensor(n,numeric.dot(n,d)),v=g+1;v<=C;v++)for(f=t[v],p=m[v-g-1],M=g;M<x;M++)f[M]-=2*p[M-g];for(d=numeric.getBlock(t,[0,g+1],[x-1,C]),m=numeric.tensor(numeric.dot(d,n),n),v=0;v<x;v++)for(f=t[v],p=m[v],M=g+1;M<=C;M++)f[M]-=2*p[M-g-1];for(d=Array(C-g),v=g+1;v<=C;v++)d[v-g-1]=S[v];for(m=numeric.tensor(n,numeric.dot(n,d)),v=g+1;v<=C;v++)for(h=S[v],p=m[v-g-1],M=0;M<x;M++)h[M]-=2*p[M]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(t,e){var r,n,a,i,o,s,u,c,l,h,f,d,m,p,v,g,M,b=numeric.toUpperHessenberg(t),y=numeric.QRFrancis(b.H,e),x=numeric.T,S=t.length,w=y.B,D=numeric.dot(y.Q,numeric.dot(b.H,numeric.transpose(y.Q))),I=new x(numeric.dot(y.Q,b.Q)),F=w.length,_=Math.sqrt;for(n=0;n<F;n++)if((r=w[n][0])===w[n][1]);else{if(i=r+1,o=D[r][r],s=D[r][i],u=D[i][r],c=D[i][i],0===s&&0===u)continue;l=-o-c,h=o*c-s*u,f=l*l-4*h,f>=0?(d=l<0?-.5*(l-_(f)):-.5*(l+_(f)),g=(o-d)*(o-d)+s*s,M=u*u+(c-d)*(c-d),g>M?(g=_(g),p=(o-d)/g,v=s/g):(M=_(M),p=u/M,v=(c-d)/M),a=new x([[v,-p],[p,v]]),I.setRows(r,i,a.dot(I.getRows(r,i)))):(d=-.5*l,m=.5*_(-f),g=(o-d)*(o-d)+s*s,M=u*u+(c-d)*(c-d),g>M?(g=_(g+m*m),p=(o-d)/g,v=s/g,d=0,m/=g):(M=_(M+m*m),p=u/M,v=(c-d)/M,d=m/M,m=0),a=new x([[v,-p],[p,v]],[[d,m],[m,-d]]),I.setRows(r,i,a.dot(I.getRows(r,i))))}var C=I.dot(t).dot(I.transjugate()),S=t.length,A=numeric.T.identity(S);for(i=0;i<S;i++)if(i>0)for(n=i-1;n>=0;n--){var k=C.get([n,n]),P=C.get([i,i]);numeric.neq(k.x,P.x)||numeric.neq(k.y,P.y)?(d=C.getRow(n).getBlock([n],[i-1]),m=A.getRow(i).getBlock([n],[i-1]),A.set([i,n],C.get([n,i]).neg().sub(d.dot(m)).div(k.sub(P)))):A.setRow(i,A.getRow(n))}for(i=0;i<S;i++)d=A.getRow(i),A.setRow(i,d.div(d.norm2()));return A=A.transpose(),A=I.transjugate().dot(A),{lambda:C.getDiag(),E:A}},numeric.ccsSparse=function(t){var e,r,n,a,i=t.length,o=[];for(n=i-1;-1!==n;--n){r=t[n];for(a in r){for(a=parseInt(a);a>=o.length;)o[o.length]=0;0!==r[a]&&o[a]++}}var e=o.length,s=Array(e+1);for(s[0]=0,n=0;n<e;++n)s[n+1]=s[n]+o[n];var u=Array(s[e]),c=Array(s[e]);for(n=i-1;-1!==n;--n){r=t[n];for(a in r)0!==r[a]&&(o[a]--,u[s[a]+o[a]]=n,c[s[a]+o[a]]=r[a])}return[s,u,c]},numeric.ccsFull=function(t){var e,r,n,a,i=t[0],o=t[1],s=t[2],u=numeric.ccsDim(t),c=u[0],l=u[1],h=numeric.rep([c,l],0);for(e=0;e<l;e++)for(n=i[e],a=i[e+1],r=n;r<a;++r)h[o[r]][e]=s[r];return h},numeric.ccsTSolve=function(t,e,r,n,a){function i(t){var e;if(0===r[t]){for(r[t]=1,e=o[t];e<o[t+1];++e)i(s[e]);a[h]=t,++h}}var o=t[0],s=t[1],u=t[2],c=o.length-1,l=Math.max,h=0;void 0===n&&(r=numeric.rep([c],0)),void 0===n&&(n=numeric.linspace(0,r.length-1)),void 0===a&&(a=[]);var f,d,m,p,v,g,M;for(f=n.length-1;-1!==f;--f)i(n[f]);for(a.length=h,f=a.length-1;-1!==f;--f)r[a[f]]=0;for(f=n.length-1;-1!==f;--f)d=n[f],r[d]=e[d];for(f=a.length-1;-1!==f;--f){for(d=a[f],m=o[d],p=l(o[d+1],m),v=m;v!==p;++v)if(s[v]===d){r[d]/=u[v];break}for(M=r[d],v=m;v!==p;++v)(g=s[v])!==d&&(r[g]-=M*u[v])}return r},numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS.prototype.dfs=function(t,e,r,n,a,i){var o,s,u,c=0,l=a.length,h=this.k,f=this.k1,d=this.j;if(0===n[t])for(n[t]=1,d[0]=t,h[0]=s=e[t],f[0]=u=e[t+1];;)if(s>=u){if(a[l]=d[c],0===c)return;++l,--c,s=h[c],u=f[c]}else o=i[r[s]],0===n[o]?(n[o]=1,h[c]=s,++c,d[c]=o,s=e[o],f[c]=u=e[o+1]):++s},numeric.ccsLPSolve=function(t,e,r,n,a,i,o){var s,u,c,l,h,f,d,m,p,v=t[0],g=t[1],M=t[2],b=(v.length,e[0]),y=e[1],x=e[2];for(u=b[a],c=b[a+1],n.length=0,s=u;s<c;++s)o.dfs(i[y[s]],v,g,r,n,i);for(s=n.length-1;-1!==s;--s)r[n[s]]=0;for(s=u;s!==c;++s)l=i[y[s]],r[l]=x[s];for(s=n.length-1;-1!==s;--s){for(l=n[s],h=v[l],f=v[l+1],d=h;d<f;++d)if(i[g[d]]===l){r[l]/=M[d];break}for(p=r[l],d=h;d<f;++d)(m=i[g[d]])!==l&&(r[m]-=p*M[d])}return r},numeric.ccsLUP1=function(t,e){var r,n,a,i,o,s,u,c=t[0].length-1,l=[numeric.rep([c+1],0),[],[]],h=[numeric.rep([c+1],0),[],[]],f=l[0],d=l[1],m=l[2],p=h[0],v=h[1],g=h[2],M=numeric.rep([c],0),b=numeric.rep([c],0),y=numeric.ccsLPSolve,x=(Math.max,Math.abs),S=numeric.linspace(0,c-1),w=numeric.linspace(0,c-1),D=new numeric.ccsDFS(c);for(void 0===e&&(e=1),r=0;r<c;++r){for(y(l,t,M,b,r,w,D),i=-1,o=-1,n=b.length-1;-1!==n;--n)(a=b[n])<=r||(s=x(M[a]))>i&&(o=a,i=s);for(x(M[r])<e*i&&(n=S[r],i=S[o],S[r]=i,w[i]=r,S[o]=n,w[n]=o,i=M[r],M[r]=M[o],M[o]=i),i=f[r],o=p[r],u=M[r],d[i]=S[r],m[i]=1,++i,n=b.length-1;-1!==n;--n)a=b[n],s=M[a],b[n]=0,M[a]=0,a<=r?(v[o]=a,g[o]=s,++o):(d[i]=S[a],m[i]=s/u,++i);f[r+1]=i,p[r+1]=o}for(n=d.length-1;-1!==n;--n)d[n]=w[d[n]];return{L:l,U:h,P:S,Pinv:w}},numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS0.prototype.dfs=function(t,e,r,n,a,i,o){var s,u,c,l=0,h=a.length,f=this.k,d=this.k1,m=this.j;if(0===n[t])for(n[t]=1,m[0]=t,f[0]=u=e[i[t]],d[0]=c=e[i[t]+1];;){if(isNaN(u))throw new Error("Ow!");if(u>=c){if(a[h]=i[m[l]],0===l)return;++h,--l,u=f[l],c=d[l]}else s=r[u],0===n[s]?(n[s]=1,f[l]=u,++l,m[l]=s,s=i[s],u=e[s],d[l]=c=e[s+1]):++u}},numeric.ccsLPSolve0=function(t,e,r,n,a,i,o,s){var u,c,l,h,f,d,m,p,v,g=t[0],M=t[1],b=t[2],y=(g.length,e[0]),x=e[1],S=e[2];for(c=y[a],l=y[a+1],n.length=0,u=c;u<l;++u)s.dfs(x[u],g,M,r,n,i,o);for(u=n.length-1;-1!==u;--u)h=n[u],r[o[h]]=0;for(u=c;u!==l;++u)h=x[u],r[h]=S[u];for(u=n.length-1;-1!==u;--u){for(h=n[u],p=o[h],f=g[h],d=g[h+1],m=f;m<d;++m)if(M[m]===p){r[p]/=b[m];break}for(v=r[p],m=f;m<d;++m)r[M[m]]-=v*b[m];r[p]=v}},numeric.ccsLUP0=function(t,e){var r,n,a,i,o,s,u,c=t[0].length-1,l=[numeric.rep([c+1],0),[],[]],h=[numeric.rep([c+1],0),[],[]],f=l[0],d=l[1],m=l[2],p=h[0],v=h[1],g=h[2],M=numeric.rep([c],0),b=numeric.rep([c],0),y=numeric.ccsLPSolve0,x=(Math.max,Math.abs),S=numeric.linspace(0,c-1),w=numeric.linspace(0,c-1),D=new numeric.ccsDFS0(c);for(void 0===e&&(e=1),r=0;r<c;++r){for(y(l,t,M,b,r,w,S,D),i=-1,o=-1,n=b.length-1;-1!==n;--n)(a=b[n])<=r||(s=x(M[S[a]]))>i&&(o=a,i=s);for(x(M[S[r]])<e*i&&(n=S[r],i=S[o],S[r]=i,w[i]=r,S[o]=n,w[n]=o),i=f[r],o=p[r],u=M[S[r]],d[i]=S[r],m[i]=1,++i,n=b.length-1;-1!==n;--n)a=b[n],s=M[S[a]],b[n]=0,M[S[a]]=0,a<=r?(v[o]=a,g[o]=s,++o):(d[i]=S[a],m[i]=s/u,++i);f[r+1]=i,p[r+1]=o}for(n=d.length-1;-1!==n;--n)d[n]=w[d[n]];return{L:l,U:h,P:S,Pinv:w}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]},numeric.ccsGetBlock=function(t,e,r){var n=numeric.ccsDim(t),a=n[0],i=n[1];void 0===e?e=numeric.linspace(0,a-1):"number"==typeof e&&(e=[e]),void 0===r?r=numeric.linspace(0,i-1):"number"==typeof r&&(r=[r]);var o,s,u,c,l,h=e.length,f=r.length,d=numeric.rep([i],0),m=[],p=[],v=[d,m,p],g=t[0],M=t[1],b=t[2],y=numeric.rep([a],0),x=0,S=numeric.rep([a],0);for(s=0;s<f;++s){c=r[s];var w=g[c],D=g[c+1];for(o=w;o<D;++o)u=M[o],S[u]=1,y[u]=b[o];for(o=0;o<h;++o)l=e[o],S[l]&&(m[x]=o,p[x]=y[e[o]],++x);for(o=w;o<D;++o)u=M[o],S[u]=0;d[s+1]=x}return v},numeric.ccsDot=function(t,e){var r,n,a,i,o,s,u,c,l,h,f,d=t[0],m=t[1],p=t[2],v=e[0],g=e[1],M=e[2],b=numeric.ccsDim(t),y=numeric.ccsDim(e),x=b[0],S=(b[1],y[1]),w=numeric.rep([x],0),D=numeric.rep([x],0),I=Array(x),F=numeric.rep([S],0),_=[],C=[],A=[F,_,C];for(a=0;a!==S;++a){for(i=v[a],o=v[a+1],l=0,n=i;n<o;++n)for(h=g[n],f=M[n],s=d[h],u=d[h+1],r=s;r<u;++r)c=m[r],0===D[c]&&(I[l]=c,D[c]=1,l+=1),w[c]=w[c]+p[r]*f;for(i=F[a],o=i+l,F[a+1]=o,n=l-1;-1!==n;--n)f=i+n,r=I[n],_[f]=r,C[f]=w[r],D[r]=0,w[r]=0;F[a+1]=F[a]+l}return A},numeric.ccsLUPSolve=function(t,e){var r=t.L,n=t.U,a=(t.P,e[0]),i=!1;"object"!=typeof a&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],a=e[0],i=!0);var o,s,u,c,l,h,f=e[1],d=e[2],m=r[0].length-1,p=a.length-1,v=numeric.rep([m],0),g=Array(m),M=numeric.rep([m],0),b=Array(m),y=numeric.rep([p+1],0),x=[],S=[],w=numeric.ccsTSolve,D=0;for(o=0;o<p;++o){for(l=0,u=a[o],c=a[o+1],s=u;s<c;++s)h=t.Pinv[f[s]],b[l]=h,M[h]=d[s],++l;for(b.length=l,w(r,M,v,b,g),s=b.length-1;-1!==s;--s)M[b[s]]=0;if(w(n,v,M,g,b),i)return M;for(s=g.length-1;-1!==s;--s)v[g[s]]=0;for(s=b.length-1;-1!==s;--s)h=b[s],x[D]=h,S[D]=M[h],M[h]=0,++D;y[o+1]=D}return[y,x,S]},numeric.ccsbinop=function(t,e){return void 0===e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+t+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(t){var e,r=t[0],n=t[1],a=t[2],i=numeric.sup(n)+1,o=r.length,s=numeric.rep([i],0),u=Array(o),c=Array(o),l=numeric.rep([i],0);for(e=0;e<o;++e)l[n[e]]++;for(e=0;e<i;++e)s[e+1]=s[e]+l[e];var h,f,d=s.slice(0);for(e=0;e<o;++e)f=n[e],h=d[f],u[h]=r[e],c[h]=a[e],d[f]=d[f]+1;return[s,u,c]},numeric.ccsGather=function(t){var e,r,n,a,i,o=t[0],s=t[1],u=t[2],c=o.length-1,l=s.length,h=Array(l),f=Array(l),d=Array(l);for(i=0,e=0;e<c;++e)for(n=o[e],a=o[e+1],r=n;r!==a;++r)f[i]=e,h[i]=s[r],d[i]=u[r],++i;return[h,f,d]},numeric.sdim=function t(e,r,n){if(void 0===r&&(r=[]),"object"!=typeof e)return r;void 0===n&&(n=0),n in r||(r[n]=0),e.length>r[n]&&(r[n]=e.length);var a;for(a in e)e.hasOwnProperty(a)&&t(e[a],r,n+1);return r},numeric.sclone=function t(e,r,n){void 0===r&&(r=0),void 0===n&&(n=numeric.sdim(e).length);var a,i=Array(e.length);if(r===n-1){for(a in e)e.hasOwnProperty(a)&&(i[a]=e[a]);return i}for(a in e)e.hasOwnProperty(a)&&(i[a]=t(e[a],r+1,n));return i},numeric.sdiag=function(t){var e,r,n=t.length,a=Array(n);for(e=n-1;e>=1;e-=2)r=e-1,a[e]=[],a[e][e]=t[e],a[r]=[],a[r][r]=t[r];return 0===e&&(a[0]=[],a[0][0]=t[e]),a},numeric.sidentity=function(t){return numeric.sdiag(numeric.rep([t],1))},numeric.stranspose=function(t){var e,r,n,a=[];t.length;for(e in t)if(t.hasOwnProperty(e)){n=t[e];for(r in n)n.hasOwnProperty(r)&&("object"!=typeof a[r]&&(a[r]=[]),a[r][e]=n[r])}return a},numeric.sLUP=function(t,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(t,e){var r,n,a,i,o,s,u,c=t.length,l=(e.length,numeric.stranspose(e)),h=l.length,f=Array(c);for(a=c-1;a>=0;a--){for(u=[],r=t[a],o=h-1;o>=0;o--){s=0,n=l[o];for(i in r)r.hasOwnProperty(i)&&i in n&&(s+=r[i]*n[i]);s&&(u[o]=s)}f[a]=u}return f},numeric.sdotMV=function(t,e){var r,n,a,i,o=t.length,s=Array(o);for(n=o-1;n>=0;n--){r=t[n],i=0;for(a in r)r.hasOwnProperty(a)&&e[a]&&(i+=r[a]*e[a]);i&&(s[n]=i)}return s},numeric.sdotVM=function(t,e){var r,n,a,i,o=[];for(r in t)if(t.hasOwnProperty(r)){a=e[r],i=t[r];for(n in a)a.hasOwnProperty(n)&&(o[n]||(o[n]=0),o[n]+=i*a[n])}return o},numeric.sdotVV=function(t,e){var r,n=0;for(r in t)t[r]&&e[r]&&(n+=t[r]*e[r]);return n},numeric.sdot=function(t,e){var r=numeric.sdim(t).length,n=numeric.sdim(e).length;switch(1e3*r+n){case 0:return t*e;case 1001:return numeric.sdotVV(t,e);case 2001:return numeric.sdotMV(t,e);case 1002:return numeric.sdotVM(t,e);case 2002:return numeric.sdotMM(t,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+n)}},numeric.sscatter=function(t){var e,r,n,a,i=t[0].length,o=t.length,s=[];for(r=i-1;r>=0;--r)if(t[o-1][r]){for(a=s,n=0;n<o-2;n++)e=t[n][r],a[e]||(a[e]=[]),a=a[e];a[t[n][r]]=t[n+1][r]}return s},numeric.sgather=function t(e,r,n){void 0===r&&(r=[]),void 0===n&&(n=[]);var a,i,o;a=n.length;for(i in e)if(e.hasOwnProperty(i))if(n[a]=parseInt(i),"number"==typeof(o=e[i])){if(o){if(0===r.length)for(i=a+1;i>=0;--i)r[i]=[];for(i=a;i>=0;--i)r[i].push(n[i]);r[a+1].push(o)}}else t(o,r,n);return n.length>a&&n.pop(),r},numeric.cLU=function(t){var e,r,n,a,i,o,s=t[0],u=t[1],c=t[2],l=s.length,h=0;for(e=0;e<l;e++)s[e]>h&&(h=s[e]);h++;var f,d,m,p=Array(h),v=Array(h),g=numeric.rep([h],1/0),M=numeric.rep([h],-1/0);for(n=0;n<l;n++)e=s[n],r=u[n],r<g[e]&&(g[e]=r),r>M[e]&&(M[e]=r);for(e=0;e<h-1;e++)M[e]>M[e+1]&&(M[e+1]=M[e]);for(e=h-1;e>=1;e--)g[e]<g[e-1]&&(g[e-1]=g[e]);var b=0,y=0;for(e=0;e<h;e++)v[e]=numeric.rep([M[e]-g[e]+1],0),p[e]=numeric.rep([e-g[e]],0),b+=e-g[e]+1,y+=M[e]-e+1;for(n=0;n<l;n++)e=s[n],v[e][u[n]-g[e]]=c[n];for(e=0;e<h-1;e++)for(a=e-g[e],f=v[e],r=e+1;g[r]<=e&&r<h;r++)if(i=e-g[r],o=M[e]-e,d=v[r],m=d[i]/f[a]){for(n=1;n<=o;n++)d[n+i]-=m*f[n+a];p[r][e-g[r]]=m}var l,x,S,f=[],d=[],w=[],D=[],I=[],F=[];for(l=0,x=0,e=0;e<h;e++){for(a=g[e],i=M[e],S=v[e],r=e;r<=i;r++)S[r-a]&&(f[l]=e,d[l]=r,w[l]=S[r-a],l++);for(S=p[e],r=a;r<e;r++)S[r-a]&&(D[x]=e,I[x]=r,F[x]=S[r-a],x++);D[x]=e,I[x]=e,F[x]=1,x++}return{U:[f,d,w],L:[D,I,F]}},numeric.cLUsolve=function(t,e){var r,n,a=t.L,i=t.U,o=numeric.clone(e),s=a[0],u=a[1],c=a[2],l=i[0],h=i[1],f=i[2],d=l.length,m=(s.length,o.length);for(n=0,r=0;r<m;r++){for(;u[n]<r;)o[r]-=c[n]*o[u[n]],n++;n++}for(n=d-1,r=m-1;r>=0;r--){for(;h[n]>r;)o[r]-=f[n]*o[h[n]],n--;o[r]/=f[n],n--}return o},numeric.cgrid=function(t,e){"number"==typeof t&&(t=[t,t]);var r,n,a,i=numeric.rep(t,-1);if("function"!=typeof e)switch(e){case"L":e=function(e,r){return e>=t[0]/2||r<t[1]/2};break;default:e=function(t,e){return!0}}for(a=0,r=1;r<t[0]-1;r++)for(n=1;n<t[1]-1;n++)e(r,n)&&(i[r][n]=a,a++);return i},numeric.cdelsq=function(t){var e,r,n,a,i,o=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(t),u=s[0],c=s[1],l=[],h=[],f=[];for(e=1;e<u-1;e++)for(r=1;r<c-1;r++)if(!(t[e][r]<0)){for(n=0;n<4;n++)a=e+o[n][0],i=r+o[n][1],t[a][i]<0||(l.push(t[e][r]),h.push(t[a][i]),f.push(-1));l.push(t[e][r]),h.push(t[e][r]),f.push(4)}return[l,h,f]},numeric.cdotMV=function(t,e){var r,n,a,i=t[0],o=t[1],s=t[2],u=i.length;for(a=0,n=0;n<u;n++)i[n]>a&&(a=i[n]);for(a++,r=numeric.rep([a],0),n=0;n<u;n++)r[i[n]]+=s[n]*e[o[n]];return r},numeric.Spline=function(t,e,r,n,a){this.x=t,this.yl=e,this.yr=r,this.kl=n,this.kr=a},numeric.Spline.prototype._at=function(t,e){var t,r,n,a,i=this.x,o=this.yl,s=this.yr,u=this.kl,c=this.kr,l=numeric.add,h=numeric.sub,f=numeric.mul;r=h(f(u[e],i[e+1]-i[e]),h(s[e+1],o[e])),n=l(f(c[e+1],i[e]-i[e+1]),h(s[e+1],o[e])),a=(t-i[e])/(i[e+1]-i[e]);var d=a*(1-a);return l(l(l(f(1-a,o[e]),f(a,s[e+1])),f(r,d*(1-a))),f(n,d*a))},numeric.Spline.prototype.at=function(t){if("number"==typeof t){var e,r,n,a=this.x,i=a.length,o=Math.floor;for(e=0,r=i-1;r-e>1;)n=o((e+r)/2),a[n]<=t?e=n:r=n;return this._at(t,e)}var s,i=t.length,u=Array(i);for(s=i-1;-1!==s;--s)u[s]=this.at(t[s]);return u},numeric.Spline.prototype.diff=function(){var t,e,r,n=this.x,a=this.yl,i=this.yr,o=this.kl,s=this.kr,u=a.length,c=o,l=s,h=Array(u),f=Array(u),d=numeric.add,m=numeric.mul,p=numeric.div,v=numeric.sub;for(t=u-1;-1!==t;--t)e=n[t+1]-n[t],r=v(i[t+1],a[t]),h[t]=p(d(m(r,6),m(o[t],-4*e),m(s[t+1],-2*e)),e*e),f[t+1]=p(d(m(r,-6),m(o[t],2*e),m(s[t+1],4*e)),e*e);return new numeric.Spline(n,c,l,h,f)},numeric.Spline.prototype.roots=function(){var t=[],e=this.x,r=this.yl,n=this.yr,a=this.kl,i=this.kr;"number"==typeof r[0]&&(r=[r],n=[n],a=[a],i=[i]);var o,s,u,c,l,h,f,d,m,p,v,g,M,b,y,x,S,w,D,I,F,_,C,A=r.length,k=e.length-1,t=Array(A),P=Math.sqrt;for(o=0;o!==A;++o){for(c=r[o],l=n[o],h=a[o],f=i[o],d=[],s=0;s!==k;s++){for(s>0&&l[s]*c[s]<0&&d.push(e[s]),x=e[s+1]-e[s],e[s],v=c[s],g=l[s+1],m=h[s]/x,p=f[s+1]/x,y=function(t){return t*t}(m-p+3*(v-g))+12*p*v,M=p+3*v+2*m-3*g,b=3*(p+m+2*(v-g)),y<=0?(w=M/b,S=w>e[s]&&w<e[s+1]?[e[s],w,e[s+1]]:[e[s],e[s+1]]):(w=(M-P(y))/b,D=(M+P(y))/b,S=[e[s]],w>e[s]&&w<e[s+1]&&S.push(w),D>e[s]&&D<e[s+1]&&S.push(D),S.push(e[s+1])),F=S[0],w=this._at(F,s),u=0;u<S.length-1;u++)if(_=S[u+1],D=this._at(_,s),0!==w)if(0===D||w*D>0)F=_,w=D;else{for(var j=0;;){if((C=(w*_-D*F)/(w-D))<=F||C>=_)break;if((I=this._at(C,s))*D>0)_=C,D=I,-1===j&&(w*=.5),j=-1;else{if(!(I*w>0))break;F=C,w=I,1===j&&(D*=.5),j=1}}d.push(C),F=S[u+1],w=this._at(F,s)}else d.push(F),F=_,w=D;0===D&&d.push(_)}t[o]=d}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(t,e,r,n){var a,i=t.length,o=[],s=[],u=[],c=numeric.sub,l=numeric.mul,h=numeric.add;for(a=i-2;a>=0;a--)s[a]=t[a+1]-t[a],u[a]=c(e[a+1],e[a]);"string"!=typeof r&&"string"!=typeof n||(r=n="periodic");var f=[[],[],[]];switch(typeof r){case"undefined":o[0]=l(3/(s[0]*s[0]),u[0]),f[0].push(0,0),f[1].push(0,1),f[2].push(2/s[0],1/s[0]);break;case"string":o[0]=h(l(3/(s[i-2]*s[i-2]),u[i-2]),l(3/(s[0]*s[0]),u[0])),f[0].push(0,0,0),f[1].push(i-2,0,1),f[2].push(1/s[i-2],2/s[i-2]+2/s[0],1/s[0]);break;default:o[0]=r,f[0].push(0),f[1].push(0),f[2].push(1)}for(a=1;a<i-1;a++)o[a]=h(l(3/(s[a-1]*s[a-1]),u[a-1]),l(3/(s[a]*s[a]),u[a])),f[0].push(a,a,a),f[1].push(a-1,a,a+1),f[2].push(1/s[a-1],2/s[a-1]+2/s[a],1/s[a]);switch(typeof n){case"undefined":o[i-1]=l(3/(s[i-2]*s[i-2]),u[i-2]),f[0].push(i-1,i-1),f[1].push(i-2,i-1),f[2].push(1/s[i-2],2/s[i-2]);break;case"string":f[1][f[1].length-1]=0;break;default:o[i-1]=n,f[0].push(i-1),f[1].push(i-1),f[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var d=Array(o.length);if("string"==typeof r)for(a=d.length-1;-1!==a;--a)d[a]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(f)),o[a]),d[a][i-1]=d[a][0];else for(a=d.length-1;-1!==a;--a)d[a]=numeric.cLUsolve(numeric.cLU(f),o[a]);return d="number"==typeof e[0]?d[0]:numeric.transpose(d),new numeric.Spline(t,e,e,d,d)},numeric.fftpow2=function t(e,r){var n=e.length;if(1!==n){var a,i,o=Math.cos,s=Math.sin,u=Array(n/2),c=Array(n/2),l=Array(n/2),h=Array(n/2);for(i=n/2,a=n-1;-1!==a;--a)--i,l[i]=e[a],h[i]=r[a],--a,u[i]=e[a],c[i]=r[a];t(u,c),t(l,h),i=n/2;var f,d,m,p=-6.283185307179586/n;for(a=n-1;-1!==a;--a)--i,-1===i&&(i=n/2-1),f=p*a,d=o(f),m=s(f),e[a]=u[i]+d*l[i]-m*h[i],r[a]=c[i]+d*h[i]+m*l[i]}},numeric._ifftpow2=function t(e,r){var n=e.length;if(1!==n){var a,i,o=Math.cos,s=Math.sin,u=Array(n/2),c=Array(n/2),l=Array(n/2),h=Array(n/2);for(i=n/2,a=n-1;-1!==a;--a)--i,l[i]=e[a],h[i]=r[a],--a,u[i]=e[a],c[i]=r[a];t(u,c),t(l,h),i=n/2;var f,d,m,p=6.283185307179586/n;for(a=n-1;-1!==a;--a)--i,-1===i&&(i=n/2-1),f=p*a,d=o(f),m=s(f),e[a]=u[i]+d*l[i]-m*h[i],r[a]=c[i]+d*h[i]+m*l[i]}},numeric.ifftpow2=function(t,e){numeric._ifftpow2(t,e),numeric.diveq(t,t.length),numeric.diveq(e,e.length)},numeric.convpow2=function(t,e,r,n){numeric.fftpow2(t,e),numeric.fftpow2(r,n);var a,i,o,s,u,c=t.length;for(a=c-1;-1!==a;--a)i=t[a],s=e[a],o=r[a],u=n[a],t[a]=i*o-s*u,e[a]=i*u+s*o;numeric.ifftpow2(t,e)},numeric.T.prototype.fft=function(){var t,e,r=this.x,n=this.y,a=r.length,i=Math.log,o=i(2),s=Math.ceil(i(2*a-1)/o),u=Math.pow(2,s),c=numeric.rep([u],0),l=numeric.rep([u],0),h=Math.cos,f=Math.sin,d=-3.141592653589793/a,m=numeric.rep([u],0),p=numeric.rep([u],0);Math.floor(a/2);for(t=0;t<a;t++)m[t]=r[t];if(void 0!==n)for(t=0;t<a;t++)p[t]=n[t];for(c[0]=1,t=1;t<=u/2;t++)e=d*t*t,c[t]=h(e),l[t]=f(e),c[u-t]=h(e),l[u-t]=f(e);var v=new numeric.T(m,p),g=new numeric.T(c,l);return v=v.mul(g),numeric.convpow2(v.x,v.y,numeric.clone(g.x),numeric.neg(g.y)),v=v.mul(g),v.x.length=a,v.y.length=a,v},numeric.T.prototype.ifft=function(){var t,e,r=this.x,n=this.y,a=r.length,i=Math.log,o=i(2),s=Math.ceil(i(2*a-1)/o),u=Math.pow(2,s),c=numeric.rep([u],0),l=numeric.rep([u],0),h=Math.cos,f=Math.sin,d=3.141592653589793/a,m=numeric.rep([u],0),p=numeric.rep([u],0);Math.floor(a/2);for(t=0;t<a;t++)m[t]=r[t];if(void 0!==n)for(t=0;t<a;t++)p[t]=n[t];for(c[0]=1,t=1;t<=u/2;t++)e=d*t*t,c[t]=h(e),l[t]=f(e),c[u-t]=h(e),l[u-t]=f(e);var v=new numeric.T(m,p),g=new numeric.T(c,l);return v=v.mul(g),numeric.convpow2(v.x,v.y,numeric.clone(g.x),numeric.neg(g.y)),v=v.mul(g),v.x.length=a,v.y.length=a,v.div(a)},numeric.gradient=function(t,e){var r=e.length,n=t(e);if(isNaN(n))throw new Error("gradient: f(x) is a NaN!");var a,i,o,s,u,c,l,h,f,d=Math.max,m=numeric.clone(e),p=Array(r),d=(numeric.div,numeric.sub,Math.max),v=Math.abs,g=Math.min,M=0;for(a=0;a<r;a++)for(var b=d(1e-6*n,1e-8);;){if(++M>20)throw new Error("Numerical gradient fails");if(m[a]=e[a]+b,i=t(m),m[a]=e[a]-b,o=t(m),m[a]=e[a],isNaN(i)||isNaN(o))b/=16;else{if(p[a]=(i-o)/(2*b),s=e[a]-b,u=e[a],c=e[a]+b,l=(i-n)/b,h=(n-o)/b,f=d(v(p[a]),v(n),v(i),v(o),v(s),v(u),v(c),1e-8),!(g(d(v(l-p[a]),v(h-p[a]),v(l-h))/f,b/f)>.001))break;b/=16}}return p},numeric.uncmin=function(t,e,r,n,a,i,o){var s=numeric.gradient;void 0===o&&(o={}),void 0===r&&(r=1e-8),void 0===n&&(n=function(e){return s(t,e)}),void 0===a&&(a=1e3),e=numeric.clone(e);var u,c,l=e.length,h=t(e);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var f=Math.max,d=numeric.norm2;r=f(r,numeric.epsilon);var m,p,v,g,M,b,y,x,S,w,D=o.Hinv||numeric.identity(l),I=numeric.dot,F=(numeric.inv,numeric.sub),_=numeric.add,C=numeric.tensor,A=numeric.div,k=numeric.mul,P=numeric.all,j=numeric.isFinite,T=numeric.neg,R=0,O="";for(p=n(e);R<a;){if("function"==typeof i&&i(R,e,h,p,D)){O="Callback returned true";break}if(!P(j(p))){O="Gradient has Infinity or NaN";break}if(m=T(I(D,p)),!P(j(m))){O="Search direction has Infinity or NaN";break}if((w=d(m))<r){O="Newton step smaller than tol";break}for(S=1,c=I(p,m),M=e;R<a&&!(S*w<r)&&(g=k(m,S),M=_(e,g),(u=t(M))-h>=.1*S*c||isNaN(u));)S*=.5,++R;if(S*w<r){O="Line search step size smaller than tol";break}if(R===a){O="maxit reached during line search";break}v=n(M),b=F(v,p),x=I(b,g),y=I(D,b),D=F(_(D,k((x+I(b,y))/(x*x),C(g,g))),A(_(C(y,g),C(g,y)),x)),e=M,h=u,p=v,++R}return{solution:e,f:h,gradient:p,invHessian:D,iterations:R,message:O}},numeric.Dopri=function(t,e,r,n,a,i,o){this.x=t,this.y=e,this.f=r,this.ymid=n,this.iterations=a,this.events=o,this.message=i},
numeric.Dopri.prototype._at=function(t,e){function r(t){return t*t}var n,a,i,o,s,u,t,c,l,h,f,d=this,m=d.x,p=d.y,v=d.f,g=d.ymid,M=(m.length,Math.floor,numeric.add),b=numeric.mul,y=numeric.sub;return n=m[e],a=m[e+1],o=p[e],s=p[e+1],c=a-n,i=n+.5*c,u=g[e],l=y(v[e],b(o,1/(n-i)+2/(n-a))),h=y(v[e+1],b(s,1/(a-i)+2/(a-n))),f=[r(t-a)*(t-i)/r(n-a)/(n-i),r(t-n)*r(t-a)/r(n-i)/r(a-i),r(t-n)*(t-i)/r(a-n)/(a-i),(t-n)*r(t-a)*(t-i)/r(n-a)/(n-i),(t-a)*r(t-n)*(t-i)/r(n-a)/(a-i)],M(M(M(M(b(o,f[0]),b(u,f[1])),b(s,f[2])),b(l,f[3])),b(h,f[4]))},numeric.Dopri.prototype.at=function(t){var e,r,n,a=Math.floor;if("number"!=typeof t){var i=t.length,o=Array(i);for(e=i-1;-1!==e;--e)o[e]=this.at(t[e]);return o}var s=this.x;for(e=0,r=s.length-1;r-e>1;)n=a(.5*(e+r)),s[n]<=t?e=n:r=n;return this._at(t,e)},numeric.dopri=function(t,e,r,n,a,i,o){void 0===a&&(a=1e-6),void 0===i&&(i=1e3);var s,u,c,l,h,f,d,m,p,v,g,M,b,y=[t],x=[r],S=[n(t,r)],w=[],D=[.075,.225],I=[44/45,-56/15,32/9],F=[19372/6561,-25360/2187,64448/6561,-212/729],_=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],C=[35/384,0,500/1113,125/192,-2187/6784,11/84],A=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],k=[.2,.3,.8,8/9,1,1],P=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],j=0,T=(e-t)/10,R=0,O=numeric.add,E=numeric.mul,q=(Math.max,Math.min),z=Math.abs,N=numeric.norminf,L=Math.pow,B=numeric.any,H=numeric.lt,V=numeric.and,G=(numeric.sub,new numeric.Dopri(y,x,S,w,-1,""));for("function"==typeof o&&(g=o(t,r));t<e&&R<i;)if(++R,t+T>e&&(T=e-t),s=n(t+k[0]*T,O(r,E(.2*T,S[j]))),u=n(t+k[1]*T,O(O(r,E(D[0]*T,S[j])),E(D[1]*T,s))),c=n(t+k[2]*T,O(O(O(r,E(I[0]*T,S[j])),E(I[1]*T,s)),E(I[2]*T,u))),l=n(t+k[3]*T,O(O(O(O(r,E(F[0]*T,S[j])),E(F[1]*T,s)),E(F[2]*T,u)),E(F[3]*T,c))),h=n(t+k[4]*T,O(O(O(O(O(r,E(_[0]*T,S[j])),E(_[1]*T,s)),E(_[2]*T,u)),E(_[3]*T,c)),E(_[4]*T,l))),p=O(O(O(O(O(r,E(S[j],T*C[0])),E(u,T*C[2])),E(c,T*C[3])),E(l,T*C[4])),E(h,T*C[5])),f=n(t+T,p),d=O(O(O(O(O(E(S[j],T*P[0]),E(u,T*P[2])),E(c,T*P[3])),E(l,T*P[4])),E(h,T*P[5])),E(f,T*P[6])),(v="number"==typeof d?z(d):N(d))>a){if(T=.2*T*L(a/v,.25),t+T===t){G.msg="Step size became too small";break}}else{if(w[j]=O(O(O(O(O(O(r,E(S[j],T*A[0])),E(u,T*A[2])),E(c,T*A[3])),E(l,T*A[4])),E(h,T*A[5])),E(f,T*A[6])),++j,y[j]=t+T,x[j]=p,S[j]=f,"function"==typeof o){var U,Y,X=t,Q=t+.5*T;if(M=o(Q,w[j-1]),b=V(H(g,0),H(0,M)),B(b)||(X=Q,Q=t+T,g=M,M=o(Q,p),b=V(H(g,0),H(0,M))),B(b)){for(var Z,W,J=0,K=1,$=1;;){if("number"==typeof g)Y=($*M*X-K*g*Q)/($*M-K*g);else for(Y=Q,m=g.length-1;-1!==m;--m)g[m]<0&&M[m]>0&&(Y=q(Y,($*M[m]*X-K*g[m]*Q)/($*M[m]-K*g[m])));if(Y<=X||Y>=Q)break;U=G._at(Y,j-1),W=o(Y,U),Z=V(H(g,0),H(0,W)),B(Z)?(Q=Y,M=W,b=Z,$=1,-1===J?K*=.5:K=1,J=-1):(X=Y,g=W,K=1,1===J?$*=.5:$=1,J=1)}return p=G._at(.5*(t+Y),j-1),G.f[j]=n(Y,U),G.x[j]=Y,G.y[j]=U,G.ymid[j-1]=p,G.events=b,G.iterations=R,G}}t+=T,r=p,g=M,T=q(.8*T*L(a/v,.25),4*T)}return G.iterations=R,G},numeric.LU=function(t,e){e=e||!1;var r,n,a,i,o,s,u,c,l,h=Math.abs,f=t.length,d=f-1,m=new Array(f);for(e||(t=numeric.clone(t)),a=0;a<f;++a){for(u=a,s=t[a],l=h(s[a]),n=a+1;n<f;++n)i=h(t[n][a]),l<i&&(l=i,u=n);for(m[a]=u,u!=a&&(t[a]=t[u],t[u]=s,s=t[a]),o=s[a],r=a+1;r<f;++r)t[r][a]/=o;for(r=a+1;r<f;++r){for(c=t[r],n=a+1;n<d;++n)c[n]-=c[a]*s[n],++n,c[n]-=c[a]*s[n];n===d&&(c[n]-=c[a]*s[n])}}return{LU:t,P:m}},numeric.LUsolve=function(t,e){var r,n,a,i,o,s=t.LU,u=s.length,c=numeric.clone(e),l=t.P;for(r=u-1;-1!==r;--r)c[r]=e[r];for(r=0;r<u;++r)for(a=l[r],l[r]!==r&&(o=c[r],c[r]=c[a],c[a]=o),i=s[r],n=0;n<r;++n)c[r]-=c[n]*i[n];for(r=u-1;r>=0;--r){for(i=s[r],n=r+1;n<u;++n)c[r]-=c[n]*i[n];c[r]/=i[r]}return c},numeric.solve=function(t,e,r){return numeric.LUsolve(numeric.LU(t,r),e)},numeric.echelonize=function(t){var e,r,n,a,i,o,s,u,c=numeric.dim(t),l=c[0],h=c[1],f=numeric.identity(l),d=Array(l),m=Math.abs,p=numeric.diveq;for(t=numeric.clone(t),e=0;e<l;++e){for(n=0,i=t[e],o=f[e],r=1;r<h;++r)m(i[n])<m(i[r])&&(n=r);for(d[e]=n,p(o,i[n]),p(i,i[n]),r=0;r<l;++r)if(r!==e){for(s=t[r],u=s[n],a=h-1;-1!==a;--a)s[a]-=i[a]*u;for(s=f[r],a=l-1;-1!==a;--a)s[a]-=o[a]*u}}return{I:f,A:t,P:d}},numeric.__solveLP=function(t,e,r,n,a,i,o){var s,u,c,l,h=numeric.sum,f=(numeric.log,numeric.mul),d=numeric.sub,m=numeric.dot,p=numeric.div,v=numeric.add,g=t.length,M=r.length,b=!1,y=1,x=(numeric.transpose(e),numeric.svd,numeric.transpose),S=(numeric.leq,Math.sqrt),w=Math.abs,D=(numeric.muleq,numeric.norminf,numeric.any,Math.min),I=numeric.all,F=numeric.gt,_=Array(g),C=Array(M),A=(numeric.rep([M],1),numeric.solve),k=d(r,m(e,i)),P=m(t,t);for(c=0;c<a;++c){var j,T;for(j=M-1;-1!==j;--j)C[j]=p(e[j],k[j]);var R=x(C);for(j=g-1;-1!==j;--j)_[j]=h(R[j]);y=.25*w(P/m(t,_));var O=100*S(P/m(_,_));for((!isFinite(y)||y>O)&&(y=O),l=v(t,f(y,_)),u=m(R,C),j=g-1;-1!==j;--j)u[j][j]+=1;T=A(u,p(l,y),!0);var E=p(k,m(e,T)),q=1;for(j=M-1;-1!==j;--j)E[j]<0&&(q=D(q,-.999*E[j]));if(s=d(i,f(T,q)),k=d(r,m(e,s)),!I(F(k,0)))return{solution:i,message:"",iterations:c};if(i=s,y<n)return{solution:s,message:"",iterations:c};if(o){var z=m(t,l),N=m(e,l);for(b=!0,j=M-1;-1!==j;--j)if(z*N[j]<0){b=!1;break}}else b=!(i[g-1]>=0);if(b)return{solution:s,message:"Unbounded",iterations:c}}return{solution:i,message:"maximum iteration count exceeded",iterations:c}},numeric._solveLP=function(t,e,r,n,a){var i,o=t.length,s=r.length,u=(numeric.sum,numeric.log,numeric.mul,numeric.sub),c=numeric.dot,l=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),h=numeric.rep([s,1],-1),f=numeric.blockMatrix([[e,h]]),d=r,i=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),m=numeric.__solveLP(l,f,d,n,a,i,!1),p=numeric.clone(m.solution);if(p.length=o,numeric.inf(u(r,c(e,p)))<0)return{solution:NaN,message:"Infeasible",iterations:m.iterations};var v=numeric.__solveLP(t,e,r,n,a-m.iterations,p,!0);return v.iterations+=m.iterations,v},numeric.solveLP=function(t,e,r,n,a,i,o){if(void 0===o&&(o=1e3),void 0===i&&(i=numeric.epsilon),void 0===n)return numeric._solveLP(t,e,r,i,o);var s,u=n.length,c=n[0].length,l=e.length,h=numeric.echelonize(n),f=numeric.rep([c],0),d=h.P,m=[];for(s=d.length-1;-1!==s;--s)f[d[s]]=1;for(s=c-1;-1!==s;--s)0===f[s]&&m.push(s);var p=numeric.getRange,v=numeric.linspace(0,u-1),g=numeric.linspace(0,l-1),M=p(n,v,m),b=p(e,g,d),y=p(e,g,m),x=numeric.dot,S=numeric.sub,w=x(b,h.I),D=S(y,x(w,M)),I=S(r,x(w,a)),F=Array(d.length),_=Array(m.length);for(s=d.length-1;-1!==s;--s)F[s]=t[d[s]];for(s=m.length-1;-1!==s;--s)_[s]=t[m[s]];var C=S(_,x(F,x(h.I,M))),A=numeric._solveLP(C,D,I,i,o),k=A.solution;if(k!==k)return A;var P=x(h.I,S(a,x(M,k))),j=Array(t.length);for(s=d.length-1;-1!==s;--s)j[d[s]]=P[s];for(s=m.length-1;-1!==s;--s)j[m[s]]=k[s];return{solution:j,message:A.message,iterations:A.iterations}},numeric.MPStoLP=function(t){function e(e){throw new Error("MPStoLP: "+e+"\nLine "+r+": "+t[r]+"\nCurrent state: "+s[o]+"\n")}t instanceof String&&t.split("\n");var r,n,a,i,o=0,s=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],u=t.length,c=0,l={},h=[],f=0,d={},m=0,p=[],v=[],g=[];for(r=0;r<u;++r){a=t[r];var M=a.match(/\S*/g),b=[];for(n=0;n<M.length;++n)""!==M[n]&&b.push(M[n]);if(0!==b.length){for(n=0;n<s.length&&a.substr(0,s[n].length)!==s[n];++n);if(n<s.length){if(o=n,1===n&&(i=b[1]),6===n)return{name:i,c:p,A:numeric.transpose(v),b:g,rows:l,vars:d}}else switch(o){case 0:case 1:e("Unexpected line");case 2:switch(b[0]){case"N":0===c?c=b[1]:e("Two or more N rows");break;case"L":l[b[1]]=f,h[f]=1,g[f]=0,++f;break;case"G":l[b[1]]=f,h[f]=-1,g[f]=0,++f;break;case"E":l[b[1]]=f,h[f]=0,g[f]=0,++f;break;default:e("Parse error "+numeric.prettyPrint(b))}break;case 3:d.hasOwnProperty(b[0])||(d[b[0]]=m,p[m]=0,v[m]=numeric.rep([f],0),++m);var y=d[b[0]];for(n=1;n<b.length;n+=2)if(b[n]!==c){var x=l[b[n]];v[y][x]=(h[x]<0?-1:1)*parseFloat(b[n+1])}else p[y]=parseFloat(b[n+1]);break;case 4:for(n=1;n<b.length;n+=2)g[l[b[n]]]=(h[l[b[n]]]<0?-1:1)*parseFloat(b[n+1]);break;case 5:break;case 6:e("Internal error")}}}e("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(t,e,r,n,a,i,o){function s(t){var e,n,a=this,i=t.length,o=0,s=a.i=a.j=a.m=0;for(a.S=[],a.c=[],i||(t=[i++]);o<r;)a.S[o]=o++;for(o=0;o<r;o++)e=a.S[o],s=l(s+e+t[o%i]),n=a.S[s],a.S[o]=n,a.S[s]=e;a.g=function(t){var e=a.S,n=l(a.i+1),i=e[n],o=l(a.j+i),s=e[o];e[n]=s,e[o]=i;for(var u=e[l(i+s)];--t;)n=l(n+1),i=e[n],o=l(o+i),s=e[o],e[n]=s,e[o]=i,u=u*r+e[l(i+s)];return a.i=n,a.j=o,u},a.g(r)}function u(t,e,r,n,a){if(r=[],a=typeof t,e&&"object"==a)for(n in t)if(n.indexOf("S")<5)try{r.push(u(t[n],e-1))}catch(t){}return r.length?r:t+("string"!=a?"\0":"")}function c(t,e,r,n){for(t+="",r=0,n=0;n<t.length;n++)e[l(n)]=l((r^=19*e[l(n)])+t.charCodeAt(n));t="";for(n in e)t+=String.fromCharCode(e[n]);return t}function l(t){return t&r-1}e.seedrandom=function(n,l){var h,f=[];return n=c(u(l?[n,t]:arguments.length?n:[(new Date).getTime(),t,window],3),f),h=new s(f),c(h.S,t),e.random=function(){for(var t=h.g(6),e=o,n=0;t<a;)t=(t+n)*r,e*=r,n=h.g(1);for(;t>=i;)t/=2,e/=2,n>>>=1;return(t+n)/e},n},o=e.pow(r,6),a=e.pow(2,a),i=2*a,c(e.random(),t)}([],numeric.seedrandom,256,0,52),function(t){function e(t){if("object"!=typeof t)return t;var r,n=[],a=t.length;for(r=0;r<a;r++)n[r+1]=e(t[r]);return n}function r(t){if("object"!=typeof t)return t;var e,n=[],a=t.length;for(e=1;e<a;e++)n[e-1]=r(t[e]);return n}function n(t,e,r){var n,a,i,o,s;for(i=1;i<=r;i+=1){for(t[i][i]=1/t[i][i],s=-t[i][i],n=1;n<i;n+=1)t[n][i]=s*t[n][i];if(o=i+1,r<o)break;for(a=o;a<=r;a+=1)for(s=t[i][a],t[i][a]=0,n=1;n<=i;n+=1)t[n][a]=t[n][a]+s*t[n][i]}}function a(t,e,r,n){var a,i,o,s;for(i=1;i<=r;i+=1){for(s=0,a=1;a<i;a+=1)s+=t[a][i]*n[a];n[i]=(n[i]-s)/t[i][i]}for(o=1;o<=r;o+=1)for(i=r+1-o,n[i]=n[i]/t[i][i],s=-n[i],a=1;a<i;a+=1)n[a]=n[a]+s*t[a][i]}function i(t,e,r,n){var a,i,o,s,u,c;for(i=1;i<=r;i+=1){if(n[1]=i,c=0,(o=i-1)<1){if((c=t[i][i]-c)<=0)break;t[i][i]=Math.sqrt(c)}else{for(s=1;s<=o;s+=1){for(u=t[s][i],a=1;a<s;a+=1)u-=t[a][i]*t[a][s];u/=t[s][s],t[s][i]=u,c+=u*u}if((c=t[i][i]-c)<=0)break;t[i][i]=Math.sqrt(c)}n[1]=0}}function o(t,e,r,o,s,u,c,l,h,f,d,m,p,v,g,M){function b(){return g[k+p]=g[k+p+1],g[k+p+1]=0,m[p]=0,p-=1,v[2]=v[2]+1,0}var y,x,S,w,D,I,F,_,C,A,k,P,j,T,R,O,E,q,z,N,L,B,H,V,G,U,Y;j=Math.min(o,f),S=2*o+j*(j+5)/2+2*f+1,V=1e-60;do{V+=V,G=1+.1*V,U=1+.2*V}while(G<=1||U<=1);for(y=1;y<=o;y+=1)g[y]=e[y];for(y=o+1;y<=S;y+=1)g[y]=0;for(y=1;y<=f;y+=1)m[y]=0;if(D=[],0===M[1]){if(i(t,r,o,D),0!==D[1])return void(M[1]=2);a(t,r,o,e),n(t,r,o)}else{for(x=1;x<=o;x+=1)for(s[x]=0,y=1;y<=x;y+=1)s[x]=s[x]+t[y][x]*e[y];for(x=1;x<=o;x+=1)for(e[x]=0,y=x;y<=o;y+=1)e[x]=e[x]+t[x][y]*s[y]}for(u[1]=0,x=1;x<=o;x+=1)for(s[x]=e[x],u[1]=u[1]+g[x]*s[x],g[x]=0,y=x+1;y<=o;y+=1)t[y][x]=0;for(u[1]=-u[1]/2,M[1]=0,F=o,_=F+o,k=_+j,C=k+j+1,A=C+j*(j+1)/2,T=A+f,y=1;y<=f;y+=1){for(O=0,x=1;x<=o;x+=1)O+=c[x][y]*c[x][y];g[T+y]=Math.sqrt(O)}for(p=0,v[1]=0,v[2]=0,Y=0;;){if(999===(Y=function(){for(v[1]=v[1]+1,S=A,y=1;y<=f;y+=1){for(S+=1,O=-l[y],x=1;x<=o;x+=1)O+=c[x][y]*s[x];if(Math.abs(O)<V&&(O=0),y>d)g[S]=O;else if(g[S]=-Math.abs(O),O>0){for(x=1;x<=o;x+=1)c[x][y]=-c[x][y];l[y]=-l[y]}}for(y=1;y<=p;y+=1)g[A+m[y]]=0;for(P=0,R=0,y=1;y<=f;y+=1)g[A+y]<R*g[T+y]&&(P=y,R=g[A+y]/g[T+y]);return 0===P?999:0}()))return;for(;;){if(0===(Y=function(){for(y=1;y<=o;y+=1){for(O=0,x=1;x<=o;x+=1)O+=t[x][y]*c[x][P];g[y]=O}for(w=F,y=1;y<=o;y+=1)g[w+y]=0;for(x=p+1;x<=o;x+=1)for(y=1;y<=o;y+=1)g[w+y]=g[w+y]+t[y][x]*g[x];for(B=!0,y=p;y>=1;y-=1){for(O=g[y],S=C+y*(y+3)/2,w=S-y,x=y+1;x<=p;x+=1)O-=g[S]*g[_+x],S+=x;if(O/=g[w],g[_+y]=O,m[y]<d)break;if(O<0)break;B=!1,I=y}if(!B)for(E=g[k+I]/g[_+I],y=1;y<=p&&!(m[y]<d)&&!(g[_+y]<0);y+=1)(R=g[k+y]/g[_+y])<E&&(E=R,I=y);for(O=0,y=F+1;y<=F+o;y+=1)O+=g[y]*g[y];if(Math.abs(O)<=V){if(B)return M[1]=1,999;for(y=1;y<=p;y+=1)g[k+y]=g[k+y]-E*g[_+y];return g[k+p+1]=g[k+p+1]+E,700}for(O=0,y=1;y<=o;y+=1)O+=g[F+y]*c[y][P];for(q=-g[A+P]/O,H=!0,B||E<q&&(q=E,H=!1),y=1;y<=o;y+=1)s[y]=s[y]+q*g[F+y],Math.abs(s[y])<V&&(s[y]=0);for(u[1]=u[1]+q*O*(q/2+g[k+p+1]),y=1;y<=p;y+=1)g[k+y]=g[k+y]-q*g[_+y];if(g[k+p+1]=g[k+p+1]+q,!H){for(O=-l[P],x=1;x<=o;x+=1)O+=s[x]*c[x][P];if(P>d)g[A+P]=O;else if(g[A+P]=-Math.abs(O),O>0){for(x=1;x<=o;x+=1)c[x][P]=-c[x][P];l[P]=-l[P]}return 700}for(p+=1,m[p]=P,S=C+(p-1)*p/2+1,y=1;y<=p-1;y+=1)g[S]=g[y],S+=1;if(p===o)g[S]=g[o];else{for(y=o;y>=p+1&&0!==g[y]&&(z=Math.max(Math.abs(g[y-1]),Math.abs(g[y])),N=Math.min(Math.abs(g[y-1]),Math.abs(g[y])),R=g[y-1]>=0?Math.abs(z*Math.sqrt(1+N*N/(z*z))):-Math.abs(z*Math.sqrt(1+N*N/(z*z))),z=g[y-1]/R,N=g[y]/R,1!==z);y-=1)if(0===z)for(g[y-1]=N*R,x=1;x<=o;x+=1)R=t[x][y-1],t[x][y-1]=t[x][y],t[x][y]=R;else for(g[y-1]=R,L=N/(1+z),x=1;x<=o;x+=1)R=z*t[x][y-1]+N*t[x][y],t[x][y]=L*(t[x][y-1]+R)-t[x][y],t[x][y-1]=R;g[S]=g[p]}return 0}()))break;if(999===Y)return;if(700===Y)if(I===p)b();else{for(;;)if(function(){if(S=C+I*(I+1)/2+1,w=S+I,0===g[w])return 798;if(z=Math.max(Math.abs(g[w-1]),Math.abs(g[w])),N=Math.min(Math.abs(g[w-1]),Math.abs(g[w])),R=g[w-1]>=0?Math.abs(z*Math.sqrt(1+N*N/(z*z))):-Math.abs(z*Math.sqrt(1+N*N/(z*z))),z=g[w-1]/R,N=g[w]/R,1===z)return 798;if(0===z){for(y=I+1;y<=p;y+=1)R=g[w-1],g[w-1]=g[w],g[w]=R,w+=y;for(y=1;y<=o;y+=1)R=t[y][I],t[y][I]=t[y][I+1],t[y][I+1]=R}else{for(L=N/(1+z),y=I+1;y<=p;y+=1)R=z*g[w-1]+N*g[w],g[w]=L*(g[w-1]+R)-g[w],g[w-1]=R,w+=y;for(y=1;y<=o;y+=1)R=z*t[y][I]+N*t[y][I+1],t[y][I+1]=L*(t[y][I]+R)-t[y][I+1],t[y][I]=R}}(),797!==(Y=function(){for(w=S-I,y=1;y<=I;y+=1)g[w]=g[S],S+=1,w+=1;return g[k+I]=g[k+I+1],m[I]=m[I+1],I+=1,I<p?797:0}()))break;b()}}}}function s(t,n,a,i,s,u){t=e(t),n=e(n),a=e(a);var c,l,h,f,d,m,p=[],v=[],g=[],M=[],b=[];if(s=s||0,u=u?e(u):[void 0,0],i=i?e(i):[],l=t.length-1,h=a[1].length-1,!i)for(c=1;c<=h;c+=1)i[c]=0;for(c=1;c<=h;c+=1)v[c]=0;for(f=0,d=Math.min(l,h),c=1;c<=l;c+=1)g[c]=0;for(p[1]=0,c=1;c<=2*l+d*(d+5)/2+2*h+1;c+=1)M[c]=0;for(c=1;c<=2;c+=1)b[c]=0;return o(t,n,l,l,g,p,a,i,l,h,s,v,f,b,M,u),m="",1===u[1]&&(m="constraints are inconsistent, no solution!"),2===u[1]&&(m="matrix D in quadratic function is not positive definite!"),{solution:r(g),value:r(p),unconstrained_solution:r(n),iterations:r(b),iact:r(v),message:m}}t.solveQP=s}(numeric),numeric.svd=function(t){function e(t,e){return t=Math.abs(t),e=Math.abs(e),t>e?t*Math.sqrt(1+e*e/t/t):0==e?t:e*Math.sqrt(1+t*t/e/e)}var r,n=numeric.epsilon,a=1e-64/n,i=0,o=0,s=0,u=0,c=0,l=numeric.clone(t),h=l.length,f=l[0].length;if(h<f)throw"Need more rows than columns";var d=new Array(f),m=new Array(f);for(o=0;o<f;o++)d[o]=m[o]=0;var p=numeric.rep([f,f],0),v=0,g=0,M=0,b=0,y=0,x=0,S=0;for(o=0;o<f;o++){for(d[o]=g,S=0,c=o+1,s=o;s<h;s++)S+=l[s][o]*l[s][o];if(S<=a)g=0;else for(v=l[o][o],g=Math.sqrt(S),v>=0&&(g=-g),M=v*g-S,l[o][o]=v-g,s=c;s<f;s++){for(S=0,u=o;u<h;u++)S+=l[u][o]*l[u][s];for(v=S/M,u=o;u<h;u++)l[u][s]+=v*l[u][o]}for(m[o]=g,S=0,s=c;s<f;s++)S+=l[o][s]*l[o][s];if(S<=a)g=0;else{for(v=l[o][o+1],g=Math.sqrt(S),v>=0&&(g=-g),M=v*g-S,l[o][o+1]=v-g,s=c;s<f;s++)d[s]=l[o][s]/M;for(s=c;s<h;s++){for(S=0,u=c;u<f;u++)S+=l[s][u]*l[o][u];for(u=c;u<f;u++)l[s][u]+=S*d[u]}}y=Math.abs(m[o])+Math.abs(d[o]),y>b&&(b=y)}for(o=f-1;-1!=o;o+=-1){if(0!=g){for(M=g*l[o][o+1],s=c;s<f;s++)p[s][o]=l[o][s]/M;for(s=c;s<f;s++){for(S=0,u=c;u<f;u++)S+=l[o][u]*p[u][s];for(u=c;u<f;u++)p[u][s]+=S*p[u][o]}}for(s=c;s<f;s++)p[o][s]=0,p[s][o]=0;p[o][o]=1,g=d[o],c=o}for(o=f-1;-1!=o;o+=-1){for(c=o+1,g=m[o],s=c;s<f;s++)l[o][s]=0;if(0!=g){for(M=l[o][o]*g,s=c;s<f;s++){for(S=0,u=c;u<h;u++)S+=l[u][o]*l[u][s];for(v=S/M,u=o;u<h;u++)l[u][s]+=v*l[u][o]}for(s=o;s<h;s++)l[s][o]=l[s][o]/g}else for(s=o;s<h;s++)l[s][o]=0;l[o][o]+=1}for(n*=b,u=f-1;-1!=u;u+=-1)for(var w=0;w<50;w++){var D=!1;for(c=u;-1!=c;c+=-1){if(Math.abs(d[c])<=n){D=!0;break}if(Math.abs(m[c-1])<=n)break}if(!D){i=0,S=1;var I=c-1;for(o=c;o<u+1&&(v=S*d[o],d[o]=i*d[o],!(Math.abs(v)<=n));o++)for(g=m[o],M=e(v,g),m[o]=M,i=g/M,S=-v/M,s=0;s<h;s++)y=l[s][I],x=l[s][o],l[s][I]=y*i+x*S,l[s][o]=-y*S+x*i}if(x=m[u],c==u){if(x<0)for(m[u]=-x,s=0;s<f;s++)p[s][u]=-p[s][u];break}if(w>=49)throw"Error: no convergence.";for(b=m[c],y=m[u-1],g=d[u-1],M=d[u],v=((y-x)*(y+x)+(g-M)*(g+M))/(2*M*y),g=e(v,1),v=v<0?((b-x)*(b+x)+M*(y/(v-g)-M))/b:((b-x)*(b+x)+M*(y/(v+g)-M))/b,i=1,S=1,o=c+1;o<u+1;o++){for(g=d[o],y=m[o],M=S*g,g*=i,x=e(v,M),d[o-1]=x,i=v/x,S=M/x,v=b*i+g*S,g=-b*S+g*i,M=y*S,y*=i,s=0;s<f;s++)b=p[s][o-1],x=p[s][o],p[s][o-1]=b*i+x*S,p[s][o]=-b*S+x*i;for(x=e(v,M),m[o-1]=x,i=v/x,S=M/x,v=i*g+S*y,b=-S*g+i*y,s=0;s<h;s++)y=l[s][o-1],x=l[s][o],l[s][o-1]=y*i+x*S,l[s][o]=-y*S+x*i}d[c]=0,d[u]=v,m[u]=b}for(o=0;o<m.length;o++)m[o]<n&&(m[o]=0);for(o=0;o<f;o++)for(s=o-1;s>=0;s--)if(m[s]<m[o]){for(i=m[s],m[s]=m[o],m[o]=i,u=0;u<l.length;u++)r=l[u][o],l[u][o]=l[u][s],l[u][s]=r;for(u=0;u<p.length;u++)r=p[u][o],p[u][o]=p[u][s],p[u][s]=r;o=s}return{U:l,S:m,V:p}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],73:[function(t,e,r){"use strict";function n(t,e){for(var r=new Array(t.length-1),n=1;n<t.length;++n)for(var a=r[n-1]=new Array(t.length-1),i=0,o=0;i<t.length;++i)i!==e&&(a[o++]=t[n][i]);return r}function a(t){for(var e=new Array(t),r=0;r<t;++r){e[r]=new Array(t);for(var n=0;n<t;++n)e[r][n]=["m",n,"[",t-r-1,"]"].join("")}return e}function i(t){return 1&t?"-":""}function o(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",o(t.slice(0,e)),",",o(t.slice(e)),")"].join("")}function s(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var e=[],r=0;r<t.length;++r)e.push(["scale(",o(s(n(t,r))),",",i(r),t[0][r],")"].join(""));return e}function u(t){for(var e=[],r=[],i=a(t),u=[],c=0;c<t;++c)0==(1&c)?e.push.apply(e,s(n(i,c))):r.push.apply(r,s(n(i,c))),u.push("m"+c);var m=o(e),p=o(r),v="orientation"+t+"Exact",g=["function ",v,"(",u.join(),"){var p=",m,",n=",p,",d=sub(p,n);return d[d.length-1];};return ",v].join("");return new Function("sum","prod","scale","sub",g)(h,l,f,d)}function c(t){var e=g[t.length];return e||(e=g[t.length]=u(t.length)),e.apply(void 0,t)}var l=t("two-product"),h=t("robust-sum"),f=t("robust-scale"),d=t("robust-subtract"),m=5,p=u(3),v=u(4),g=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,r){var n,a=(t[1]-r[1])*(e[0]-r[0]),i=(t[0]-r[0])*(e[1]-r[1]),o=a-i;if(a>0){if(i<=0)return o;n=a+i}else{if(!(a<0))return o;if(i>=0)return o;n=-(a+i)}var s=3.3306690738754716e-16*n;return o>=s||o<=-s?o:p(t,e,r)},function(t,e,r,n){var a=t[0]-n[0],i=e[0]-n[0],o=r[0]-n[0],s=t[1]-n[1],u=e[1]-n[1],c=r[1]-n[1],l=t[2]-n[2],h=e[2]-n[2],f=r[2]-n[2],d=i*c,m=o*u,p=o*s,g=a*c,M=a*u,b=i*s,y=l*(d-m)+h*(p-g)+f*(M-b),x=(Math.abs(d)+Math.abs(m))*Math.abs(l)+(Math.abs(p)+Math.abs(g))*Math.abs(h)+(Math.abs(M)+Math.abs(b))*Math.abs(f),S=7.771561172376103e-16*x;return y>S||-y>S?y:v(t,e,r,n)}];!function(){for(;g.length<=m;)g.push(u(g.length));for(var t=[],r=["slow"],n=0;n<=m;++n)t.push("a"+n),r.push("o"+n);for(var a=["function getOrientation(",t.join(),"){switch(arguments.length){case 0:case 1:return 0;"],n=2;n<=m;++n)a.push("case ",n,":return o",n,"(",t.slice(0,n).join(),");");a.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),r.push(a.join(""));var i=Function.apply(void 0,r);e.exports=i.apply(void 0,[c].concat(g));for(var n=0;n<=m;++n)e.exports[n]=g[n]}()},{"robust-scale":74,"robust-subtract":75,"robust-sum":76,"two-product":91}],74:[function(t,e,r){"use strict";function n(t,e){var r=t.length;if(1===r){var n=a(t[0],e);return n[0]?n:[n[1]]}var o=new Array(2*r),s=[.1,.1],u=[.1,.1],c=0;a(t[0],e,s),s[0]&&(o[c++]=s[0]);for(var l=1;l<r;++l){a(t[l],e,u);var h=s[1];i(h,u[0],s),s[0]&&(o[c++]=s[0]);var f=u[1],d=s[1],m=f+d,p=m-f,v=d-p;s[1]=m,v&&(o[c++]=v)}return s[1]&&(o[c++]=s[1]),0===c&&(o[c++]=0),o.length=c,o}var a=t("two-product"),i=t("two-sum");e.exports=n},{"two-product":91,"two-sum":92}],75:[function(t,e,r){"use strict";function n(t,e){var r=t+e,n=r-t,a=r-n,i=e-n,o=t-a,s=o+i;return s?[s,r]:[r]}function a(t,e){var r=0|t.length,a=0|e.length;if(1===r&&1===a)return n(t[0],-e[0]);var i,o,s=r+a,u=new Array(s),c=0,l=0,h=0,f=Math.abs,d=t[l],m=f(d),p=-e[h],v=f(p);m<v?(o=d,(l+=1)<r&&(d=t[l],m=f(d))):(o=p,(h+=1)<a&&(p=-e[h],v=f(p))),l<r&&m<v||h>=a?(i=d,(l+=1)<r&&(d=t[l],m=f(d))):(i=p,(h+=1)<a&&(p=-e[h],v=f(p)));for(var g,M,b,y,x,S=i+o,w=S-i,D=o-w,I=D,F=S;l<r&&h<a;)m<v?(i=d,(l+=1)<r&&(d=t[l],m=f(d))):(i=p,(h+=1)<a&&(p=-e[h],v=f(p))),o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,M=g-F,b=g-M,y=S-M,x=F-b,I=x+y,F=g;for(;l<r;)i=d,o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,M=g-F,b=g-M,y=S-M,x=F-b,I=x+y,F=g,(l+=1)<r&&(d=t[l]);for(;h<a;)i=p,o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,M=g-F,b=g-M,y=S-M,x=F-b,I=x+y,F=g,(h+=1)<a&&(p=-e[h]);return I&&(u[c++]=I),F&&(u[c++]=F),c||(u[c++]=0),u.length=c,u}e.exports=a},{}],76:[function(t,e,r){"use strict";function n(t,e){var r=t+e,n=r-t,a=r-n,i=e-n,o=t-a,s=o+i;return s?[s,r]:[r]}function a(t,e){var r=0|t.length,a=0|e.length;if(1===r&&1===a)return n(t[0],e[0]);var i,o,s=r+a,u=new Array(s),c=0,l=0,h=0,f=Math.abs,d=t[l],m=f(d),p=e[h],v=f(p);m<v?(o=d,(l+=1)<r&&(d=t[l],m=f(d))):(o=p,(h+=1)<a&&(p=e[h],v=f(p))),l<r&&m<v||h>=a?(i=d,(l+=1)<r&&(d=t[l],m=f(d))):(i=p,(h+=1)<a&&(p=e[h],v=f(p)));for(var g,M,b,y,x,S=i+o,w=S-i,D=o-w,I=D,F=S;l<r&&h<a;)m<v?(i=d,(l+=1)<r&&(d=t[l],m=f(d))):(i=p,(h+=1)<a&&(p=e[h],v=f(p))),o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,M=g-F,b=g-M,y=S-M,x=F-b,I=x+y,F=g;for(;l<r;)i=d,o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,M=g-F,b=g-M,y=S-M,x=F-b,I=x+y,F=g,(l+=1)<r&&(d=t[l]);for(;h<a;)i=p,o=I,S=i+o,w=S-i,D=o-w,D&&(u[c++]=D),g=F+S,M=g-F,b=g-M,y=S-M,x=F-b,I=x+y,F=g,(h+=1)<a&&(p=e[h]);return I&&(u[c++]=I),F&&(u[c++]=F),c||(u[c++]=0),u.length=c,u}e.exports=a},{}],77:[function(t,e,r){"use strict";function n(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return new Promise(function(e,r){var n=t.inputSamples,a=t.inputSampleRate,o=void 0!==t.inputDelay?t.inputDelay:0,s=void 0!==t.outputSampleRate?t.outputSampleRate:a;if(a===s&&0===o)e(new Float32Array(n));else try{var u=Math.ceil(n.length*s/a),c=new window.OfflineAudioContext(1,u,s),l=c.createBuffer(1,n.length,a),h=new i.default(a,1);h.setDelay(o/a),l.getChannelData(0).set(h.process(n));var f=c.createBufferSource();f.buffer=l,f.connect(c.destination),f.start(),c.oncomplete=function(t){var r=t.renderedBuffer.getChannelData(0);e(r)},c.startRendering()}catch(t){r(new Error("Unable to re-sample Float32Array. "+t.message))}})}Object.defineProperty(r,"__esModule",{value:!0}),r.resampleFloat32Array=n;var a=t("fractional-delay"),i=function(t){return t&&t.__esModule?t:{default:t}}(a);r.default={resampleFloat32Array:n}},{"fractional-delay":52}],78:[function(t,e,r){"use strict";function n(t,e){var r=e.x-t.x,n=e.y-t.y,a=e.z-t.z;return r*r+n*n+a*a}function a(t,e){return Math.sqrt(this.distanceSquared(t,e))}Object.defineProperty(r,"__esModule",{value:!0}),r.tree=void 0,r.distanceSquared=n,r.distance=a;var i=t("kd.tree"),o=function(t){return t&&t.__esModule?t:{default:t}}(i);r.tree=o.default,r.default={distance:a,distanceSquared:n,tree:o.default}},{"kd.tree":70}],79:[function(t,e,r){"use strict";function n(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=0-n,t[1]=a,t[2]=0-r,t}function a(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=0-a,t[1]=0-r,t[2]=n,t}function i(t,e){var r=e[0],n=e[1],a=e[2],i=r*r+n*n;return t[0]=(y.default.atan2(n,r)+360)%360,t[1]=y.default.atan2(a,Math.sqrt(i)),t[2]=Math.sqrt(i+a*a),t}function o(t,e){var r=e[0],n=e[1],a=e[2],i=y.default.cos(n);return t[0]=a*i*y.default.cos(r),t[1]=a*i*y.default.sin(r),t[2]=a*y.default.sin(n),t}function s(t,e){var r=e[0],n=e[1],a=e[2],i=y.default.cos(n);return t[0]=0-a*i*y.default.sin(r),t[1]=a*y.default.sin(n),t[2]=0-a*i*y.default.cos(r),t}function u(t,e){var r=0-e[2],n=0-e[0],a=e[1],i=r*r+n*n;return t[0]=(y.default.atan2(n,r)+360)%360,t[1]=y.default.atan2(a,Math.sqrt(i)),t[2]=Math.sqrt(i+a*a),t}function c(t,e,r){switch(r){case"sofaCartesian":t[0]=e[0],t[1]=e[1],t[2]=e[2];break;case"sofaSpherical":o(t,e);break;default:throw new Error("Bad coordinate system")}return t}function l(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=a,t[2]=0-n,t}function h(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=0-a,t[2]=n,t}function f(t,e){var r=e[0],n=e[1],a=e[2],i=r*r+n*n;return t[0]=y.default.atan2(r,n),t[1]=y.default.atan2(a,Math.sqrt(i)),t[2]=Math.sqrt(i+a*a),t}function d(t,e){var r=e[0],n=e[1],a=e[2],i=y.default.cos(n);return t[0]=a*i*y.default.sin(r),t[1]=a*i*y.default.cos(r),t[2]=a*y.default.sin(n),t}function m(t,e){var r=e[0],n=e[1],a=e[2],i=y.default.cos(n);return t[0]=a*i*y.default.sin(r),t[1]=a*y.default.sin(n),t[2]=0-a*i*y.default.cos(r),t}function p(t,e){var r=e[0],n=0-e[2],a=e[1],i=r*r+n*n;return t[0]=y.default.atan2(r,n),t[1]=y.default.atan2(a,Math.sqrt(i)),t[2]=Math.sqrt(i+a*a),t}function v(t){var e=void 0;if("sofaCartesian"===t||"spat4Cartesian"===t||"gl"===t)e="cartesian";else{if("sofaSpherical"!==t&&"spat4Spherical"!==t)throw new Error("Unknown coordinate system type "+t);e="spherical"}return e}function g(t,e,r){switch(r){case"gl":t[0]=e[0],t[1]=e[1],t[2]=e[2];break;case"sofaCartesian":n(t,e);break;case"sofaSpherical":s(t,e);break;case"spat4Cartesian":l(t,e);break;case"spat4Spherical":m(t,e);break;default:throw new Error("Bad coordinate system")}return t}function M(t,e,r){switch(r){case"gl":t[0]=e[0],t[1]=e[1],t[2]=e[2];break;case"sofaCartesian":a(t,e);break;case"sofaSpherical":u(t,e);break;case"spat4Cartesian":h(t,e);break;case"spat4Spherical":p(t,e);break;default:throw new Error("Bad coordinate system")}return t}Object.defineProperty(r,"__esModule",{value:!0}),r.sofaCartesianToGl=n,r.glToSofaCartesian=a,r.sofaCartesianToSofaSpherical=i,r.sofaSphericalToSofaCartesian=o,r.sofaSphericalToGl=s,r.glToSofaSpherical=u,r.sofaToSofaCartesian=c,r.spat4CartesianToGl=l,r.glToSpat4Cartesian=h,r.spat4CartesianToSpat4Spherical=f,r.spat4SphericalToSpat4Cartesian=d,r.spat4SphericalToGl=m,r.glToSpat4Spherical=p,r.systemType=v,r.systemToGl=g,r.glToSystem=M;var b=t("./degree"),y=function(t){return t&&t.__esModule?t:{default:t}}(b);r.default={glToSofaCartesian:a,glToSofaSpherical:u,glToSpat4Cartesian:h,glToSpat4Spherical:p,glToSystem:M,sofaCartesianToGl:n,sofaCartesianToSofaSpherical:i,sofaSphericalToGl:s,sofaSphericalToSofaCartesian:o,sofaToSofaCartesian:c,spat4CartesianToGl:l,spat4CartesianToSpat4Spherical:f,spat4SphericalToGl:m,spat4SphericalToSpat4Cartesian:d,systemToGl:g,systemType:v}},{"./degree":80}],80:[function(t,e,r){"use strict";function n(t){return t*u}function a(t){return t*c}function i(t){return Math.cos(t*u)}function o(t){return Math.sin(t*u)}function s(t,e){return Math.atan2(t,e)*c}Object.defineProperty(r,"__esModule",{value:!0}),r.toRadian=n,r.fromRadian=a,r.cos=i,r.sin=o,r.atan2=s;var u=r.toRadianFactor=Math.PI/180,c=r.fromRadianFactor=1/u;r.default={atan2:s,cos:i,fromRadian:a,fromRadianFactor:c,sin:o,toRadian:n,toRadianFactor:u}},{}],81:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0}),r.ServerDataBase=r.HrtfSet=void 0;var a=t("./sofa/HrtfSet"),i=n(a),o=t("./sofa/ServerDataBase"),s=n(o);r.HrtfSet=i.default,r.ServerDataBase=s.default,r.default={HrtfSet:i.default,ServerDataBase:s.default}},{"./sofa/HrtfSet":83,"./sofa/ServerDataBase":84}],82:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.version=r.name=r.license=r.description=void 0;var n=t("../package.json"),a=function(t){return t&&t.__esModule?t:{default:t}}(n),i=a.default.description;r.description=i;var o=a.default.license;r.license=o;var s=a.default.name;r.name=s;var u=a.default.version;r.version=u,r.default={description:i,license:o,name:s,version:u}},{"../package.json":88}],83:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.HrtfSet=void 0;var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("gl-matrix"),u=n(s),c=t("../info"),l=n(c),h=t("./parseDataSet"),f=t("./parseSofa"),d=t("../geometry/coordinates"),m=n(d),p=t("../geometry/KdTree"),v=n(p),g=t("../audio/utilities"),M=r.HrtfSet=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,t),this._audioContext=e.audioContext,this._ready=!1,this.coordinateSystem=e.coordinateSystem,this.filterCoordinateSystem=e.filterCoordinateSystem,this.filterPositions=e.filterPositions,this.filterAfterLoad=e.filterAfterLoad}return o(t,[{key:"applyFilterPositions",value:function(){var t=this,e=this._filterPositions.map(function(e){return t._kdt.nearest({x:e[0],y:e[1],z:e[2]},1).pop()[0]});e=[].concat(a(new Set(e))),this._kdt=v.default.tree.createKdTree(e,v.default.distanceSquared,["x","y","z"])}},{key:"load",value:function(t){var e=this,r=t.split(".").pop(),n="sofa"===r?t+".json":t;return void 0===this._filterPositions||this.filterAfterLoad||"sofa"!==r?this._loadSofaFull(n).then(function(){return void 0!==e._filterPositions&&e.filterAfterLoad&&e.applyFilterPositions(),e._ready=!0,e}):Promise.all([this._loadMetaAndPositions(t),this._loadDataSet(t)]).then(function(r){var n=r[0],a=r[1];return e._loadSofaPartial(t,n,a).then(function(){return e._ready=!0,e})}).catch(function(){return e._loadSofaFull(n).then(function(){return e.applyFilterPositions(),e._ready=!0,e})})}},{key:"export",value:function(){var t=this,e=void 0,r=m.default.systemType(this.filterCoordinateSystem);switch(r){case"cartesian":e=this._sofaSourcePosition.map(function(t){return m.default.glToSofaCartesian([],t)});break;case"spherical":e=this._sofaSourcePosition.map(function(t){return m.default.glToSofaSpherical([],t)});break;default:throw new Error("Bad source position type "+r+" for export.")}var n=this._sofaSourcePosition.map(function(e){for(var r=t._kdt.nearest({x:e[0],y:e[1],z:e[2]},1).pop()[0].fir,n=[],i=0;i<r.numberOfChannels;++i)n.push([].concat(a(r.getChannelData(i))));return n});return(0,f.stringifySofa)({name:this._sofaName,metaData:this._sofaMetaData,ListenerPosition:[0,0,0],ListenerPositionType:"cartesian",ListenerUp:[0,0,1],ListenerUpType:"cartesian",ListenerView:[1,0,0],ListenerViewType:"cartesian",SourcePositionType:r,SourcePosition:e,DataSamplingRate:this._audioContext.sampleRate,DataDelay:this._sofaDelay,DataIR:n,RoomVolume:this._sofaRoomVolume})}},{key:"nearest",value:function(t){var e=m.default.systemToGl([],t,this.coordinateSystem),r=this._kdt.nearest({x:e[0],y:e[1],z:e[2]},1).pop(),n=r[0];return m.default.glToSystem(e,[n.x,n.y,n.z],this.coordinateSystem),{distance:r[1],fir:n.fir,index:n.index,position:e}}},{key:"nearestFir",value:function(t){return this.nearest(t).fir}},{key:"_createKdTree",value:function(t){var e=this,r=t.map(function(t){var r=t[2],n=e._audioContext.createBuffer(r.length,r[0].length,e._audioContext.sampleRate);return r.forEach(function(t,e){n.getChannelData(e).set(t)}),{index:t[0],x:t[1][0],y:t[1][1],z:t[1][2],fir:n}});return this._sofaSourcePosition=r.map(function(t){return[t.x,t.y,t.z]}),this._kdt=v.default.tree.createKdTree(r,v.default.distanceSquared,["x","y","z"]),this}},{key:"_generateIndicesPositionsFirs",value:function(t,e,r,n){var a=this,i=r.map(function(r,i){var o=r.length;if(2!==o)throw new Error("Bad number of channels for IR index "+t[i]+" ("+o+" instead of 2)");if(2!==n[0].length)throw new Error("Bad delay format for IR index "+t[i]+" (first element in Data.Delay is "+n[0]+" instead of [[delayL, delayR]] )");var s=void 0!==n[i]?n[i]:n[0],u=r.map(function(e,r){if(s[r]<0)throw new Error("Negative delay detected (not handled at the moment): delay index "+t[i]+" channel "+r);return(0,g.resampleFloat32Array)({inputSamples:e,inputDelay:s[r],inputSampleRate:a._sofaSampleRate,
outputSampleRate:a._audioContext.sampleRate})});return Promise.all(u).then(function(r){return[t[i],e[i],r]}).catch(function(t){throw new Error("Unable to re-sample impulse response "+i+". "+t.message)})});return Promise.all(i)}},{key:"_loadDataSet",value:function(t){return new Promise(function(e,r){var n=t+".dds",a=new window.XMLHttpRequest;a.open("GET",n),a.onerror=function(){r(new Error("Unable to GET "+n+", status "+a.status+" "+a.responseText))},a.onload=function(){if(a.status<200||a.status>=300)return void a.onerror();try{var t=(0,h.parseDataSet)(a.response);e(t)}catch(t){r(new Error("Unable to parse "+n+". "+t.message))}},a.send()})}},{key:"_loadMetaAndPositions",value:function(t){var e=this;return new Promise(function(r,n){var i=t+".json?ListenerPosition,ListenerUp,ListenerView,SourcePosition,Data.Delay,Data.SamplingRate,EmitterPosition,ReceiverPosition,RoomVolume",o=new window.XMLHttpRequest;o.open("GET",i),o.onerror=function(){n(new Error("Unable to GET "+i+", status "+o.status+" "+o.responseText))},o.onload=function(){if(o.status<200||o.status>=300)return void o.onerror();try{!function(){var n=(0,f.parseSofa)(o.response);e._setMetaData(n,t);var i=e._sourcePositionsToGl(n),s=i.map(function(t,e){return{x:t[0],y:t[1],z:t[2],index:e}}),u=v.default.tree.createKdTree(s,v.default.distanceSquared,["x","y","z"]),c=e._filterPositions.map(function(t){return u.nearest({x:t[0],y:t[1],z:t[2]},1).pop()[0].index});c=[].concat(a(new Set(c))),e._sofaUrl=t,r(c)}()}catch(t){n(new Error("Unable to parse "+i+". "+t.message))}},o.send()})}},{key:"_loadSofaFull",value:function(t){var e=this;return new Promise(function(r,n){var a=new window.XMLHttpRequest;a.open("GET",t),a.onerror=function(){n(new Error("Unable to GET "+t+", status "+a.status+" "+a.responseText))},a.onload=function(){if(a.status<200||a.status>=300)return void a.onerror();try{var i=(0,f.parseSofa)(a.response);e._setMetaData(i,t);var o=e._sourcePositionsToGl(i);e._generateIndicesPositionsFirs(o.map(function(t,e){return e}),o,i["Data.IR"].data,i["Data.Delay"].data).then(function(n){e._createKdTree(n),e._sofaUrl=t,r(e)})}catch(e){n(new Error("Unable to parse "+t+". "+e.message))}},a.send()})}},{key:"_loadSofaPartial",value:function(t,e,r){var n=this,a=e.map(function(e){return new Promise(function(a,i){var o=t+".json?SourcePosition["+e+"][0:1:"+(r.SourcePosition.C-1)+"],Data.IR["+e+"][0:1:"+(r["Data.IR"].R-1)+"][0:1:"+(r["Data.IR"].N-1)+"]",s=new window.XMLHttpRequest;s.open("GET",o),s.onerror=function(){i(new Error("Unable to GET "+o+", status "+s.status+" "+s.responseText))},s.onload=function(){(s.status<200||s.status>=300)&&s.onerror();try{var t=(0,f.parseSofa)(s.response),r=n._sourcePositionsToGl(t);n._generateIndicesPositionsFirs([e],r,t["Data.IR"].data,t["Data.Delay"].data).then(function(t){a(t[0])})}catch(t){i(new Error("Unable to parse "+o+". "+t.message))}},s.send()})});return Promise.all(a).then(function(t){return n._createKdTree(t),n})}},{key:"_setMetaData",value:function(t,e){if(void 0!==t.metaData.DataType&&"FIR"!==t.metaData.DataType)throw new Error("According to meta-data, SOFA data type is not FIR");var r=(new Date).toISOString();this._sofaName=void 0!==t.name?""+t.name:"HRTF.sofa",this._sofaMetaData=void 0!==t.metaData?t.metaData:{},void 0!==e&&(this._sofaMetaData.OriginalUrl=e),this._sofaMetaData.Converter="Ircam "+l.default.name+" "+l.default.version+" javascript API ",this._sofaMetaData.DateConverted=r,this._sofaSampleRate=void 0!==t["Data.SamplingRate"]?t["Data.SamplingRate"].data[0]:48e3,this._sofaSampleRate!==this._audioContext.sampleRate&&(this._sofaMetaData.OriginalSampleRate=this._sofaSampleRate),this._sofaDelay=void 0!==t["Data.Delay"]?t["Data.Delay"].data:[0,0],this._sofaRoomVolume=void 0!==t.RoomVolume?t.RoomVolume.data[0]:void 0;var n=m.default.sofaToSofaCartesian([],t.ListenerPosition.data[0],(0,f.conformSofaCoordinateSystem)(t.ListenerPosition.Type||"cartesian")),a=m.default.sofaToSofaCartesian([],t.ListenerView.data[0],(0,f.conformSofaCoordinateSystem)(t.ListenerView.Type||"cartesian")),i=m.default.sofaToSofaCartesian([],t.ListenerUp.data[0],(0,f.conformSofaCoordinateSystem)(t.ListenerUp.Type||"cartesian"));this._sofaToGl=u.default.mat4.lookAt([],n,a,i)}},{key:"_sourcePositionsToGl",value:function(t){var e=this,r=t.SourcePosition.data;switch(void 0!==t.SourcePosition.Type?t.SourcePosition.Type:"spherical"){case"cartesian":r.forEach(function(t){u.default.vec3.transformMat4(t,t,e._sofaToGl)});break;case"spherical":r.forEach(function(t){m.default.sofaSphericalToSofaCartesian(t,t),u.default.vec3.transformMat4(t,t,e._sofaToGl)});break;default:throw new Error("Bad source position type")}return r}},{key:"coordinateSystem",set:function(t){this._coordinateSystem=void 0!==t?t:"gl"},get:function(){return this._coordinateSystem}},{key:"filterCoordinateSystem",set:function(t){this._filterCoordinateSystem=void 0!==t?t:this.coordinateSystem},get:function(){return this._filterCoordinateSystem}},{key:"filterPositions",set:function(t){if(void 0===t)this._filterPositions=void 0;else switch(this.filterCoordinateSystem){case"gl":this._filterPositions=t.map(function(t){return t.slice(0)});break;case"sofaCartesian":this._filterPositions=t.map(function(t){return m.default.sofaCartesianToGl([],t)});break;case"sofaSpherical":this._filterPositions=t.map(function(t){return m.default.sofaSphericalToGl([],t)});break;default:throw new Error("Bad filter coordinate system")}},get:function(){var t=void 0;if(void 0!==this._filterPositions)switch(this.filterCoordinateSystem){case"gl":t=this._filterPositions.map(function(t){return t.slice(0)});break;case"sofaCartesian":t=this._filterPositions.map(function(t){return m.default.glToSofaCartesian([],t)});break;case"sofaSpherical":t=this._filterPositions.map(function(t){return m.default.glToSofaSpherical([],t)});break;default:throw new Error("Bad filter coordinate system")}return t}},{key:"filterAfterLoad",set:function(t){this._filterAfterLoad=void 0!==t&&t},get:function(){return this._filterAfterLoad}},{key:"isReady",get:function(){return this._ready}},{key:"sofaName",get:function(){return this._sofaName}},{key:"sofaUrl",get:function(){return this._sofaUrl}},{key:"sofaSampleRate",get:function(){return this._sofaSampleRate}},{key:"sofaMetaData",get:function(){return this._sofaMetaData}}]),t}();r.default=M},{"../audio/utilities":77,"../geometry/KdTree":78,"../geometry/coordinates":79,"../info":82,"./parseDataSet":85,"./parseSofa":86,"gl-matrix":59}],84:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.ServerDataBase=void 0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("./parseXml"),o=function(t){return t&&t.__esModule?t:{default:t}}(i),s=t("./parseDataSet"),u=r.ServerDataBase=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(n(this,t),this._server=e.serverUrl,void 0===this._server){var r="https:"===window.location.protocol?"https:":"http:";this._server=r+"//bili2.ircam.fr"}this._catalogue={},this._urls=[]}return a(t,[{key:"loadCatalogue",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?this._server+"/catalog.xml":arguments[0],r=arguments.length<=1||void 0===arguments[1]?this._catalogue:arguments[1];return new Promise(function(n,a){var i=new window.XMLHttpRequest;i.open("GET",e),i.onerror=function(){a(new Error("Unable to GET "+e+", status "+i.status+" "+i.responseText))},i.onload=function(){if(i.status<200||i.status>=300)return void i.onerror();var s=(0,o.default)(i.response),u=s.querySelector("dataset"),c=s.querySelectorAll("dataset > catalogRef");if(0===c.length){r.urls=[];for(var l=s.querySelectorAll("dataset > dataset"),h=0;h<l.length;++h){var f=t._server+u.getAttribute("name")+"/"+l[h].getAttribute("name");t._urls.push(f),r.urls.push(f)}n(e)}else{for(var d=[],m=0;m<c.length;++m){var p=c[m].getAttribute("name"),v=t._server+u.getAttribute("name")+"/"+c[m].getAttribute("xlink:href");r[p]={},d.push(t.loadCatalogue(v,r[p]))}Promise.all(d).then(function(){t._urls.sort(),n(e)}).catch(function(t){a(t)})}},i.send()})}},{key:"getUrls",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=[t.convention,t.dataBase,t.equalisation,t.sampleRate,t.sosOrder],r="number"==typeof t.freePattern?t.freePattern.toString():t.freePattern,n=e.reduce(function(t,e){return t+"/"+(void 0!==e?"[^/]*(?:"+e+")[^/]*":"[^/]*")},""),a=new RegExp(n,"i"),i=this._urls.filter(function(t){return a.test(t)});if(void 0!==r){r.split(/\s+/).forEach(function(t){a=new RegExp(t,"i"),i=i.filter(function(t){return a.test(t)})})}return i}},{key:"getDataSetDefinitions",value:function(t){return new Promise(function(e,r){var n=t+".dds",a=new window.XMLHttpRequest;a.open("GET",n),a.onerror=function(){r(new Error("Unable to GET "+n+", status "+a.status+" "+a.responseText))},a.onload=function(){if(a.status<200||a.status>=300)return void a.onerror();e((0,s.parseDataSet)(a.response))},a.send()})}},{key:"getSourcePositions",value:function(t){return new Promise(function(e,r){var n=t+".json?SourcePosition",a=new window.XMLHttpRequest;a.open("GET",n),a.onerror=function(){r(new Error("Unable to GET "+n+", status "+a.status+" "+a.responseText))},a.onload=function(){if(a.status<200||a.status>=300)return void a.onerror();try{var t=JSON.parse(a.response);if("SourcePosition"!==t.leaves[0].name)throw new Error("SourcePosition not found");e(t.leaves[0].data)}catch(t){r(new Error("Unable to parse response from "+n+". "+t.message))}},a.send()})}}]),t}();r.default=u},{"./parseDataSet":85,"./parseXml":87}],85:[function(t,e,r){"use strict";function n(t){var e=[],r=t.match(o);return null!==r&&r.forEach(function(t){var r=s.exec(t);null!==r&&r.length>2&&e.push([r[1],Number(r[2])])}),e}function a(t){var e=[],r=t.match(c);return null!==r&&r.forEach(function(t){var r=l.exec(t);null!==r&&r.length>3&&function(){var t=[];t[0]=r[2],t[1]={},t[1].type=r[1],n(r[3]).forEach(function(e){t[1][e[0]]=e[1]}),e.push(t)}()}),e}function i(t){var e={},r=h.exec(t);return null!==r&&r.length>1&&a(r[1]).forEach(function(t){e[t[0]]=t[1]}),e}Object.defineProperty(r,"__esModule",{value:!0}),r._parseDimension=n,r._parseDefinition=a,r.parseDataSet=i;var o=new RegExp("\\[\\s*(\\w+)\\s*=\\s*(\\d+)\\s*\\]","g"),s=new RegExp("\\[\\s*(\\w+)\\s*=\\s*(\\d+)\\s*\\]"),u="\\s*(\\w+)\\s*([\\w.]+)\\s*((?:\\[[^\\]]+\\]\\s*)+);\\s*",c=new RegExp(u,"g"),l=new RegExp(u),h=new RegExp("\\s*Dataset\\s*\\{\\s*((?:[^;]+;\\s*)*)\\s*\\}\\s*[\\w.]+\\s*;\\s*");r.default=i},{}],86:[function(t,e,r){"use strict";function n(t){try{var e=function(){var e=JSON.parse(t),r={};if(r.name=e.name,void 0!==e.attributes){r.metaData={};var n=e.attributes.find(function(t){return"NC_GLOBAL"===t.name});void 0!==n&&n.attributes.forEach(function(t){r.metaData[t.name]=t.value[0]})}if(void 0!==e.leaves){e.leaves.forEach(function(t){r[t.name]={},t.attributes.forEach(function(e){r[t.name][e.name]=e.value[0]}),r[t.name].shape=t.shape,r[t.name].data=t.data})}return{v:r}}();if("object"===(void 0===e?"undefined":o(e)))return e.v}catch(t){throw new Error("Unable to parse SOFA string. "+t.message)}}function a(t){var e={};if(void 0!==t.name&&(e.name=t.name),void 0!==t.metaData){e.attributes=[];var r={name:"NC_GLOBAL",attributes:[]};for(var n in t.metaData)t.metaData.hasOwnProperty(n)&&r.attributes.push({name:n,value:[t.metaData[n]]});e.attributes.push(r)}var a="Float64",i=void 0;if(e.leaves=[],[["ListenerPosition","ListenerPositionType"],["ListenerUp","ListenerUpType"],["ListenerView","ListenerViewType"]].forEach(function(r){var n=r[0],o=t[n],s=t[r[1]];if(void 0!==o){switch(s){case"cartesian":i=[{name:"Type",value:["cartesian"]},{name:"Units",value:["metre, metre, metre"]}];break;case"spherical":i=[{name:"Type",value:["spherical"]},{name:"Units",value:["degree, degree, metre"]}];break;default:throw new Error("Unknown coordinate system type "+s+" for "+o)}e.leaves.push({name:n,type:a,attributes:i,shape:[1,3],data:[o]})}}),void 0!==t.SourcePosition){switch(t.SourcePositionType){case"cartesian":i=[{name:"Type",value:["cartesian"]},{name:"Units",value:["metre, metre, metre"]}];break;case"spherical":i=[{name:"Type",value:["spherical"]},{name:"Units",value:["degree, degree, metre"]}];break;default:throw new Error("Unknown coordinate system type "+t.SourcePositionType)}e.leaves.push({name:"SourcePosition",type:a,attributes:i,shape:[t.SourcePosition.length,t.SourcePosition[0].length],data:t.SourcePosition})}if(void 0===t.DataSamplingRate)throw new Error("No data sampling-rate");if(e.leaves.push({name:"Data.SamplingRate",type:a,attributes:[{name:"Unit",value:"hertz"}],shape:[1],data:[t.DataSamplingRate]}),void 0!==t.DataDelay&&e.leaves.push({name:"Data.Delay",type:a,attributes:[],shape:[1,t.DataDelay.length],data:t.DataDelay}),void 0===t.DataIR)throw new Error("No data IR");return e.leaves.push({name:"Data.IR",type:a,attributes:[],shape:[t.DataIR.length,t.DataIR[0].length,t.DataIR[0][0].length],data:t.DataIR}),void 0!==t.RoomVolume&&e.leaves.push({name:"RoomVolume",type:a,attributes:[{name:"Units",value:["cubic metre"]}],shape:[1],data:[t.RoomVolume]}),e.nodes=[],JSON.stringify(e)}function i(t){var e=void 0;switch(t){case"cartesian":e="sofaCartesian";break;case"spherical":e="sofaSpherical";break;default:throw new Error("Bad SOFA type "+t)}return e}Object.defineProperty(r,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};r.parseSofa=n,r.stringifySofa=a,r.conformSofaCoordinateSystem=i,r.default={parseSofa:n,conformSofaCoordinateSystem:i}},{}],87:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=r.parseXml=void 0;if(void 0!==window.DOMParser)r.parseXml=n=function(t){return(new window.DOMParser).parseFromString(t,"text/xml")};else{if(void 0===window.ActiveXObject||!new window.ActiveXObject("Microsoft.XMLDOM"))throw new Error("No XML parser found");r.parseXml=n=function(t){var e=new window.ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}}r.default=n},{}],88:[function(t,e,r){e.exports={_args:[[{raw:"serve-sofa-hrir@github:ircam-rnd/serveSofaHrir",scope:null,escapedName:"serve-sofa-hrir",name:"serve-sofa-hrir",rawSpec:"github:ircam-rnd/serveSofaHrir",spec:"github:ircam-rnd/serveSofaHrir",type:"hosted",hosted:{type:"github",ssh:"git@github.com:ircam-rnd/serveSofaHrir.git",sshUrl:"git+ssh://git@github.com/ircam-rnd/serveSofaHrir.git",httpsUrl:"git+https://github.com/ircam-rnd/serveSofaHrir.git",gitUrl:"git://github.com/ircam-rnd/serveSofaHrir.git",shortcut:"github:ircam-rnd/serveSofaHrir",directUrl:"https://raw.githubusercontent.com/ircam-rnd/serveSofaHrir/master/package.json"}},"/Users/tommi/Downloads/JSAmbisonics"]],_from:"ircam-rnd/serveSofaHrir",_id:"serve-sofa-hrir@0.4.2",_inCache:!0,_location:"/serve-sofa-hrir",_phantomChildren:{},_requested:{raw:"serve-sofa-hrir@github:ircam-rnd/serveSofaHrir",scope:null,escapedName:"serve-sofa-hrir",name:"serve-sofa-hrir",rawSpec:"github:ircam-rnd/serveSofaHrir",spec:"github:ircam-rnd/serveSofaHrir",type:"hosted",hosted:{type:"github",ssh:"git@github.com:ircam-rnd/serveSofaHrir.git",sshUrl:"git+ssh://git@github.com/ircam-rnd/serveSofaHrir.git",httpsUrl:"git+https://github.com/ircam-rnd/serveSofaHrir.git",gitUrl:"git://github.com/ircam-rnd/serveSofaHrir.git",shortcut:"github:ircam-rnd/serveSofaHrir",directUrl:"https://raw.githubusercontent.com/ircam-rnd/serveSofaHrir/master/package.json"}},_requiredBy:["/"],_resolved:"git://github.com/ircam-rnd/serveSofaHrir.git#d7f846267b0b854366485949ea00215df53fb087",_shasum:"e7e2896df35a2de4441cf2dbce5528b727b4bc17",_shrinkwrap:null,_spec:"serve-sofa-hrir@github:ircam-rnd/serveSofaHrir",_where:"/Users/tommi/Downloads/JSAmbisonics",authors:["Jean-Philippe.Lambert@ircam.fr","Arnau Julià <arnau.julia@gmail.com>","Samuel.Goldszmidt@ircam.fr","David.Poirier-Quinot@ircam.fr"],bugs:{url:"https://github.com/Ircam-RnD/serveSofaHrir/issues"},dependencies:{"fractional-delay":"git://github.com/Ircam-RnD/fractional-delay.git#gh-pages","gl-matrix":"^2.3.1","kd.tree":"github:akshaylive/node-kdt#39bc780704a324393bca68a17cf7bc71be8544c6"},description:"Utility to fetch and shape sofa formated HRIR from server",devDependencies:{"babel-cli":"^6.5.1","babel-eslint":"^4.1.8","babel-preset-es2015":"^6.5.0",babelify:"^7.2.0","blue-tape":"^0.1.11",browserify:"^12.0.2",esdoc:"^0.4.6",eslint:"^1.10.3","eslint-config-airbnb":"^1.0.2","eslint-plugin-html":"^1.4.0",jscs:"2.11.0","jscs-jsdoc":"^1.3.1",tape:"^4.4.0","tape-run":"^2.1.2",testling:"^1.7.1",watch:"^0.17.1"},engines:{node:"0.12 || 4",npm:">=1.0.0 <3.0.0"},exports:"serveSofaHrir",gitHead:"d7f846267b0b854366485949ea00215df53fb087",homepage:"https://github.com/Ircam-RnD/serveSofaHrir#readme",license:"BSD-3-Clause",main:"./dist/",name:"serve-sofa-hrir",optionalDependencies:{},readme:"# Load Sofa formatted HRTFs from server in NodeJS #\n\nLoad a Sofa formatted HRTFs set from either a local or distant server. Instant access to closest match HRTF IRs {left,right} as an [AudioBuffer](https://developer.mozilla.org/fr/docs/Web/API/AudioBuffer) object for any given position. First published as a subclass of the [binauralFIR] library.\n\n\n## How to use ##\n\nAdd the library to your node project:\n```bash\nnpm install Ircam-RnD/serveSofaHrir\n```\n\nand check the  ``./examples`` folder for implementation details. See [binauralFIR] for an example use-case.\n\n## Documentation ##\n\nYou can consult the [API documentation] for the complete documentation.\n\n### ServerDataBase ###\n\n**The public server that hosts a database of individual [HRTF]s is available\nfor beta-testers only and will open to public in 2016.**\n\nThe `ServerDataBase` retrieves a catalogue from a [SOFA] server. From the\ncatalogue, it get URLs matching optional filters: data-base, sample-rate,\nand any free pattern.\n\n### HRTF dataset ###\n\nYou can use any [HRTF] data-set that follows the [SOFA] standard, in JSON\nformat, using finite impulse responses (FIR). Second-order sections (SOS)\nare not supported, yet. See the [examples HRTF directory] for a few samples.\n\n## Developers ##\n\nThe source code is in the [src directory], in [ES2015] standard. `npm run\ncompile` with [Babel] to the [dist directory]. Note that there is a\n[.babelrc] file. `npm run bundle` runs the linters, the tests,\ngenerates the documentation, and compiles the code.\n\nCommit the source files to the branch `develop`, and update the version in\n[package.json] if this is intended to be a release.\n\nOn the `master` branch, merge from the `develop` branch. Generate and\ncommit the documentation and the distribution files. Put a release tag that\ncorresponds to the version in [package.json].\n\nOn the `gh-pages` branch, merge from the `master` branch. Commit the\nexamples, and the extra files (audio and HRTF set files).\n\n### Style ###\n\n`npm run lint` to check that the code conforms with [.eslintrc] and\n[.jscsrc] files. The rules derive from [AirBnB] with these\nmajor points:\n- [ES2015]\n- no `'use strict'` globally (already there via babel)\n- enforce curly braces (`if`, `for`, etc.)\n- allow spaces and new lines, with fewer requirements: use them for clarity\n\n### Test ###\n\nFor any function or method, there is at least a test. The hierarchy in the\n[test directory] is the same as in the [src directory].\n\n- `npm run test` for all automated tests\n- `npm run test-listen` for supervised listening tests. The test files must\n  end with `_listen.js`\n- `npm run test-issues` for unsolved issues. The issues may depend on the\n  host: operating system, user-agent, sound-device, sample-rate, etc. The\n  test files must end with `_issues.js`. Once an issue is solved, the\n  corresponding tests are added to the automated test set.\n- `npm run test-browser` starts a server for running the tests in any browser.\n\nExamples for specific testing, when developing or resolving an issue:\n- `browserify test/geometry/test_coordinates.js -t babelify | tape-run` in a\n  headless browser\n- `browserify test/geometry/test_coordinates.js -t babelify | testling -u`\n  for an URL to open in any browser\n\n### Documentation ###\n\nDocument any public function and method with [JSDoc], and generate the HTML\npages with `npm run doc`. At this point, neither\n[jsdoc](https://www.npmjs.com/package/jsdoc) nor\n[esdoc](https://www.npmjs.com/package/esdoc) gives perfect\ntranscription. (See the [jsdoc.json] and [esdoc.json] files.)\n\n## License\n\nThis module is released under the [BSD-3-Clause] license.\n\n## Acknowledgments\n\nThis research was developed by both [Acoustic And Cognitive Spaces] and [Analysis of Musical Practices] IRCAM research teams. A previous version was part of the WAVE project, funded by ANR (French National Research Agency). The current version, supporting multiple sources and a listener, HRTFs SOFA format and the access to a HRTF server, is part of the [CoSiMa] project, funded by ANR.The HRTF server and efforts for standardization of the HRTF SOFA format ([AES69 standard]) benefited from the financial support of the [Bili] project (French funding program FUI).\n\n[//]: # (Avoid relative links for use with https://github.com/README.md)\n[//]: # (and http://cdn.rawgit.com/Ircam-RnD/binauralFIR/next-gh-pages/doc/index.html)\n\n[//]: # (Use relative links after the release, and drop rawgit.com)\n[//]: # (next-develop => develop)\n[//]: # (next-master => master)\n[//]: # (next-gh-pages => gh-pages)\n\n[.babelrc]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/.babelrc\n[.eslintrc]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/.eslintrc\n[.jscsrc]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/.jscsrc\n[Acoustic And Cognitive Spaces]: http://recherche.ircam.fr/equipes/salles/\n[AirBnB]: https://github.com/airbnb/javascript/\n[Analysis of Musical Practices]: http://apm.ircam.fr/\n[API documentation directory]: https://github.com/Ircam-RnD/binauralFIR/tree/next-master/doc/\n[API documentation]: http://cdn.rawgit.com/Ircam-RnD/binauralFIR/next-master/doc/index.html\n[Babel]: https://babeljs.io/\n[binauralFIR]: https://github.com/Ircam-RnD/binauralFIR\n[BSD-3-Clause]: http://opensource.org/licenses/BSD-3-Clause\n[CoSiMa]: http://cosima.ircam.fr/\n[doc directory]:  https://github.com/Ircam-RnD/binauralFIR/tree/next-master/doc/\n[dist directory]:  https://github.com/Ircam-RnD/binauralFIR/tree/next-master/dist/\n[documentation]: #documentation\n[ES2015]: https://babeljs.io/docs/learn-es2015/\n[esdoc.json]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/esdoc.json\n[examples directory]: https://github.com/Ircam-RnD/binauralFIR/tree/next-gh-pages/examples/\n[examples HRTF directory]: https://github.com/Ircam-RnD/binauralFIR/tree/next-gh-pages/examples/hrtf/\n[examples online]: http://cdn.rawgit.com/Ircam-RnD/binauralFIR/next-gh-pages/examples/index.html\n[HRTF]: http://en.wikipedia.org/wiki/Head-related_transfer_function\n[IIRFilterNode]: https://webaudio.github.io/web-audio-api/#idl-def-IIRFilterNode\n[jsdoc.json]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/jsdoc.json\n[JSDoc]: http://usejsdoc.org/\n[package.json]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/package.json\n[Promise]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\n[SOFA]: http://www.aes.org/publications/standards/search.cfm?docID=99\n[src directory]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/src/\n[src/geometry]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/src/geometry/\n[T. Carpentier article]: http://wac.ircam.fr/pdf/demo/wac15_submission_16.pdf\n[test directory]: https://github.com/Ircam-RnD/binauralFIR/tree/next-develop/test/\n[Web Audio API]: https://webaudio.github.io/web-audio-api/\n[AES69 standard]: http://www.aes.org/publications/standards/search.cfm?docID=99\n[Bili]: http://www.bili-project.org/",readmeFilename:"README.md",repository:{type:"git",url:"git+https://github.com/Ircam-RnD/serveSofaHrir.git"},scripts:{browserify:"browserify ./src/index.js -t [ babelify ] --standalone serveSofaHrir > serveSofaHrir.js",bundle:"npm run lint && npm run test && npm run doc && npm run compile && npm run browserify",compile:"rm -rf ./dist && babel ./src/ --out-dir ./dist/",doc:"esdoc -c esdoc.json",lint:"eslint ./src/ ./test/ && jscs --verbose ./src/ ./test/","lint-examples":"eslint -c examples/.eslintrc ./examples/*.html",test:"browserify test/*/*.js -t [ babelify ] --exclude 'test/*/*_listen.js*' --exclude 'test/*/*_issues.js' | tape-run","test-browser":"browserify test/*/*.js -t [ babelify ] --exclude 'test/*/*_listen.js*' --exclude 'test/*/*_issues.js' | testling -u","test-issues":"browserify test/*/*_issues.js -t [ babelify ] | tape-run","test-listen":"browserify test/*/*_listen.js -t [ babelify ] | tape-run",watch:"watch 'npm run browserify && echo $( date ): browserified' ./src/"},standalone:"serveSofaHrir",version:"0.4.2",warnings:[{code:"ENOTSUP",required:{node:"0.12 || 4",npm:">=1.0.0 <3.0.0"},pkgid:"serve-sofa-hrir@0.4.2"}]}},{}],89:[function(t,e,r){"use strict";"use restrict";function n(t){for(var e=0,r=Math.max,n=0,a=t.length;n<a;++n)e=r(e,t[n].length);return e-1}function a(t){for(var e=-1,r=Math.max,n=0,a=t.length;n<a;++n)for(var i=t[n],o=0,s=i.length;o<s;++o)e=r(e,i[o]);return e+1}function i(t){for(var e=new Array(t.length),r=0,n=t.length;r<n;++r)e[r]=t[r].slice(0);return e}function o(t,e){var r=t.length,n=t.length-e.length,a=Math.min;if(n)return n;switch(r){case 0:return 0;case 1:return t[0]-e[0];case 2:var i=t[0]+t[1]-e[0]-e[1];return i||a(t[0],t[1])-a(e[0],e[1]);case 3:var o=t[0]+t[1],s=e[0]+e[1];if(i=o+t[2]-(s+e[2]))return i;var u=a(t[0],t[1]),c=a(e[0],e[1]),i=a(u,t[2])-a(c,e[2]);return i||a(u+t[2],o)-a(c+e[2],s);default:var l=t.slice(0);l.sort();var h=e.slice(0);h.sort();for(var f=0;f<r;++f)if(n=l[f]-h[f])return n;return 0}}function s(t,e){return o(t[0],e[0])}function u(t,e){if(e){for(var r=t.length,n=new Array(r),a=0;a<r;++a)n[a]=[t[a],e[a]];n.sort(s);for(var a=0;a<r;++a)t[a]=n[a][0],e[a]=n[a][1];return t}return t.sort(o),t}function c(t){if(0===t.length)return[];for(var e=1,r=t.length,n=1;n<r;++n){var a=t[n];if(o(a,t[n-1])){if(n===e){e++;continue}t[e++]=a}}return t.length=e,t}function l(t,e){for(var r=0,n=t.length-1,a=-1;r<=n;){var i=r+n>>1,s=o(t[i],e);s<=0?(0===s&&(a=i),r=i+1):s>0&&(n=i-1)}return a}function h(t,e){for(var r=new Array(t.length),n=0,a=r.length;n<a;++n)r[n]=[];for(var i=[],n=0,s=e.length;n<s;++n)for(var u=e[n],c=u.length,h=1,f=1<<c;h<f;++h){i.length=b.popCount(h);for(var d=0,m=0;m<c;++m)h&1<<m&&(i[d++]=u[m]);var p=l(t,i);if(!(p<0))for(;;)if(r[p++].push(n),p>=t.length||0!==o(t[p],i))break}return r}function f(t,e){if(!e)return h(c(m(t,0)),t,0);for(var r=new Array(e),n=0;n<e;++n)r[n]=[];for(var n=0,a=t.length;n<a;++n)for(var i=t[n],o=0,s=i.length;o<s;++o)r[i[o]].push(n);return r}function d(t){for(var e=[],r=0,n=t.length;r<n;++r)for(var a=t[r],i=0|a.length,o=1,s=1<<i;o<s;++o){for(var c=[],l=0;l<i;++l)o>>>l&1&&c.push(a[l]);e.push(c)}return u(e)}function m(t,e){if(e<0)return[];for(var r=[],n=(1<<e+1)-1,a=0;a<t.length;++a)for(var i=t[a],o=n;o<1<<i.length;o=b.nextCombination(o)){for(var s=new Array(e+1),c=0,l=0;l<i.length;++l)o&1<<l&&(s[c++]=i[l]);r.push(s)}return u(r)}function p(t){for(var e=[],r=0,n=t.length;r<n;++r)for(var a=t[r],i=0,o=a.length;i<o;++i){for(var s=new Array(a.length-1),c=0,l=0;c<o;++c)c!==i&&(s[l++]=a[c]);e.push(s)}return u(e)}function v(t,e){for(var r=new y(e),n=0;n<t.length;++n)for(var a=t[n],i=0;i<a.length;++i)for(var o=i+1;o<a.length;++o)r.link(a[i],a[o]);for(var s=[],u=r.ranks,n=0;n<u.length;++n)u[n]=-1;for(var n=0;n<t.length;++n){var c=r.find(t[n][0]);u[c]<0?(u[c]=s.length,s.push([t[n].slice(0)])):s[u[c]].push(t[n].slice(0))}return s}function g(t){for(var e=c(u(m(t,0))),r=new y(e.length),n=0;n<t.length;++n)for(var a=t[n],i=0;i<a.length;++i)for(var o=l(e,[a[i]]),s=i+1;s<a.length;++s)r.link(o,l(e,[a[s]]));for(var h=[],f=r.ranks,n=0;n<f.length;++n)f[n]=-1;for(var n=0;n<t.length;++n){var d=r.find(l(e,[t[n][0]]));f[d]<0?(f[d]=h.length,h.push([t[n].slice(0)])):h[f[d]].push(t[n].slice(0))}return h}function M(t,e){return e?v(t,e):g(t)}var b=t("bit-twiddle"),y=t("union-find");r.dimension=n,r.countVertices=a,r.cloneCells=i,r.compareCells=o,r.normalize=u,r.unique=c,r.findCell=l,r.incidence=h,r.dual=f,r.explode=d,r.skeleton=m,r.boundary=p,r.connectedComponents=M},{"bit-twiddle":29,"union-find":93}],90:[function(t,e,r){function n(t,e,r,n,a){return o(0,t,e,r,n,a)}function a(t,e,r,n,a){var i,s,u,c;return 0==e?(i=o(1,t,1,r,n,a),s=o(-1,t,-1,r,n,a),u=i+s):e>0?(c=1==e?1:0,i=o(1,t,e-1,r,n,a),s=o(-1,t,1-e,r,n,a),u=i*Math.sqrt(1+c)-s*(1-c)):(c=-1==e?1:0,i=o(1,t,e+1,r,n,a),s=o(-1,t,-e-1,r,n,a),u=i*(1-c)+s*Math.sqrt(1+c)),u}function i(t,e,r,n,a){var i,s,u;return 0==e?console.error("should not be called"):e>0?(i=o(1,t,e+1,r,n,a),s=o(-1,t,-e-1,r,n,a),u=i+s):(i=o(1,t,e-1,r,n,a),s=o(-1,t,1-e,r,n,a),u=i-s),u}function o(t,e,r,n,a,i){var o,s,u;return o=a[t+1][2],s=a[t+1][0],u=a[t+1][1],n==-e?o*i[r+e-1][0]+s*i[r+e-1][2*e-2]:n==e?o*i[r+e-1][2*e-2]-s*i[r+e-1][0]:u*i[r+e-1][n+e-1]}var s=t("numeric"),u=function(t,e,r,n){var a,i=e.length,o=(t+1)*(t+1),u=[,];o>i&&console.log("The SHT degree is too high for the number of data points"),0==r&&(e=h(e));for(var c=0;c<e.length;c++)u[c]=e[c][2];return Y_N=d(t,e),a=0==n?s.mul(1/i,Y_N):g(s.transpose(Y_N)),s.dotMV(a,u)},c=function(t,e){for(var r=e,n=Math.sqrt(t.length)-1,a=d(n,e),i=s.dotVM(t,a),o=0;o<e.length;o++)r[o][2]=i[o];return r},l=function(t){for(var e=0;e<t.length;e++)console.log(t[e])},h=function(t,e){for(var r,n,a,i=new Array(t.length),o=0;o<t.length;o++)r=Math.atan2(t[o][1],t[o][0]),n=Math.atan2(t[o][2],Math.sqrt(t[o][0]*t[o][0]+t[o][1]*t[o][1])),1==e?i[o]=[r,n]:(a=Math.sqrt(t[o][0]*t[o][0]+t[o][1]*t[o][1]+t[o][2]*t[o][2]),i[o]=[r,n,a]);return i},f=function(t){for(var e,r,n,a=new Array(t.length),i=0;i<t.length;i++)e=Math.cos(t[i][0])*Math.cos(t[i][1]),r=Math.sin(t[i][0])*Math.cos(t[i][1]),n=Math.sin(t[i][1]),2==t[0].length?a[i]=[e,r,n]:3==t[0].length&&(a[i]=[t[i][2]*e,t[i][2]*r,t[i][2]*n]);return a},d=function(t,e){for(var r=new Array(e.length),n=new Array(e.length),a=0;a<e.length;a++)r[a]=e[a][0],n[a]=e[a][1];for(var i,o,u,c,l,h=new Array(2*t+1),f=(r.length,(t+1)*(t+1)),d=0,v=0,g=s.sin(n),M=0,b=new Array(f),a=0;a<2*t+1;a++)h[a]=m(a);for(var y=0;y<t+1;y++){if(0==y){var x=new Array(r.length);x.fill(1),b[y]=x,M=1}else{i=p(y,g,d,v),o=Math.sqrt(2*y+1);for(var S=0;S<y+1;S++)0==S?b[M+y]=s.mul(o,i[S]):(u=o*Math.sqrt(2*h[y-S]/h[y+S]),c=s.cos(s.mul(S,r)),l=s.sin(s.mul(S,r)),b[M+y-S]=s.mul(u,s.mul(i[S],l)),b[M+y+S]=s.mul(u,s.mul(i[S],c)));M=M+2*y+1}v=d,d=i}return b},m=function(t){return 0===t?1:t*m(t-1)},p=function(t,e,r,n){var a=new Array(t+1);switch(t){case 1:var i=s.mul(e,e),o=e,u=s.sqrt(s.sub(1,i));a[0]=o,a[1]=u;break;case 2:var i=s.mul(e,e),c=s.mul(3,i);c=s.sub(c,1),c=s.div(c,2);var l=s.sub(1,i);l=s.sqrt(l),l=s.mul(3,l),l=s.mul(l,e);var h=s.sub(1,i);h=s.mul(3,h),a[0]=c,a[1]=l,a[2]=h;break;default:var i=s.mul(e,e),f=s.sub(1,i),d=2*t-1,m=1;if(d%2==0)for(var p=1;p<d/2+1;p++)m=2*m*p;else for(var p=1;p<(d+1)/2+1;p++)m*=2*p-1;a[t]=s.mul(m,s.pow(f,t/2)),a[t-1]=s.mul(2*t-1,s.mul(e,r[t-1]));for(var v=0;v<t-1;v++){var g=s.mul(2*t-1,s.mul(e,r[v])),M=s.mul(t+v-1,n[v]);a[v]=s.div(s.sub(g,M),t-v)}}return a},v=function(t){for(var e=s.svd(t),r=e.S[0],n=e.U,a=e.S,i=e.V,o=t.length,u=t[0].length,c=Math.max(o,u)*s.epsilon*r,l=a.length,h=new Array(l),f=l-1;-1!==f;f--)a[f]>c?h[f]=1/a[f]:h[f]=0;return s.dot(s.dot(i,s.diag(h)),s.transpose(n))},g=function(t){var e=s.transpose(t);return s.dot(s.inv(s.dot(e,t)),e)},M=function(t,e){
var r=(e+1)*(e+1),o=s.rep([r,r],0);o[0][0]=1;var u=s.rep([3,3],0);u[0][0]=t[1][1],u[0][1]=t[1][2],u[0][2]=t[1][0],u[1][0]=t[2][1],u[1][1]=t[2][2],u[1][2]=t[2][0],u[2][0]=t[0][1],u[2][1]=t[0][2],u[2][2]=t[0][0],o=s.setBlock(o,[1,1],[3,3],u);for(var c=u,l=3,h=2;h<e+1;h++){for(var f=s.rep([2*h+1,2*h+1],0),d=-h;d<h+1;d++)for(var m=-h;m<h+1;m++){var p,v,g,M,b;p=0==d?1:0,v=Math.abs(m)==h?2*h*(2*h-1):h*h-m*m,g=Math.sqrt((h*h-d*d)/v),M=Math.sqrt((1+p)*(h+Math.abs(d)-1)*(h+Math.abs(d))/v)*(1-2*p)*.5,b=Math.sqrt((h-Math.abs(d)-1)*(h-Math.abs(d))/v)*(1-p)*-.5,0!=g&&(g*=n(h,d,m,u,c)),0!=M&&(M*=a(h,d,m,u,c)),0!=b&&(b*=i(h,d,m,u,c)),f[d+h][m+h]=g+M+b}o=s.setBlock(o,[l+1,l+1],[l+2*h+1,l+2*h+1],f),c=f,l=l+2*h+1}return o},b=function(t,e,r){var n,a,i;n=0==r?[[1,0,0],[0,1,0],[0,0,1]]:[[1,0,0],[0,Math.cos(r),Math.sin(r)],[0,-Math.sin(r),Math.cos(r)]],a=0==e?[[1,0,0],[0,1,0],[0,0,1]]:[[Math.cos(e),0,-Math.sin(e)],[0,1,0],[Math.sin(e),0,Math.cos(e)]],i=0==t?[[1,0,0],[0,1,0],[0,0,1]]:[[Math.cos(t),Math.sin(t),0],[-Math.sin(t),Math.cos(t),0],[0,0,1]];var o=s.dotMMsmall(a,i);return o=s.dotMMsmall(n,o)};e.exports.forwardSHT=u,e.exports.inverseSHT=c,e.exports.print2Darray=l,e.exports.convertCart2Sph=h,e.exports.convertSph2Cart=f,e.exports.computeRealSH=d,e.exports.factorial=m,e.exports.recurseLegendrePoly=p,e.exports.pinv_svd=v,e.exports.pinv_direct=g,e.exports.getSHrotMtx=M,e.exports.yawPitchRoll2Rzyx=b},{numeric:72}],91:[function(t,e,r){"use strict";function n(t,e,r){var n=t*e,i=a*t,o=i-t,s=i-o,u=t-s,c=a*e,l=c-e,h=c-l,f=e-h,d=n-s*h,m=d-u*h,p=m-s*f,v=u*f-p;return r?(r[0]=v,r[1]=n,r):[v,n]}e.exports=n;var a=+(Math.pow(2,27)+1)},{}],92:[function(t,e,r){"use strict";function n(t,e,r){var n=t+e,a=n-t,i=n-a,o=e-a,s=t-i;return r?(r[0]=s+o,r[1]=n,r):[s+o,n]}e.exports=n},{}],93:[function(t,e,r){"use strict";"use restrict";function n(t){this.roots=new Array(t),this.ranks=new Array(t);for(var e=0;e<t;++e)this.roots[e]=e,this.ranks[e]=0}e.exports=n;var a=n.prototype;Object.defineProperty(a,"length",{get:function(){return this.roots.length}}),a.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},a.find=function(t){for(var e=t,r=this.roots;r[t]!==t;)t=r[t];for(;r[e]!==t;){var n=r[e];r[e]=t,e=n}return t},a.link=function(t,e){var r=this.find(t),n=this.find(e);if(r!==n){var a=this.ranks,i=this.roots,o=a[r],s=a[n];o<s?i[r]=n:s<o?i[n]=r:(i[n]=r,++a[r])}}},{}]},{},[23])(23)});